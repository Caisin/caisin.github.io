(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{400:function(a,e,c){"use strict";c.r(e);var t=c(44),r=Object(t.a)({},(function(){var a=this,e=a.$createElement,c=a._self._c||e;return c("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[c("h1",{attrs:{id:"缓存机制"}},[c("a",{staticClass:"header-anchor",attrs:{href:"#缓存机制"}},[a._v("#")]),a._v(" 缓存机制")]),a._v(" "),c("h2",{attrs:{id:"_1-缓存表配置"}},[c("a",{staticClass:"header-anchor",attrs:{href:"#_1-缓存表配置"}},[a._v("#")]),a._v(" 1. 缓存表配置")]),a._v(" "),c("blockquote",[c("p",[a._v("表名:BS_PARAM_TABLES")])]),a._v(" "),c("div",{staticClass:"language- extra-class"},[c("pre",{pre:!0,attrs:{class:"language-text"}},[c("code",[a._v("TABLE_NAME: 表名\nCACHE_COLUMNS: 需要缓存的列\nPRIMARY_COLUMNS: 缓存主键,列用逗号(,)隔开\nINDEXES: 缓存索引列,索引列用逗号(,)隔开,多个索引用竖杠(|)分割\nSORT_COLUMNS: 按配置的字段排序,捞数据sql ORDER BY \nREGION_COLUMN: 地市\nDATA_SRC: 数据源\n")])])]),c("blockquote",[c("p",[a._v("表名:BS_PARAM_TABLES_REL")])]),a._v(" "),c("div",{staticClass:"language- extra-class"},[c("pre",{pre:!0,attrs:{class:"language-text"}},[c("code",[a._v("TABLE_NAME: 表名\nSERVER_NAME: 参数服务名 acctconfig.properties配置文件的param.server.name\nNEED_LOAD_ALL: 是否加载全部 Y:是,N:否\nSTATE: 生失效标记 Y:生效,N:失效\n")])])]),c("h2",{attrs:{id:"_2-缓存说明"}},[c("a",{staticClass:"header-anchor",attrs:{href:"#_2-缓存说明"}},[a._v("#")]),a._v(" 2. 缓存说明")]),a._v(" "),c("h3",{attrs:{id:"_2-1-缓存加载"}},[c("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-缓存加载"}},[a._v("#")]),a._v(" 2.1 缓存加载")]),a._v(" "),c("div",{staticClass:"language- extra-class"},[c("pre",{pre:!0,attrs:{class:"language-text"}},[c("code",[a._v('加载\ncache.xml配置\n<cache id="com.ai.acctcomp.cache.readonly.ParamTablesCache" init="true" />\n<cache id="com.ai.acctcomp.cache.readonly.AcctParamCache" init="true" />\n\n<cache source="aicache" dataType="app-web" id="com.ai.acctcomp.cache.readonly.ParamTablesCache" init="true" />\n<cache source="aicache" dataType="app-web" id="com.ai.acctcomp.cache.readonly.AcctParamCache" init="true" />\nsource:配置的aicache会走aicache,可通过aicache刷新缓存\ndataType:CacheConfig.xml中的 server_code\n不配置走的分布式缓存,没个表的缓存数据在redis上key为:STATIC_PARAM_TAB_VERSION_表名\naicache页面刷新\ncom.ai.acctcomp.cache.readonly.AcctParamCache\n\n如果有修改 BS_PARAM_TABLES,BS_PARAM_TABLES_REL数据需要刷新\ncom.ai.acctcomp.cache.readonly.ParamTablesCache\n')])])]),c("p",[a._v("###2.2 缓存使用")]),a._v(" "),c("div",{staticClass:"language- extra-class"},[c("pre",{pre:!0,attrs:{class:"language-text"}},[c("code",[a._v("使用 ParamMgr 类取缓存\n**注意**\n查询条件列需要走上BS_PARAM_TABLES表配置的主键和索引才能命中缓存\n否则在aicache缓存中找不到\n这样刷新缓存需要删除redis\nSTATIC_PARAM_TAB_VERSION_表名\n的key\n")])])]),c("p",[c("strong",[a._v("注意:")]),a._v("\n在使用ParamMgr获取缓存的时候一定要按表bs_param_tables配置的主键和索引列查找\n否则会出现缓存无法刷新的情况")])])}),[],!1,null,null,null);e.default=r.exports}}]);