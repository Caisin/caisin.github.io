(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{311:function(t,s,a){t.exports=a.p+"assets/img/DBM.52a22f3b.png"},312:function(t,s,a){t.exports=a.p+"assets/img/ReverseParamConfig.6fbe7f82.png"},391:function(t,s,a){"use strict";a.r(s);var n=a(44),r=Object(n.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"抵扣"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#抵扣"}},[t._v("#")]),t._v(" 抵扣")]),t._v(" "),n("p"),n("div",{staticClass:"table-of-contents"},[n("ul",[n("li",[n("a",{attrs:{href:"#step1-拉取s文件"}},[t._v("step1 拉取S文件")])]),n("li",[n("a",{attrs:{href:"#step2-s文件稽核"}},[t._v("step2 S文件稽核")])]),n("li",[n("a",{attrs:{href:"#step3-s文件入库"}},[t._v("step3 S文件入库")])]),n("li",[n("a",{attrs:{href:"#setp4-生成欠费表-账本和0缴费工单"}},[t._v("setp4 生成欠费表/账本和0缴费工单")]),n("ul",[n("li",[n("a",{attrs:{href:"#业务限制"}},[t._v("业务限制 :")])])])]),n("li",[n("a",{attrs:{href:"#step5-修改账期状态"}},[t._v("step5 修改账期状态")])]),n("li",[n("a",{attrs:{href:"#step6-客户核查期间"}},[t._v("step6 客户核查期间")]),n("ul",[n("li",[n("a",{attrs:{href:"#业务限制"}},[t._v("业务限制 :")])])])]),n("li",[n("a",{attrs:{href:"#step5-月初0缴费工单处理完成"}},[t._v("step5 月初0缴费工单处理完成")]),n("ul",[n("li",[n("a",{attrs:{href:"#业务限制"}},[t._v("业务限制 :")])])])]),n("li",[n("a",{attrs:{href:"#回退机制"}},[t._v("回退机制")]),n("ul",[n("li",[n("a",{attrs:{href:"#_5号前回退"}},[t._v("5号前回退")])]),n("li",[n("a",{attrs:{href:"#_5号后回退"}},[t._v("5号后回退")])])])]),n("li",[n("a",{attrs:{href:"#后台脚本地址"}},[t._v("后台脚本地址")])]),n("li",[n("a",{attrs:{href:"#出账比对sql"}},[t._v("出账比对sql")])])])]),n("p"),t._v(" "),n("p",[t._v("流程图")]),t._v(" "),n("p",[n("img",{attrs:{src:a(311),alt:"image-201912301229078"}})]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[t._v(" 进入一号,账期自动切到20状态\n 等待计费生成账单的S文件\n")])])]),n("h2",{attrs:{id:"step1-拉取s文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#step1-拉取s文件"}},[t._v("#")]),t._v(" step1 拉取S文件")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[t._v(" 将计费生成的s文件拉到账管主机\n")])])]),n("h2",{attrs:{id:"step2-s文件稽核"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#step2-s文件稽核"}},[t._v("#")]),t._v(" step2 S文件稽核")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("通过billing给的total.log文件的统计数据 跟S文件的作比较,金额和记录数对上就判断校验成功\n")])])]),n("h2",{attrs:{id:"step3-s文件入库"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#step3-s文件入库"}},[t._v("#")]),t._v(" step3 S文件入库")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[t._v("通过S生成入库\nam_bill_ar_yyyymm\nam_bill_item\n")])])]),n("h2",{attrs:{id:"setp4-生成欠费表-账本和0缴费工单"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#setp4-生成欠费表-账本和0缴费工单"}},[t._v("#")]),t._v(" setp4 生成欠费表/账本和0缴费工单")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--am_acct_debt_mm 通过sql sum生成")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--am_balance_mm ")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" am_balance_11 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" am_balance_10 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" trade_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("to_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'20191101000000'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h3",{attrs:{id:"业务限制"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#业务限制"}},[t._v("#")]),t._v(" 业务限制 :")]),t._v(" "),n("ol",[n("li",[n("p",[n("s",[t._v("撤单")])]),t._v(" "),n("blockquote",[n("p",[t._v("账本在搬迁,不能撤单")])])]),t._v(" "),n("li",[n("p",[t._v("缴费")]),t._v(" "),n("blockquote",[n("p",[t._v("入账会入上月和当前月账本am_balance表,只入账,不销账,也不插销账工单")])])]),t._v(" "),n("li",[n("p",[t._v("转账")])]),t._v(" "),n("li",[n("p",[t._v("调账")]),t._v(" "),n("blockquote",[n("p",[t._v("不允许调当月生成的账单")])])]),t._v(" "),n("li",[n("p",[n("s",[t._v("预存清退")])]),t._v(" "),n("blockquote",[n("p",[t._v("账本在搬迁,不能清退")])])])]),t._v(" "),n("h2",{attrs:{id:"step5-修改账期状态"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#step5-修改账期状态"}},[t._v("#")]),t._v(" step5 修改账期状态")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[t._v("账单和欠费文件入库完成将am_cycle表状态修改为3  \n")])])]),n("h2",{attrs:{id:"step6-客户核查期间"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#step6-客户核查期间"}},[t._v("#")]),t._v(" step6 客户核查期间")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[t._v("客户核查账单是否有误,核查完成将账期状态改为2  \n状态修改成功,开始启动月初0缴费销账工单\n")])])]),n("h3",{attrs:{id:"业务限制-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#业务限制-2"}},[t._v("#")]),t._v(" 业务限制 :")]),t._v(" "),n("ol",[n("li",[n("p",[t._v("缴费")]),t._v(" "),n("blockquote",[n("p",[t._v("同步缴费 判断是否有未处理工单,有工单则插入工单,否则直接销账")])])]),t._v(" "),n("li",[n("p",[t._v("撤单")]),t._v(" "),n("blockquote",[n("p",[t._v("3状态,有工单不允许撤单")])])]),t._v(" "),n("li",[n("p",[t._v("转账")]),t._v(" "),n("blockquote",[n("p",[t._v("可以转,但有工单不允许转出")])])]),t._v(" "),n("li",[n("p",[n("s",[t._v("调账")]),t._v("???")])]),t._v(" "),n("li",[n("p",[t._v("预存清退")]),t._v(" "),n("blockquote",[n("p",[t._v("有工单不允许清退")])])])]),t._v(" "),n("h2",{attrs:{id:"step5-月初0缴费工单处理完成"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#step5-月初0缴费工单处理完成"}},[t._v("#")]),t._v(" step5 月初0缴费工单处理完成")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[t._v(" 修改账期状态为4\n")])])]),n("h3",{attrs:{id:"业务限制-3"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#业务限制-3"}},[t._v("#")]),t._v(" 业务限制 :")]),t._v(" "),n("p",[t._v("20状态: 查两个月实时账单 账本缴费入往月和实时月")]),t._v(" "),n("p",[t._v("状态变化时间:月初自动切20")]),t._v(" "),n("p",[t._v("不支持:")]),t._v(" "),n("p",[t._v("调账本,转账,撤单,清退,销账")]),t._v(" "),n("p",[t._v("支持:")]),t._v(" "),n("p",[t._v("缴费")]),t._v(" "),n("p",[t._v("3状态: 只查一个月实时账单,账本只入实时月")]),t._v(" "),n("p",[t._v("状态变化时间:入账单完成切")]),t._v(" "),n("p",[t._v("不支持:")]),t._v(" "),n("p",[t._v("调当月账单,销账")]),t._v(" "),n("p",[t._v("半支持")]),t._v(" "),n("p",[t._v("转账(存在销账工单,不允许转账)")]),t._v(" "),n("p",[t._v("支持:")]),t._v(" "),n("p",[t._v("缴费,调往月账单,调账本,撤单,清退(是否5号以后在做清退)")]),t._v(" "),n("p",[t._v("以上两个状态缴费生成4106工单,20账本入两个月,3只入一个月,有的话不生成")]),t._v(" "),n("p",[t._v("当月入库账单不能调账")]),t._v(" "),n("p",[t._v("2状态: 缴费可以销账,但是要判断是否存在4106的0缴费工单,不存在直接销账,存在不销账")]),t._v(" "),n("p",[t._v("状态变化时间: 客户核查完成,开始4106销账时候切")]),t._v(" "),n("p",[t._v("当前状态<=2")]),t._v(" "),n("p",[t._v("不支持:")]),t._v(" "),n("p",[t._v("半支持")]),t._v(" "),n("p",[t._v("转账(存在销账工单,不予许转账)")]),t._v(" "),n("p",[t._v("支持:")]),t._v(" "),n("p",[t._v("缴费,调账单,调账本,撤单,清退(是否5号以后在做清退),销账")]),t._v(" "),n("p",[t._v("1状态: 4106销账工单结束,直接销账,不判断是否存在4106工单")]),t._v(" "),n("p",[t._v("状态变化时间:4106销账工单结束")]),t._v(" "),n("p",[t._v("无限制")]),t._v(" "),n("h2",{attrs:{id:"回退机制"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#回退机制"}},[t._v("#")]),t._v(" 回退机制")]),t._v(" "),n("h3",{attrs:{id:"_5号前回退"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5号前回退"}},[t._v("#")]),t._v(" 5号前回退")]),t._v(" "),n("h4",{attrs:{id:"部分撤单"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#部分撤单"}},[t._v("#")]),t._v(" 部分撤单")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v('--1. 配置需要撤单的账户,可配置多条,账户间用逗号","')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" BS_SYS_PROFILES "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" PROFILE_TYPE"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'PPY_TARGET_ACCT_IDS'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- 2. 启动et 的 WriteOffReverseTask")]),t._v("\n")])])]),n("h4",{attrs:{id:"全量回退"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#全量回退"}},[t._v("#")]),t._v(" 全量回退")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--去掉部分撤单的参数配置")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("delete")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" BS_SYS_PROFILES "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" PROFILE_TYPE"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'PPY_TARGET_ACCT_IDS'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- 2. 启动et 的 WriteOffReverseTask")]),t._v("\n")])])]),n("h4",{attrs:{id:"回退某个中心"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#回退某个中心"}},[t._v("#")]),t._v(" 回退某个中心")]),t._v(" "),n("div",{staticClass:"language-properties extra-class"},[n("pre",{pre:!0,attrs:{class:"language-properties"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#et配置 新增启动参数")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("TARGET_CENTERS")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("1,2,3,4,5,6,7,8")]),t._v("\n")])])]),n("p",[n("img",{attrs:{src:a(312),alt:"image-ReverseParamConfig"}})]),t._v(" "),n("h3",{attrs:{id:"_5号后回退"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5号后回退"}},[t._v("#")]),t._v(" 5号后回退")]),t._v(" "),n("h4",{attrs:{id:"单个撤单"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#单个撤单"}},[t._v("#")]),t._v(" 单个撤单")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("根据0缴费的流水,缴费返销页面撤单\n删掉该账户错误账单\n")])])]),n("h4",{attrs:{id:"批量撤单"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#批量撤单"}},[t._v("#")]),t._v(" 批量撤单")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[t._v("批量导出4106的流水,通过批量返销工单撤单\n删掉入库账单,通过新的S文件重新入库\n")])])]),n("h2",{attrs:{id:"后台脚本地址"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#后台脚本地址"}},[t._v("#")]),t._v(" 后台脚本地址")]),t._v(" "),n("div",{staticClass:"language-http extra-class"},[n("pre",{pre:!0,attrs:{class:"language-http"}},[n("code",[n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("http:")]),t._v("//git.wadecn.com:18084/hekx/assetprocess-script.git\n")])])]),n("h2",{attrs:{id:"出账比对sql"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#出账比对sql"}},[t._v("#")]),t._v(" 出账比对sql")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--统计库查询 出账账户数")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cc"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" acct_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" cc "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" ac1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("am_bill_ar_201912 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" acct_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("union")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("all")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" acct_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" cc "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" ac2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("am_bill_ar_201912 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" acct_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("union")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("all")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" acct_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" cc "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" ac3"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("am_bill_ar_201912 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" acct_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("union")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("all")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" acct_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" cc "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" ac4"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("am_bill_ar_201912 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" acct_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("union")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("all")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" acct_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" cc "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" ac5"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("am_bill_ar_201912 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" acct_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("union")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("all")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" acct_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" cc "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" ac6"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("am_bill_ar_201912 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" acct_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("union")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("all")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" acct_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" cc "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" ac7"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("am_bill_ar_201912 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" acct_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("union")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("all")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" acct_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" cc "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" ac8"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("am_bill_ar_201912 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" acct_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--统计库查询  出账用户数")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" subscriber_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" subscriber_id  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" ac1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("am_bill_ar_201912 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" subscriber_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("union")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("all")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" subscriber_id  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" ac2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("am_bill_ar_201912 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" subscriber_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("union")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("all")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" subscriber_id  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" ac3"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("am_bill_ar_201912 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" subscriber_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("union")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("all")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" subscriber_id  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" ac4"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("am_bill_ar_201912 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" subscriber_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("union")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("all")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" subscriber_id  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" ac5"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("am_bill_ar_201912 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" subscriber_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("union")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("all")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" subscriber_id  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" ac6"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("am_bill_ar_201912 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" subscriber_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("union")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("all")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" subscriber_id  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" ac7"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("am_bill_ar_201912 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" subscriber_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("union")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("all")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" subscriber_id  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" ac8"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("am_bill_ar_201912 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" subscriber_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--生成账单数据用户数")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" cen"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("am_mail_main_201912"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" cen"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("am_mail_main_aux_201912"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--账单数据失败数量")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" cen"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("am_mail_main_log_2019 t "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("bill_month"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("201912")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--单个号码补得数据数量")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v("  cen"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("am_single_phone_2019 t "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("bill_month"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("201912")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("step"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--txt账单数量")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--success 账单txt真正生成的数量")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" stat"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("am_mail_log_2019 t "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v("  t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("POS_MONTH"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("201912")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("REMARKS "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'S'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DETAIL_FLAG"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'E'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DETAIL_FLAG"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'N'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--差异的数据")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" stat"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("am_mail_log_2019 t "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v("  t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("POS_MONTH"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("201912")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("REMARKS "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'S'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("or")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DETAIL_FLAG"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'E'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("or")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DETAIL_FLAG"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'N'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--blocked")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" stat"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("am_mail_log_2019 t "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v("  t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("POS_MONTH"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("201912")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("REMARKS "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'S'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DETAIL_FLAG"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'E'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--fee less then Rs. 5")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" stat"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("am_mail_log_2019 t "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v("  t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("POS_MONTH"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("201912")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("REMARKS "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'S'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DETAIL_FLAG"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'N'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--单个号码补得数据数量")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v("  cen"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("am_single_phone_2019 t "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("bill_month"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("201912")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("step"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--发送邮件 给客户的数据")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" cen"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("am_billing_number_list"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\n\n\n\n\n\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--ebill 数量校验")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" cc "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" cen"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("am_mail_main_aux_201912"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" cc "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" stat"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("am_email_log_2019 t "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("POS_MONTH"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("201912")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("REMARKS"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'S'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" cc "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" stat"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("am_email_log_2019 t "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("POS_MONTH"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("201912")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("REMARKS"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'S'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" cen"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("am_single_phone_2019 t "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("bill_month"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("201912")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("step"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--dup数量")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" cc "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" cen"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("am_mail_main_aux_201912"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" cc "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" stat"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("am_dmail_log_2019 t "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("POS_MONTH"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("201912")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("REMARKS"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'S'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" cc "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" stat"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("am_dmail_log_2019 t "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("POS_MONTH"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("201912")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("REMARKS"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'S'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" cen"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("am_single_phone_2019 t "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("bill_month"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("201912")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("step"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--NTN DATA")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--成功生成的数量")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" cen"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("am_vpn_bill_dtl_201912"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--失败的数量")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" cen"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AM_VPN_BILL_LOG_2019 t "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("bill_month"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("201912")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--需要补得数据量")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v("  cen"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("am_single_phone_2019 t "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("bill_month"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("201912")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("step"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--NTN PDF 数量")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--应该生成的数量")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" cmpk_cen"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("am_vpn_bill_201906 t "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ntn_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("having")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--成功的数量")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" cen"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("am_ntn_mail_log t "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" ntn_flag"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("remarks"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'S'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pos_month"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'201912'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--失败的数量")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" cen"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("am_ntn_mail_log t "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" ntn_flag"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("remarks"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'S'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pos_month"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'201912'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--补得数据")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" cen"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("am_single_group_2019 t "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ntn_flag"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("bill_month"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("201912")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--DEPT PDF")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--应该生成的数量")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" dept_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" cen"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("am_vpn_bill_dtl_201912 t "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dept_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--成功的数量")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" cen"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("am_ntn_mail_log t "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" ntn_flag"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("remarks"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'S'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pos_month"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'201912'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--失败的数量")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" cen"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("am_ntn_mail_log t "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" ntn_flag"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("remarks"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'S'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pos_month"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'201912'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--补得数据")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" cen"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("am_single_group_2019 t "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ntn_flag"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("bill_month"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("201912")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--CUST_NAME")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--应该生成的数量")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" CC "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cust_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" cmpk_cen"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("am_vpn_bill_201906 t "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cust_name "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("is")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("not")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("null")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" cust_name "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("having")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--成功的数量")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" cen"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("am_ntn_mail_log t "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" ntn_flag"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("remarks"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'S'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pos_month"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'201912'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--失败的数量")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" cen"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("am_ntn_mail_log t "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" ntn_flag"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("remarks"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'S'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pos_month"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'201912'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--补得数据")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" cen"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("am_single_group_2019 t "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ntn_flag"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("bill_month"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("201912")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--额外生成的数据")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" CMPK_CEN"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AM_VPN_SUMMARY t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])])])}),[],!1,null,null,null);s.default=r.exports}}]);