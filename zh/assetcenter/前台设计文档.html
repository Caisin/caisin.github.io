<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>前台设计文档 | CMPAK 账管文档</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="CMPAK 账管交维文档">
    
    <link rel="preload" href="/acct-doc/assets/css/0.styles.51d143cd.css" as="style"><link rel="preload" href="/acct-doc/assets/js/app.63ad57cc.js" as="script"><link rel="preload" href="/acct-doc/assets/js/2.33beb707.js" as="script"><link rel="preload" href="/acct-doc/assets/js/28.f3ad07db.js" as="script"><link rel="prefetch" href="/acct-doc/assets/js/10.3a0026ee.js"><link rel="prefetch" href="/acct-doc/assets/js/11.37b0e332.js"><link rel="prefetch" href="/acct-doc/assets/js/12.aeeb4d1b.js"><link rel="prefetch" href="/acct-doc/assets/js/13.ac323191.js"><link rel="prefetch" href="/acct-doc/assets/js/14.bd2cb70d.js"><link rel="prefetch" href="/acct-doc/assets/js/15.e224db95.js"><link rel="prefetch" href="/acct-doc/assets/js/16.1706826f.js"><link rel="prefetch" href="/acct-doc/assets/js/17.d60e9805.js"><link rel="prefetch" href="/acct-doc/assets/js/18.b7a13350.js"><link rel="prefetch" href="/acct-doc/assets/js/19.cf8e7b1d.js"><link rel="prefetch" href="/acct-doc/assets/js/20.105e9797.js"><link rel="prefetch" href="/acct-doc/assets/js/21.b3600cfd.js"><link rel="prefetch" href="/acct-doc/assets/js/22.fc9c31d9.js"><link rel="prefetch" href="/acct-doc/assets/js/23.63486421.js"><link rel="prefetch" href="/acct-doc/assets/js/24.206d6f32.js"><link rel="prefetch" href="/acct-doc/assets/js/25.fcfed3db.js"><link rel="prefetch" href="/acct-doc/assets/js/26.9c2a70ba.js"><link rel="prefetch" href="/acct-doc/assets/js/27.a56776c7.js"><link rel="prefetch" href="/acct-doc/assets/js/29.b5b0f0f5.js"><link rel="prefetch" href="/acct-doc/assets/js/3.e252b8df.js"><link rel="prefetch" href="/acct-doc/assets/js/30.3b82be60.js"><link rel="prefetch" href="/acct-doc/assets/js/31.7cfde945.js"><link rel="prefetch" href="/acct-doc/assets/js/32.b0420cfa.js"><link rel="prefetch" href="/acct-doc/assets/js/33.9208bbca.js"><link rel="prefetch" href="/acct-doc/assets/js/34.1ef2f7cc.js"><link rel="prefetch" href="/acct-doc/assets/js/35.f00cf5a4.js"><link rel="prefetch" href="/acct-doc/assets/js/36.c8d22bd6.js"><link rel="prefetch" href="/acct-doc/assets/js/37.a8d4eb5f.js"><link rel="prefetch" href="/acct-doc/assets/js/4.6f4dd1f9.js"><link rel="prefetch" href="/acct-doc/assets/js/5.1dee15cb.js"><link rel="prefetch" href="/acct-doc/assets/js/6.6d4ac80a.js"><link rel="prefetch" href="/acct-doc/assets/js/7.e14e4b70.js"><link rel="prefetch" href="/acct-doc/assets/js/8.36259b9a.js"><link rel="prefetch" href="/acct-doc/assets/js/9.bbaf23c7.js">
    <link rel="stylesheet" href="/acct-doc/assets/css/0.styles.51d143cd.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/acct-doc/" class="home-link router-link-active"><!----> <span class="site-name">CMPAK 账管文档</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/acct-doc/zh/" class="nav-link router-link-active">
  首页
</a></div><div class="nav-item"><a href="/acct-doc/zh/deploy/" class="nav-link">
  发布
</a></div><div class="nav-item"><a href="/acct-doc/zh/environment/" class="nav-link">
  环境
</a></div><div class="nav-item"><a href="/acct-doc/zh/db/" class="nav-link">
  数据脚本
</a></div><div class="nav-item"><a href="/acct-doc/zh/cache/" class="nav-link">
  缓存
</a></div><div class="nav-item"><a href="/acct-doc/zh/param/" class="nav-link">
  参数
</a></div><div class="nav-item"><a href="/acct-doc/zh/assetcenter/" class="nav-link router-link-active">
  资产中心
</a></div><div class="nav-item"><a href="http://172.25.132.86:9000/cmpk-api/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CSF 服务
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">选择语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/acct-doc/zh/assetcenter/前台设计文档.html" class="nav-link">
  简体中文
</a></li><li class="dropdown-item"><!----> <a href="/acct-doc/en/" class="nav-link">
  English
</a></li></ul></div></div> <a href="http://8.208.26.203:18082/cmpak/acctmanm" target="_blank" rel="noopener noreferrer" class="repo-link">
    Source
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/acct-doc/zh/" class="nav-link router-link-active">
  首页
</a></div><div class="nav-item"><a href="/acct-doc/zh/deploy/" class="nav-link">
  发布
</a></div><div class="nav-item"><a href="/acct-doc/zh/environment/" class="nav-link">
  环境
</a></div><div class="nav-item"><a href="/acct-doc/zh/db/" class="nav-link">
  数据脚本
</a></div><div class="nav-item"><a href="/acct-doc/zh/cache/" class="nav-link">
  缓存
</a></div><div class="nav-item"><a href="/acct-doc/zh/param/" class="nav-link">
  参数
</a></div><div class="nav-item"><a href="/acct-doc/zh/assetcenter/" class="nav-link router-link-active">
  资产中心
</a></div><div class="nav-item"><a href="http://172.25.132.86:9000/cmpk-api/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CSF 服务
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">选择语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/acct-doc/zh/assetcenter/前台设计文档.html" class="nav-link">
  简体中文
</a></li><li class="dropdown-item"><!----> <a href="/acct-doc/en/" class="nav-link">
  English
</a></li></ul></div></div> <a href="http://8.208.26.203:18082/cmpak/acctmanm" target="_blank" rel="noopener noreferrer" class="repo-link">
    Source
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>资产中心</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/acct-doc/zh/assetcenter/" aria-current="page" class="sidebar-link">资产中心</a></li><li><a href="/acct-doc/zh/assetcenter/interface.html" class="sidebar-link">接口出入参</a></li><li><a href="/acct-doc/zh/assetcenter/writeoff.html" class="sidebar-link">抵扣</a></li><li><a href="/acct-doc/zh/assetcenter/前台设计文档.html" class="active sidebar-link">前台设计文档</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#第1章-ntn-bill-query" class="sidebar-link">第1章 NTN Bill Query</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-1-基本描述" class="sidebar-link">1.1 基本描述</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-2-业务流程" class="sidebar-link">1.2 业务流程</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-3-业务表说明" class="sidebar-link">1.3 业务表说明</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-4-关键配置说明" class="sidebar-link">1.4 关键配置说明</a></li></ul></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#第2章-postpaid-payment" class="sidebar-link">第2章 Postpaid Payment</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_2-1-基本描述" class="sidebar-link">2.1 基本描述</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_2-2-业务流程" class="sidebar-link">2.2 业务流程</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_2-3-业务表说明" class="sidebar-link">2.3 业务表说明</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_2-4-关键配置说明" class="sidebar-link">2.4 关键配置说明</a></li></ul></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#第3章-account-fund-transfer" class="sidebar-link">第3章 Account Fund Transfer</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_3-1-基本描述" class="sidebar-link">3.1 基本描述</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_3-2-业务流程" class="sidebar-link">3.2 业务流程</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_3-3-业务表说明" class="sidebar-link">3.3 业务表说明</a></li></ul></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#第4章-cancellation-of-payment" class="sidebar-link">第4章 Cancellation of Payment</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_4-1-基本描述" class="sidebar-link">4.1 基本描述</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_4-2-业务流程" class="sidebar-link">4.2 业务流程</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_4-3-业务表说明" class="sidebar-link">4.3 业务表说明</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_4-4-关键配置说明" class="sidebar-link">4.4 关键配置说明</a></li></ul></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#第5章-clear-bill-for-prepaid" class="sidebar-link">第5章 Clear Bill For PrePaid</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_5-1-基本描述" class="sidebar-link">5.1 基本描述</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_5-2-业务流程" class="sidebar-link">5.2 业务流程</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_5-3-业务表说明" class="sidebar-link">5.3 业务表说明</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_5-4-关键配置说明" class="sidebar-link">5.4 关键配置说明</a></li></ul></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#第6章-add-up-free-resource-checking" class="sidebar-link">第6章 Add Up Free Resource Checking</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_6-1-基本描述" class="sidebar-link">6.1 基本描述</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_6-2-业务流程" class="sidebar-link">6.2 业务流程</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_6-3-业务表说明" class="sidebar-link">6.3 业务表说明</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_6-4-关键配置说明" class="sidebar-link">6.4 关键配置说明</a></li></ul></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#第7章-scratch-card-payment" class="sidebar-link">第7章 Scratch Card Payment</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_7-1-基本描述" class="sidebar-link">7.1 基本描述</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_7-2-业务流程" class="sidebar-link">7.2 业务流程</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_7-3-业务表说明" class="sidebar-link">7.3 业务表说明</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_7-4-关键配置说明" class="sidebar-link">7.4 关键配置说明</a></li></ul></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#第8章-scratch-card-bulk-payment" class="sidebar-link">第8章 Scratch Card Bulk Payment</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_8-1-基本描述" class="sidebar-link">8.1 基本描述</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_8-2-业务流程" class="sidebar-link">8.2 业务流程</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_8-3-业务表说明" class="sidebar-link">8.3 业务表说明</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_8-4-关键配置说明" class="sidebar-link">8.4 关键配置说明</a></li></ul></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#黄典前台文档" class="sidebar-link">黄典前台文档</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#第一章-批量业务导入" class="sidebar-link">第一章 批量业务导入</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#基本描述-basic-description" class="sidebar-link">基本描述-basic description</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#业务流程-business-process" class="sidebar-link">业务流程-business process</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#业务规则-business-rules" class="sidebar-link">业务规则-business rules</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#业务表说明" class="sidebar-link">业务表说明</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#关键配置说明" class="sidebar-link">关键配置说明</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-1基本描述-basic-description" class="sidebar-link">1.1基本描述-basic description</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-2业务流程-business-process" class="sidebar-link">1.2业务流程-business process</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-4业务表说明" class="sidebar-link">1.4业务表说明</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-5关键配置说明" class="sidebar-link">1.5关键配置说明</a></li></ul></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#第三章-支票管理" class="sidebar-link">第三章 支票管理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-1基本描述-basic-description-2" class="sidebar-link">1.1基本描述-basic description</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-2业务流程-business-process-2" class="sidebar-link">1.2业务流程-business process</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-3业务规则-business-rules" class="sidebar-link">1.3业务规则-business rules</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-4业务表说明-2" class="sidebar-link">1.4业务表说明</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-5关键配置说明-2" class="sidebar-link">1.5关键配置说明</a></li></ul></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#第四章-缴费历史查询" class="sidebar-link">第四章 缴费历史查询</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-1基本描述-basic-description-3" class="sidebar-link">1.1基本描述-basic description</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-2业务流程-business-process-3" class="sidebar-link">1.2业务流程-business process</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-3业务规则-business-rules-2" class="sidebar-link">1.3业务规则-business rules</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-4业务表说明-3" class="sidebar-link">1.4业务表说明</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-5关键配置说明-3" class="sidebar-link">1.5关键配置说明</a></li></ul></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#第五章-账单调整-bill-adjustment" class="sidebar-link">第五章 账单调整-Bill Adjustment</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-1基本描述" class="sidebar-link">1.1基本描述</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-2业务流程" class="sidebar-link">1.2业务流程</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-3业务规则-business-rules-3" class="sidebar-link">1.3业务规则-business rules</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-4业务表说明-4" class="sidebar-link">1.4业务表说明</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-5关键配置说明-4" class="sidebar-link">1.5关键配置说明</a></li></ul></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#第六章调账日志查询-bill-adjustment-log-inquiry" class="sidebar-link">第六章调账日志查询-Bill Adjustment log Inquiry</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-1基本描述-basic-description-4" class="sidebar-link">1.1基本描述-Basic description</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-2业务流程-business-process-4" class="sidebar-link">1.2业务流程-Business process</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-3业务规则-business-rules-4" class="sidebar-link">1.3业务规则-business rules</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-4业务表说明-5" class="sidebar-link">1.4业务表说明</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-5关键配置说明-5" class="sidebar-link">1.5关键配置说明</a></li></ul></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#第七章-电子账单查询-duplicate-bill" class="sidebar-link">第七章 电子账单查询-Duplicate Bill</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-1基本描述-basic-description-5" class="sidebar-link">1.1基本描述-Basic description</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-2业务流程-business-process-5" class="sidebar-link">1.2业务流程-Business process</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-3业务规则-special-rules" class="sidebar-link">1.3业务规则-Special rules</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-4业务表说明-6" class="sidebar-link">1.4业务表说明</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-5关键配置说明-6" class="sidebar-link">1.5关键配置说明</a></li></ul></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#第八章-集团账单查询-corporate-bill" class="sidebar-link">第八章 集团账单查询-Corporate Bill</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-1基本描述-basic-description-6" class="sidebar-link">1.1基本描述-Basic description</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-2业务流程-business-process-6" class="sidebar-link">1.2业务流程-Business process</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-3业务规则-special-rules-2" class="sidebar-link">1.3业务规则-Special rules</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-4业务表说明-7" class="sidebar-link">1.4业务表说明</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-5关键配置说明-7" class="sidebar-link">1.5关键配置说明</a></li></ul></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#第九章-黑名单-灰名单管理-black-other-list-management" class="sidebar-link">第九章 黑名单,灰名单管理- Black &amp; Other List Management</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-1基本描述-basic-description-7" class="sidebar-link">1.1基本描述-Basic description</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-2业务流程-business-process-7" class="sidebar-link">1.2业务流程-Business process</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-3业务规则-special-rules-3" class="sidebar-link">1.3业务规则-Special rules</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-4业务表说明-8" class="sidebar-link">1.4业务表说明</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-5关键配置说明-8" class="sidebar-link">1.5关键配置说明</a></li></ul></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#第十章-信控工单查询-debt-order-inquiry" class="sidebar-link">第十章 信控工单查询- Debt Order Inquiry</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-1基本描述-basic-description-8" class="sidebar-link">1.1基本描述-Basic description</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-2业务流程-business-process-8" class="sidebar-link">1.2业务流程-Business process</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-3业务规则-special-rules-4" class="sidebar-link">1.3业务规则-Special rules</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-4业务表说明-9" class="sidebar-link">1.4业务表说明</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-5关键配置说明-9" class="sidebar-link">1.5关键配置说明</a></li></ul></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#第十一章-信控规则查询" class="sidebar-link">第十一章 信控规则查询</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-1基本描述-basic-description-9" class="sidebar-link">1.1基本描述-Basic description</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-2业务流程-business-process-9" class="sidebar-link">1.2业务流程-Business process</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-3业务规则-special-rules-5" class="sidebar-link">1.3业务规则-Special rules</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-4业务表说明-10" class="sidebar-link">1.4业务表说明</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-5关键配置说明-10" class="sidebar-link">1.5关键配置说明</a></li></ul></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#第十二章-批量争议账单管理" class="sidebar-link">第十二章 批量争议账单管理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-1基本描述-basic-description-10" class="sidebar-link">1.1基本描述-basic description</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-2业务流程-business-process-10" class="sidebar-link">1.2业务流程-business process</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-3业务规则-business-rules-5" class="sidebar-link">1.3业务规则-business rules</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-4业务表说明-11" class="sidebar-link">1.4业务表说明</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-5关键配置说明-11" class="sidebar-link">1.5关键配置说明</a></li></ul></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#第十三章批量核销坏账" class="sidebar-link">第十三章批量核销坏账</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-1基本描述-basic-description-11" class="sidebar-link">1.1基本描述-basic description</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-2业务流程-business-process-11" class="sidebar-link">1.2业务流程-business process</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-3业务规则-business-rules-6" class="sidebar-link">1.3业务规则-business rules</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-4业务表说明-12" class="sidebar-link">1.4业务表说明</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-5关键配置说明-12" class="sidebar-link">1.5关键配置说明</a></li></ul></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#第十四章呆坏账管理" class="sidebar-link">第十四章呆坏账管理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-1基本描述-basic-description-12" class="sidebar-link">1.1基本描述-basic description</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-2业务流程-business-process-12" class="sidebar-link">1.2业务流程-business process</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-2业务规则-business-rules" class="sidebar-link">1.2业务规则-business rules</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-4业务表说明-13" class="sidebar-link">1.4业务表说明</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#_1-5关键配置说明-13" class="sidebar-link">1.5关键配置说明</a></li></ul></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#周琪宏前台文档" class="sidebar-link">周琪宏前台文档</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#资金中心" class="sidebar-link">资金中心</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#预付费话费收取-prepaid-payment" class="sidebar-link">预付费话费收取-Prepaid Payment</a></li></ul></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#you-have-loaded-100-00-amount-deducted-0-00-new-balance-is-rs-993-17-valid-up-to-11-12-2019-rs-75-t-week-1000-zong-50-offnet-mins-1000sms-350mb-dial-7" class="sidebar-link">You have loaded 100.00. Amount Deducted 0.00.New balance is Rs.993.17.Valid up to 11-12-2019.Rs.75+T/Week: 1000 Zong &amp; 50 Offnet Mins,1000SMS,350MB. Dial *7#</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#空中充值-cust-etop-issuance" class="sidebar-link">空中充值- Cust Etop Issuance</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#空中充值返销-cust-etop-reversal" class="sidebar-link">空中充值返销- Cust Etop Reversal</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#代理商交易查询-agent-transaction-history-query" class="sidebar-link">代理商交易查询- Agent transaction history query</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#免费资源转移转换-freeres-transfer-transform" class="sidebar-link">免费资源转移转换-Freeres Transfer &amp; Transform</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#退押金-deposit-refund" class="sidebar-link">退押金-Deposit Refund</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#押金返销-deposit-reversal" class="sidebar-link">押金返销-Deposit Reversal</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#批量退押金-batch-deposit-refund" class="sidebar-link">批量退押金-Batch Deposit Refund</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#批量押金缴欠费-batch-deposit-to-owe-fee" class="sidebar-link">批量押金缴欠费-Batch Deposit To Owe Fee</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#押金管理-deposit-management" class="sidebar-link">押金管理-Deposit Management</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#押金操作历史查询页面-query-deposit-business" class="sidebar-link">押金操作历史查询页面-Query Deposit Business</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#ntn-deposit-refund" class="sidebar-link">NTN Deposit Refund</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#query-ntn-deposit-refund" class="sidebar-link">Query NTN Deposit Refund</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#后付费批量调账-postpaid-adjustment" class="sidebar-link">后付费批量调账-Postpaid Adjustment</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#清退-balance-refund" class="sidebar-link">清退-Balance Refund</a></li></ul></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#账详单中心" class="sidebar-link">账详单中心</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#月结账单查询-month-bill-query" class="sidebar-link">月结账单查询-Month Bill Query</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#批量发送ebill-bulk-ebill-query-bulk-ebill" class="sidebar-link">批量发送Ebill-Bulk Ebill &amp; Query Bulk Ebill</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#日账单查询-daily-bill-query" class="sidebar-link">日账单查询-Daily Bill Query</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#详单查询操作日志查询-cdr-oper-log-query" class="sidebar-link">详单查询操作日志查询-CDR Oper Log Query</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#触发账务出日账-real-time-bill" class="sidebar-link">触发账务出日账-Real Time Bill</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#触发账务出日账查询-real-time-bill-query" class="sidebar-link">触发账务出日账查询-Real Time Bill Query</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#代理商账本调整-agent-debit-adjustment" class="sidebar-link">代理商账本调整-Agent Debit Adjustment</a></li></ul></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#基本描述-basic-description-22" class="sidebar-link">基本描述-basic description</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#业务流程-business-process-21" class="sidebar-link">业务流程-business process</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#业务表说明-2" class="sidebar-link">业务表说明</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#关键配置说明-2" class="sidebar-link">关键配置说明</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#基本描述-basic-description-23" class="sidebar-link">基本描述-Basic description</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#功能需求-functional-requirement" class="sidebar-link">功能需求-Functional requirement</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#业务流程-business-process-22" class="sidebar-link">业务流程-business process</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#特殊规则-special-rules" class="sidebar-link">特殊规则-Special rules</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#页面说明-page-description-21" class="sidebar-link">页面说明-Page description</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#详单配置数据介绍" class="sidebar-link">详单配置数据介绍</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#基本描述-basic-description-24" class="sidebar-link">基本描述-basic description</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#业务流程-business-process-23" class="sidebar-link">业务流程-business process</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#业务规则-business-rules-20" class="sidebar-link">业务规则-business rules</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#页面说明-page-description-22" class="sidebar-link">页面说明-Page description</a></li><li class="sidebar-sub-header"><a href="/acct-doc/zh/assetcenter/前台设计文档.html#表介绍" class="sidebar-link">表介绍</a></li></ul></li><li><a href="/acct-doc/zh/assetcenter/后台设计文档.html" class="sidebar-link">后台设计文档</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="前台设计文档"><a href="#前台设计文档" class="header-anchor">#</a> 前台设计文档</h1> <p></p><div class="table-of-contents"><ul><li><a href="#第1章-ntn-bill-query">第1章 NTN Bill Query</a><ul><li><a href="#_1-1-基本描述">1.1 基本描述</a></li><li><a href="#_1-2-业务流程">1.2 业务流程</a></li><li><a href="#_1-3-业务表说明">1.3 业务表说明</a></li><li><a href="#_1-4-关键配置说明">1.4 关键配置说明</a></li></ul></li><li><a href="#第2章-postpaid-payment">第2章 Postpaid Payment</a><ul><li><a href="#_2-1-基本描述">2.1 基本描述</a></li><li><a href="#_2-2-业务流程">2.2 业务流程</a></li><li><a href="#_2-3-业务表说明">2.3 业务表说明</a></li><li><a href="#_2-4-关键配置说明">2.4 关键配置说明</a></li></ul></li><li><a href="#第3章-account-fund-transfer">第3章 Account Fund Transfer</a><ul><li><a href="#_3-1-基本描述">3.1 基本描述</a></li><li><a href="#_3-2-业务流程">3.2 业务流程</a></li><li><a href="#_3-3-业务表说明">3.3 业务表说明</a></li></ul></li><li><a href="#第4章-cancellation-of-payment">第4章 Cancellation of Payment</a><ul><li><a href="#_4-1-基本描述">4.1 基本描述</a></li><li><a href="#_4-2-业务流程">4.2 业务流程</a></li><li><a href="#_4-3-业务表说明">4.3 业务表说明</a></li><li><a href="#_4-4-关键配置说明">4.4 关键配置说明</a></li></ul></li><li><a href="#第5章-clear-bill-for-prepaid">第5章 Clear Bill For PrePaid</a><ul><li><a href="#_5-1-基本描述">5.1 基本描述</a></li><li><a href="#_5-2-业务流程">5.2 业务流程</a></li><li><a href="#_5-3-业务表说明">5.3 业务表说明</a></li><li><a href="#_5-4-关键配置说明">5.4 关键配置说明</a></li></ul></li><li><a href="#第6章-add-up-free-resource-checking">第6章 Add Up Free Resource Checking</a><ul><li><a href="#_6-1-基本描述">6.1 基本描述</a></li><li><a href="#_6-2-业务流程">6.2 业务流程</a></li><li><a href="#_6-3-业务表说明">6.3 业务表说明</a></li><li><a href="#_6-4-关键配置说明">6.4 关键配置说明</a></li></ul></li><li><a href="#第7章-scratch-card-payment">第7章 Scratch Card Payment</a><ul><li><a href="#_7-1-基本描述">7.1 基本描述</a></li><li><a href="#_7-2-业务流程">7.2 业务流程</a></li><li><a href="#_7-3-业务表说明">7.3 业务表说明</a></li><li><a href="#_7-4-关键配置说明">7.4 关键配置说明</a></li></ul></li><li><a href="#第8章-scratch-card-bulk-payment">第8章 Scratch Card Bulk Payment</a><ul><li><a href="#_8-1-基本描述">8.1 基本描述</a></li><li><a href="#_8-2-业务流程">8.2 业务流程</a></li><li><a href="#_8-3-业务表说明">8.3 业务表说明</a></li><li><a href="#_8-4-关键配置说明">8.4 关键配置说明</a></li></ul></li><li><a href="#黄典前台文档">黄典前台文档</a></li><li><a href="#第一章-批量业务导入">第一章 批量业务导入</a><ul><li><a href="#基本描述-basic-description">基本描述-basic description</a></li><li><a href="#业务流程-business-process">业务流程-business process</a></li><li><a href="#业务规则-business-rules">业务规则-business rules</a></li><li><a href="#业务表说明">业务表说明</a></li><li><a href="#关键配置说明">关键配置说明</a></li><li><a href="#_1-1基本描述-basic-description">1.1基本描述-basic description</a></li><li><a href="#_1-2业务流程-business-process">1.2业务流程-business process</a></li><li><a href="#_1-4业务表说明">1.4业务表说明</a></li><li><a href="#_1-5关键配置说明">1.5关键配置说明</a></li></ul></li><li><a href="#第三章-支票管理">第三章 支票管理</a><ul><li><a href="#_1-1基本描述-basic-description">1.1基本描述-basic description</a></li><li><a href="#_1-2业务流程-business-process">1.2业务流程-business process</a></li><li><a href="#_1-3业务规则-business-rules">1.3业务规则-business rules</a></li><li><a href="#_1-4业务表说明">1.4业务表说明</a></li><li><a href="#_1-5关键配置说明">1.5关键配置说明</a></li></ul></li><li><a href="#第四章-缴费历史查询">第四章 缴费历史查询</a><ul><li><a href="#_1-1基本描述-basic-description">1.1基本描述-basic description</a></li><li><a href="#_1-2业务流程-business-process">1.2业务流程-business process</a></li><li><a href="#_1-3业务规则-business-rules">1.3业务规则-business rules</a></li><li><a href="#_1-4业务表说明">1.4业务表说明</a></li><li><a href="#_1-5关键配置说明">1.5关键配置说明</a></li></ul></li><li><a href="#第五章-账单调整-bill-adjustment">第五章 账单调整-Bill Adjustment</a><ul><li><a href="#_1-1基本描述">1.1基本描述</a></li><li><a href="#_1-2业务流程">1.2业务流程</a></li><li><a href="#_1-3业务规则-business-rules">1.3业务规则-business rules</a></li><li><a href="#_1-4业务表说明">1.4业务表说明</a></li><li><a href="#_1-5关键配置说明">1.5关键配置说明</a></li></ul></li><li><a href="#第六章调账日志查询-bill-adjustment-log-inquiry">第六章调账日志查询-Bill Adjustment log Inquiry</a><ul><li><a href="#_1-1基本描述-basic-description">1.1基本描述-Basic description</a></li><li><a href="#_1-2业务流程-business-process">1.2业务流程-Business process</a></li><li><a href="#_1-3业务规则-business-rules">1.3业务规则-business rules</a></li><li><a href="#_1-4业务表说明">1.4业务表说明</a></li><li><a href="#_1-5关键配置说明">1.5关键配置说明</a></li></ul></li><li><a href="#第七章-电子账单查询-duplicate-bill">第七章 电子账单查询-Duplicate Bill</a><ul><li><a href="#_1-1基本描述-basic-description">1.1基本描述-Basic description</a></li><li><a href="#_1-2业务流程-business-process">1.2业务流程-Business process</a></li><li><a href="#_1-3业务规则-special-rules">1.3业务规则-Special rules</a></li><li><a href="#_1-4业务表说明">1.4业务表说明</a></li><li><a href="#_1-5关键配置说明">1.5关键配置说明</a></li></ul></li><li><a href="#第八章-集团账单查询-corporate-bill">第八章 集团账单查询-Corporate Bill</a><ul><li><a href="#_1-1基本描述-basic-description">1.1基本描述-Basic description</a></li><li><a href="#_1-2业务流程-business-process">1.2业务流程-Business process</a></li><li><a href="#_1-3业务规则-special-rules">1.3业务规则-Special rules</a></li><li><a href="#_1-4业务表说明">1.4业务表说明</a></li><li><a href="#_1-5关键配置说明">1.5关键配置说明</a></li></ul></li><li><a href="#第九章-黑名单-灰名单管理-black-other-list-management">第九章 黑名单,灰名单管理- Black &amp; Other List Management</a><ul><li><a href="#_1-1基本描述-basic-description">1.1基本描述-Basic description</a></li><li><a href="#_1-2业务流程-business-process">1.2业务流程-Business process</a></li><li><a href="#_1-3业务规则-special-rules">1.3业务规则-Special rules</a></li><li><a href="#_1-4业务表说明">1.4业务表说明</a></li><li><a href="#_1-5关键配置说明">1.5关键配置说明</a></li></ul></li><li><a href="#第十章-信控工单查询-debt-order-inquiry">第十章 信控工单查询- Debt Order Inquiry</a><ul><li><a href="#_1-1基本描述-basic-description">1.1基本描述-Basic description</a></li><li><a href="#_1-2业务流程-business-process">1.2业务流程-Business process</a></li><li><a href="#_1-3业务规则-special-rules">1.3业务规则-Special rules</a></li><li><a href="#_1-4业务表说明">1.4业务表说明</a></li><li><a href="#_1-5关键配置说明">1.5关键配置说明</a></li></ul></li><li><a href="#第十一章-信控规则查询">第十一章 信控规则查询</a><ul><li><a href="#_1-1基本描述-basic-description">1.1基本描述-Basic description</a></li><li><a href="#_1-2业务流程-business-process">1.2业务流程-Business process</a></li><li><a href="#_1-3业务规则-special-rules">1.3业务规则-Special rules</a></li><li><a href="#_1-4业务表说明">1.4业务表说明</a></li><li><a href="#_1-5关键配置说明">1.5关键配置说明</a></li></ul></li><li><a href="#第十二章-批量争议账单管理">第十二章 批量争议账单管理</a><ul><li><a href="#_1-1基本描述-basic-description">1.1基本描述-basic description</a></li><li><a href="#_1-2业务流程-business-process">1.2业务流程-business process</a></li><li><a href="#_1-3业务规则-business-rules">1.3业务规则-business rules</a></li><li><a href="#_1-4业务表说明">1.4业务表说明</a></li><li><a href="#_1-5关键配置说明">1.5关键配置说明</a></li></ul></li><li><a href="#第十三章批量核销坏账">第十三章批量核销坏账</a><ul><li><a href="#_1-1基本描述-basic-description">1.1基本描述-basic description</a></li><li><a href="#_1-2业务流程-business-process">1.2业务流程-business process</a></li><li><a href="#_1-3业务规则-business-rules">1.3业务规则-business rules</a></li><li><a href="#_1-4业务表说明">1.4业务表说明</a></li><li><a href="#_1-5关键配置说明">1.5关键配置说明</a></li></ul></li><li><a href="#第十四章呆坏账管理">第十四章呆坏账管理</a><ul><li><a href="#_1-1基本描述-basic-description">1.1基本描述-basic description</a></li><li><a href="#_1-2业务流程-business-process">1.2业务流程-business process</a></li><li><a href="#_1-2业务规则-business-rules">1.2业务规则-business rules</a></li><li><a href="#_1-4业务表说明">1.4业务表说明</a></li><li><a href="#_1-5关键配置说明">1.5关键配置说明</a></li></ul></li><li><a href="#周琪宏前台文档">周琪宏前台文档</a></li><li><a href="#资金中心">资金中心</a><ul><li><a href="#预付费话费收取-prepaid-payment">预付费话费收取-Prepaid Payment</a></li></ul></li><li><a href="#you-have-loaded-100-00-amount-deducted-0-00-new-balance-is-rs-993-17-valid-up-to-11-12-2019-rs-75-t-week-1000-zong-50-offnet-mins-1000sms-350mb-dial-7">You have loaded 100.00. Amount Deducted 0.00.New balance is Rs.993.17.Valid up to 11-12-2019.Rs.75+T/Week: 1000 Zong &amp; 50 Offnet Mins,1000SMS,350MB. Dial *7#</a><ul><li><a href="#空中充值-cust-etop-issuance">空中充值- Cust Etop Issuance</a></li><li><a href="#空中充值返销-cust-etop-reversal">空中充值返销- Cust Etop Reversal</a></li><li><a href="#代理商交易查询-agent-transaction-history-query">代理商交易查询- Agent transaction history query</a></li><li><a href="#免费资源转移转换-freeres-transfer-transform">免费资源转移转换-Freeres Transfer &amp; Transform</a></li><li><a href="#退押金-deposit-refund">退押金-Deposit Refund</a></li><li><a href="#押金返销-deposit-reversal">押金返销-Deposit Reversal</a></li><li><a href="#批量退押金-batch-deposit-refund">批量退押金-Batch Deposit Refund</a></li><li><a href="#批量押金缴欠费-batch-deposit-to-owe-fee">批量押金缴欠费-Batch Deposit To Owe Fee</a></li><li><a href="#押金管理-deposit-management">押金管理-Deposit Management</a></li><li><a href="#押金操作历史查询页面-query-deposit-business">押金操作历史查询页面-Query Deposit Business</a></li><li><a href="#ntn-deposit-refund">NTN Deposit Refund</a></li><li><a href="#query-ntn-deposit-refund">Query NTN Deposit Refund</a></li><li><a href="#后付费批量调账-postpaid-adjustment">后付费批量调账-Postpaid Adjustment</a></li><li><a href="#清退-balance-refund">清退-Balance Refund</a></li></ul></li><li><a href="#账详单中心">账详单中心</a><ul><li><a href="#月结账单查询-month-bill-query">月结账单查询-Month Bill Query</a></li><li><a href="#批量发送ebill-bulk-ebill-query-bulk-ebill">批量发送Ebill-Bulk Ebill &amp; Query Bulk Ebill</a></li><li><a href="#日账单查询-daily-bill-query">日账单查询-Daily Bill Query</a></li><li><a href="#详单查询操作日志查询-cdr-oper-log-query">详单查询操作日志查询-CDR Oper Log Query</a></li><li><a href="#触发账务出日账-real-time-bill">触发账务出日账-Real Time Bill</a></li><li><a href="#触发账务出日账查询-real-time-bill-query">触发账务出日账查询-Real Time Bill Query</a></li><li><a href="#代理商账本调整-agent-debit-adjustment">代理商账本调整-Agent Debit Adjustment</a></li></ul></li><li><a href="#基本描述-basic-description">基本描述-basic description</a></li><li><a href="#业务流程-business-process">业务流程-business process</a></li><li><a href="#业务表说明">业务表说明</a></li><li><a href="#关键配置说明">关键配置说明</a></li><li><a href="#基本描述-basic-description">基本描述-Basic description</a></li><li><a href="#功能需求-functional-requirement">功能需求-Functional requirement</a></li><li><a href="#业务流程-business-process">业务流程-business process</a></li><li><a href="#特殊规则-special-rules">特殊规则-Special rules</a></li><li><a href="#页面说明-page-description">页面说明-Page description</a></li><li><a href="#详单配置数据介绍">详单配置数据介绍</a></li><li><a href="#基本描述-basic-description">基本描述-basic description</a></li><li><a href="#业务流程-business-process">业务流程-business process</a></li><li><a href="#业务规则-business-rules">业务规则-business rules</a></li><li><a href="#页面说明-page-description">页面说明-Page description</a></li><li><a href="#表介绍">表介绍</a></li></ul></div><p></p> <h2 id="第1章-ntn-bill-query"><a href="#第1章-ntn-bill-query" class="header-anchor">#</a> 第1章 NTN Bill Query</h2> <h3 id="_1-1-基本描述"><a href="#_1-1-基本描述" class="header-anchor">#</a> 1.1 基本描述</h3> <p>​		通过NTN、DEPT、开始结束月份,实时统计NTN当前成员每个月的总出账金额,历史欠费,缴费金额,</p> <p>成NTN员总的历史欠费,总的实时月账单,余额,信用度,账单的总体信息，后付费明细和预付费明细</p> <h3 id="_1-2-业务流程"><a href="#_1-2-业务流程" class="header-anchor">#</a> 1.2 业务流程</h3> <ol><li><p>输入NTN号码,开始结束月份,DEPT选填；</p></li> <li><p>点击查询,生成一条NTN工单；</p></li> <li><p>NTN Bill Query的工单会异步处理,生成成员详细信息；</p></li> <li><p>后台处理逻辑见后台文档</p></li></ol> <h3 id="_1-3-业务表说明"><a href="#_1-3-业务表说明" class="header-anchor">#</a> 1.3 业务表说明</h3> <ol><li><p>NTN工单表</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> cen<span class="token punctuation">.</span>AM_NTN_TASK<span class="token punctuation">;</span>
</code></pre></div></li> <li><p>NTN详情</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> cen<span class="token punctuation">.</span>AM_NTN_TASK_DETAILS
</code></pre></div></li> <li><p>NTN 费用信息</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> cen<span class="token punctuation">.</span>AM_NTN_FEE<span class="token punctuation">;</span>
</code></pre></div></li></ol> <h3 id="_1-4-关键配置说明"><a href="#_1-4-关键配置说明" class="header-anchor">#</a> 1.4 关键配置说明</h3> <ol><li><p>前台类</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>asiainfo<span class="token punctuation">.</span>bill<span class="token punctuation">.</span>saas<span class="token punctuation">.</span>view<span class="token punctuation">.</span>vc<span class="token punctuation">.</span>core<span class="token punctuation">.</span>bill<span class="token punctuation">.</span></span>NtnBillQuery</span>
</code></pre></div></li> <li><p>后台处理逻辑</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>asiainfo<span class="token punctuation">.</span>asset<span class="token punctuation">.</span>core<span class="token punctuation">.</span>center<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>payment<span class="token punctuation">.</span>interfaces<span class="token punctuation">.</span></span>ITaskCSV</span>#ntnBillQuery
</code></pre></div></li></ol> <h2 id="第2章-postpaid-payment"><a href="#第2章-postpaid-payment" class="header-anchor">#</a> 第2章 Postpaid Payment</h2> <h3 id="_2-1-基本描述"><a href="#_2-1-基本描述" class="header-anchor">#</a> 2.1 基本描述</h3> <p>​	后付费话费收取是指通过查询客户的历史及当期帐务资料，收取客户的费用，并同时触发销帐请求的过程。具体处理通过营业人员和客户进行前台交互或客户自助完成。</p> <h3 id="_2-2-业务流程"><a href="#_2-2-业务流程" class="header-anchor">#</a> 2.2 业务流程</h3> <h4 id="_2-2-1-主体流程"><a href="#_2-2-1-主体流程" class="header-anchor">#</a> 2.2.1 主体流程</h4> <ol><li>点击Payment（后付费现金充值）菜单；</li> <li>页面输入手机号码/用户编码/账户编号；</li> <li>点击查询后，展示账户费用信息；</li> <li>点击账本明细,可看到用户的账本科目和对应的余额;</li> <li>金额对应框，输入充值额度，单位为元；</li> <li>选择账本类型,充值到对应账本。</li> <li>点击高级选项可以选择现金或者支票支付,填写缴费备注。</li> <li>点击“SUbmit”按钮或者点击屏幕中对应金额，提交充值请求到后台。</li> <li>后台接收查询请求，如下10-17步：</li> <li>如果是支票缴费,需要扣除支票余额</li> <li>将充值金额缴入到账户对应账本；(AM_BALANCE_MM,AM_BAL_IN,AM_BAL_OUT)</li> <li>记录缴费,统计日志。(AM_BUSI,i_Busi_Bal_Staff)</li> <li>代理商风控判断</li> <li>给账户进行往月账单销账,支持同步/异步处理销账。(AM_Writeoff,am_bill_item)</li> <li>生成资产上发工单将账户资产上发到ABM,触发停开机,资产上发为增量上发。(Ca_Asset_Syn)</li> <li>后付费缴费不发短信；</li> <li>弹出充值成功提示；</li> <li>打印收据;</li></ol> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">//代理商风控逻辑</span>
<span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>asiainfo<span class="token punctuation">.</span>asset<span class="token punctuation">.</span>core<span class="token punctuation">.</span>center<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>payment<span class="token punctuation">.</span>impl<span class="token punctuation">.</span></span>PaymentCSVImpl</span>#agentRisk；
</code></pre></div><h4 id="_2-2-2-业务规则"><a href="#_2-2-2-业务规则" class="header-anchor">#</a> 2.2.2 业务规则</h4> <ol><li><p>缴费规则</p> <p>a. 缴费金额只能&gt;=0。</p> <p>b. 必须指定缴入账本。</p> <p>c. 只能给后付费用户缴费</p> <p>d. 支票缴费需要调用支票管理接口,校验支票额度</p> <p>e. 信用卡缴费是线下刷卡，不需要帐管系统连接刷卡设备,只需录入相关信息</p> <p>f. 员工额度不足,无法缴费</p></li> <li><p>销账规则</p> <p>a. 读取账户的往月账单</p> <p>b. 读取该账户的账本数据</p> <p>c. 账本排序，规则如下</p> <p>专款优先&gt;账本优先级小的优先&gt;失效时间小的优先&gt;不可退优先级高于可退&gt;赠送存折优先级高于现金存折&gt;开始生效时间小的优先&gt;帐本标识小的优先</p> <p>d. 账单排序，规则如下</p> <p>结账日小的优先&gt;负账单的优先&gt;账目优先级小的优先&gt;用户标识小的优先&gt;账目标识小的优先</p> <p>e. 使用排序后的账本 ，循环冲销排序后的账单</p> <p>普通账户按照排序后的账单和账本以及销账规则正常冲销即可；</p> <p>存在负账单账户,将负账单当成普通现金存折(用户在营业前台通过现金充值存入的账本)处理,优先级同现金存折</p> <p>f. 记录销账结果</p> <p>g. 销账异常记录错误日志</p> <p>如果账户由于某些原因导致无法销账则记录错误日志</p></li></ol> <h3 id="_2-3-业务表说明"><a href="#_2-3-业务表说明" class="header-anchor">#</a> 2.3 业务表说明</h3> <p>业务表:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">--AC1-8用户</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> am_bill_item<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> AM_ACCT_DEBT_mm
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> am_writeoff
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> am_busiam_busi_ext
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> am_bill_item_h
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> am_bal_in
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> am_bal_out
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> ca_asset_syn
</code></pre></div><p>参数表 :</p> <div class="language-sql extra-class"><pre class="language-sql"><code> <span class="token comment">--param用户:</span>
 <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> am_asset_type<span class="token punctuation">;</span>
 <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> am_asset_type_class <span class="token punctuation">;</span>
</code></pre></div><h3 id="_2-4-关键配置说明"><a href="#_2-4-关键配置说明" class="header-anchor">#</a> 2.4 关键配置说明</h3> <ol><li><p>前台页面类</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>asiainfo<span class="token punctuation">.</span>asset<span class="token punctuation">.</span>saas<span class="token punctuation">.</span>view<span class="token punctuation">.</span>cs<span class="token punctuation">.</span>core<span class="token punctuation">.</span>payment<span class="token punctuation">.</span></span>Payment</span>
</code></pre></div></li> <li><p>同步异步缴费开关</p></li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> t<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>t<span class="token punctuation">.</span>rowid <span class="token keyword">from</span> param<span class="token punctuation">.</span>bs_sys_profiles t <span class="token keyword">where</span> t<span class="token punctuation">.</span>profile_code <span class="token operator">like</span> <span class="token string">'%AM_ASYNC_PAYMENT_VALID_%'</span><span class="token punctuation">;</span>
</code></pre></div><ol start="3"><li>实时账单socket查询开关</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> t<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>t<span class="token punctuation">.</span>rowid <span class="token keyword">from</span> param<span class="token punctuation">.</span>bs_sys_profiles t <span class="token keyword">where</span> t<span class="token punctuation">.</span>profile_code<span class="token operator">=</span><span class="token string">'AMS_YC_SWITCH'</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> param<span class="token punctuation">.</span>bs_sys_profiles <span class="token punctuation">(</span>PROFILE_TYPE<span class="token punctuation">,</span> PROFILE_CODE<span class="token punctuation">,</span> PROFILE_VALUE<span class="token punctuation">,</span> REGION_ID<span class="token punctuation">,</span> REMARK<span class="token punctuation">)</span><span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token string">'AMS_YC_SWITCH'</span><span class="token punctuation">,</span> <span class="token string">'AMS_YC_SWITCH'</span><span class="token punctuation">,</span> <span class="token string">'true'</span><span class="token punctuation">,</span> <span class="token string">'ZZZZ'</span><span class="token punctuation">,</span> <span class="token string">'实时账单查询开关'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">*</span>
</code></pre></div><ol start="4"><li><p>抵扣期切换</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> t<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>t<span class="token punctuation">.</span>rowid <span class="token keyword">from</span> param<span class="token punctuation">.</span>am_cycle t <span class="token keyword">where</span> t<span class="token punctuation">.</span>cycle_id <span class="token operator">in</span><span class="token punctuation">(</span><span class="token number">201910</span><span class="token punctuation">,</span><span class="token number">201911</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ol> <h2 id="第3章-account-fund-transfer"><a href="#第3章-account-fund-transfer" class="header-anchor">#</a> 第3章 Account Fund Transfer</h2> <h3 id="_3-1-基本描述"><a href="#_3-1-基本描述" class="header-anchor">#</a> 3.1 基本描述</h3> <p>通过输入转入转出号码/账户,做账户资金转移.</p> <p>支持后付费转后付费/预付费转预付费</p> <h3 id="_3-2-业务流程"><a href="#_3-2-业务流程" class="header-anchor">#</a> 3.2 业务流程</h3> <ol><li><p>点击Account Transfer菜单进入页面；</p></li> <li><p>点击Select Transfer Out Number弹出转出号码查询页面</p></li> <li><p>选择按照Telephone Number或者Account Id为搜索条件，进行查询</p></li> <li><p>后台根据手机号码或者账户id去调用三户信息接口得到三户资料</p></li> <li><p>根据三户资料判断此用户付费类型，如果是预付费调用预付费余额查询接口，如果是后付费调用后付费余额查询接口（预付费余额是由dbm和上发表数据2部分组成，目前返回的应该只有资产上发表数据ca_asset_syn）</p></li> <li><p>查询以后资产科目和余额会在页面展示，选择我们要进行转账的资产科目（转入转出资产科目会保持一致）。</p></li> <li><p>点击Select Transfer In Number弹出转入号码查询页面</p></li> <li><p>选择按照Telephone Number或者Account Id为搜索条件，进行查询</p></li> <li><p>后台根据手机号码或者账户id去调用三户信息接口得到三户资料（不查询余额信息）</p></li> <li><p>选择Transfer method转账方式，目前支持百分比和固定值转账</p></li> <li><p>输入百分比或者固定金额并填写转账原因，提交转账</p></li> <li><p>后台需要判断转入转出号码bill_type,2个号码bill_type必须一样，需要同时为后付费或者预付费，否则抛错。</p></li> <li><p>如果是后付费调用后付费转账接口asset_IAuditCSV_transAmount
先判断是否有未完成的工单不能转账AM_BUSI_TASK
查询转出账户余额AM_BALANCE（排出不能清退和转账的）
判断转出账号相应科目是否余额是否够转出，如果不够抛错‘可清退/转账金额不足’
转出扣减AM_BALANCE资金变动记录AM_BAL_OUT
转出插入业务日志AM_BUSI
转出调用资产上发接口asset_IPaymentCSV_writeAdAsset
转入增加AM_BALANCE资金变动记录AM_BAL_IN
转入插入业务日志AM_BUSI
转入调用资产上发接口asset_IPaymentCSV_writeAdAsset</p></li> <li><p>如果是预付费调用预付费转账接口asset_IAuditCSV_transPrepayAmount
转出调用预付费调低调高方法进行余额调整
记录转出资金变动记录AM_BAL_OUT
转出结果资产上发CA_ASSET_SYN
转出插入业务日志AM_BUSI
发送短信
转入调用预付费调低调高方法进行余额调整
记录转入资金变动记录AM_BAL_IN
转入结果资产上发CA_ASSET_SYN
转入插入业务日志AM_BUSI
调用crm用户状态变更、账户周期有效期变更接口
调用crm扣减操作员虚拟信誉度接口
调用crm充值赠送接口</p> <p>发送短信</p></li></ol> <h3 id="_3-3-业务表说明"><a href="#_3-3-业务表说明" class="header-anchor">#</a> 3.3 业务表说明</h3> <ol><li><p>业务记录表</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> acx<span class="token punctuation">.</span>AM_BUSI<span class="token punctuation">;</span>
</code></pre></div></li> <li><p>后付费账本表</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> ACX<span class="token punctuation">.</span>am_balance_mm
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> acx<span class="token punctuation">.</span>AM_BAL_IN<span class="token punctuation">;</span>
</code></pre></div></li> <li><p>资产上发表</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">Select</span> <span class="token operator">*</span> <span class="token keyword">from</span> ACX<span class="token punctuation">.</span>ca_asset_syn<span class="token punctuation">;</span>
<span class="token keyword">Select</span> <span class="token operator">*</span> <span class="token keyword">from</span> ACX<span class="token punctuation">.</span>ca_asset_syn_h<span class="token punctuation">;</span>
</code></pre></div></li></ol> <div class="language- extra-class"><pre class="language-text"><code>    
    

### 3.4 关键配置说明

1. 前台页面类

   ```java
   com.asiainfo.asset.saas.view.cs.core.audit.TransAcct
</code></pre></div><h2 id="第4章-cancellation-of-payment"><a href="#第4章-cancellation-of-payment" class="header-anchor">#</a> 第4章 Cancellation of Payment</h2> <h3 id="_4-1-基本描述"><a href="#_4-1-基本描述" class="header-anchor">#</a> 4.1 基本描述</h3> <p>根据用户手机号码/账户号码/缴费流水查询一段时间内充值记录，对指定的充值记录做撤单的功能</p> <p>支持预付费/后付费</p> <h3 id="_4-2-业务流程"><a href="#_4-2-业务流程" class="header-anchor">#</a> 4.2 业务流程</h3> <ol><li>页面输入查询条件，如手机号码、销号状态、收费时间，点击查询；</li> <li>点击查询后，查询缴费记录；</li> <li>查询账户类型；
3.1 如果账户是大账户，根据账户id和缴费业务流水查询大账户销账日志和抵扣日志
3.2 如果账户不是是大账户，根据账户id和缴费业务流水查询普通账户销账日志和抵扣日志</li> <li>根据销账日志、抵扣日志得到销账费用</li> <li>过滤不可返销和充值记录为0的记录</li> <li>将缴费记录和销账费用返回到页面</li> <li>用户选择一条缴费记录，点击“返销”按钮</li> <li>在弹出的页面中，输入备注信息，点击“提交”按钮</li> <li>当前缴费记录不是今天并且操作员没有跨日和跨月返销权限,页面提示错误信息</li> <li>返销缴费日志,增加一条冲正记录</li> <li>返销账本收入和支出日志，回退账本余额</li> <li>回退账单和销账记录</li> <li>支票缴费需要回退支票额度</li> <li>返销回退操作员额度</li> <li>资产上发</li></ol> <h3 id="_4-3-业务表说明"><a href="#_4-3-业务表说明" class="header-anchor">#</a> 4.3 业务表说明</h3> <ol><li><p>业务记录表</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">--AC1-8用户</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> am_bill_item<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> AM_ACCT_DEBT_mm<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> am_writeoff<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> am_busiam_busi_ext<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> am_bill_item_h<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> am_bal_in<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> am_bal_out<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> ca_asset_syn<span class="token punctuation">;</span>
</code></pre></div></li></ol> <h3 id="_4-4-关键配置说明"><a href="#_4-4-关键配置说明" class="header-anchor">#</a> 4.4 关键配置说明</h3> <ol><li><p>前台页面类</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>asiainfo<span class="token punctuation">.</span>asset<span class="token punctuation">.</span>saas<span class="token punctuation">.</span>view<span class="token punctuation">.</span>cs<span class="token punctuation">.</span>core<span class="token punctuation">.</span>payment<span class="token punctuation">.</span></span>PaymentCancel</span>
</code></pre></div></li> <li><p>前台可撤单业务类型</p></li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">Select</span> <span class="token operator">*</span> <span class="token keyword">from</span> PARAM<span class="token punctuation">.</span>bs_sys_profiles t <span class="token keyword">where</span> t<span class="token punctuation">.</span>profile_code <span class="token operator">=</span><span class="token string">'PayBusiT'</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="第5章-clear-bill-for-prepaid"><a href="#第5章-clear-bill-for-prepaid" class="header-anchor">#</a> 第5章 Clear Bill For PrePaid</h2> <h3 id="_5-1-基本描述"><a href="#_5-1-基本描述" class="header-anchor">#</a> 5.1 基本描述</h3> <p>​	用户在从后付费用户转为预付费后,缴清历史欠费账单。</p> <h3 id="_5-2-业务流程"><a href="#_5-2-业务流程" class="header-anchor">#</a> 5.2 业务流程</h3> <ol><li><p>只能是预付费用户</p></li> <li><p>其余与后付费缴费一致</p></li> <li><p>必须是预付费用户</p></li></ol> <h3 id="_5-3-业务表说明"><a href="#_5-3-业务表说明" class="header-anchor">#</a> 5.3 业务表说明</h3> <p>同 Postpaid Payment</p> <h3 id="_5-4-关键配置说明"><a href="#_5-4-关键配置说明" class="header-anchor">#</a> 5.4 关键配置说明</h3> <p>同 Postpaid Payment</p> <h2 id="第6章-add-up-free-resource-checking"><a href="#第6章-add-up-free-resource-checking" class="header-anchor">#</a> 第6章 Add Up Free Resource Checking</h2> <h3 id="_6-1-基本描述"><a href="#_6-1-基本描述" class="header-anchor">#</a> 6.1 基本描述</h3> <p>查询用户累积量</p> <h3 id="_6-2-业务流程"><a href="#_6-2-业务流程" class="header-anchor">#</a> 6.2 业务流程</h3> <p>通过计费827接口查询累积量并展示到前台</p> <h3 id="_6-3-业务表说明"><a href="#_6-3-业务表说明" class="header-anchor">#</a> 6.3 业务表说明</h3> <p>无</p> <h3 id="_6-4-关键配置说明"><a href="#_6-4-关键配置说明" class="header-anchor">#</a> 6.4 关键配置说明</h3> <h2 id="第7章-scratch-card-payment"><a href="#第7章-scratch-card-payment" class="header-anchor">#</a> 第7章 Scratch Card Payment</h2> <h3 id="_7-1-基本描述"><a href="#_7-1-基本描述" class="header-anchor">#</a> 7.1 基本描述</h3> <p>通过输入手机号码,VC卡卡密,调用能开接口,通过VC平台充值</p> <h3 id="_7-2-业务流程"><a href="#_7-2-业务流程" class="header-anchor">#</a> 7.2 业务流程</h3> <ol><li>点击Scratch Card Payment菜单进入页面；</li> <li>输入手机号码，点击查询，调用三户信息查询接口</li> <li>预付费号码,N_0和N_5状态号码不能充值</li> <li>如果是预付费号码，填入HRN Password（充值卡卡密）</li> <li>调用VC平台的充值接口充值（CMPK_VCPT_Recharge）</li></ol> <h3 id="_7-3-业务表说明"><a href="#_7-3-业务表说明" class="header-anchor">#</a> 7.3 业务表说明</h3> <h3 id="_7-4-关键配置说明"><a href="#_7-4-关键配置说明" class="header-anchor">#</a> 7.4 关键配置说明</h3> <h2 id="第8章-scratch-card-bulk-payment"><a href="#第8章-scratch-card-bulk-payment" class="header-anchor">#</a> 第8章 Scratch Card Bulk Payment</h2> <h3 id="_8-1-基本描述"><a href="#_8-1-基本描述" class="header-anchor">#</a> 8.1 基本描述</h3> <p>​	批量手机号码VC充值</p> <h3 id="_8-2-业务流程"><a href="#_8-2-业务流程" class="header-anchor">#</a> 8.2 业务流程</h3> <ol><li>点击Scratch Card Bulk Payment菜单进入页面；</li> <li>点击页面Recharge file template下载excel模板；</li> <li>按模板填好充值数据，点击Import a file导入批量充值excel文件</li> <li>导入数据后，后台会对excel数据进行校验，校验结果展示页面table中
校验HRN Password不能为空
手机号码重复性校验
调用三户信息接口查询手机号码是否存在</li> <li>页面table还支持excel导入后单个导个充值导入
填写Mobile Number，HRN Password增加一行充值记录
点击Add，后台会先对Mobile Number，HRN Password进行步骤4的校验
校验通过后添加此充值记录到页面table中
点击Submit按钮提交table数据，插入AM_BATCH_PAYMENT 7788工单</li></ol> <h3 id="_8-3-业务表说明"><a href="#_8-3-业务表说明" class="header-anchor">#</a> 8.3 业务表说明</h3> <ol><li><p>工单表</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> cen<span class="token punctuation">.</span>AM_BATCH_PAYMENT t <span class="token keyword">where</span> t<span class="token punctuation">.</span>trade_type_code<span class="token operator">=</span><span class="token string">'7788'</span><span class="token punctuation">;</span>
</code></pre></div></li></ol> <h3 id="_8-4-关键配置说明"><a href="#_8-4-关键配置说明" class="header-anchor">#</a> 8.4 关键配置说明</h3> <ol><li><p>进程处理接口</p> <div class="language- extra-class"><pre class="language-text"><code>asset_ITaskCSV_batchVCRecharge
</code></pre></div></li></ol> <h2 id="黄典前台文档"><a href="#黄典前台文档" class="header-anchor">#</a> 黄典前台文档</h2> <h2 id="第一章-批量业务导入"><a href="#第一章-批量业务导入" class="header-anchor">#</a> 第一章 批量业务导入</h2> <h3 id="基本描述-basic-description"><a href="#基本描述-basic-description" class="header-anchor">#</a> 基本描述-basic description</h3> <p>各类批量业务导入处理</p> <h3 id="业务流程-business-process"><a href="#业务流程-business-process" class="header-anchor">#</a> 业务流程-business process</h3> <p>1.点击批量业务模板下载；</p> <p>2.在模板内填写内容并上传；</p> <p>3.上传后，会校验填写得内容的格式正确性；</p> <p>4.点击批量处理，提交批量业务请求到后台；</p> <p>5.后台批量业务预处理进程对数据进行三户资料的补充；</p> <p>6.工单进行处理。</p> <h3 id="业务规则-business-rules"><a href="#业务规则-business-rules" class="header-anchor">#</a> 业务规则-business rules</h3> <ul><li><p>模板格式为excel，除批量缴费外一次性只能导入不超过3000条的数据</p></li> <li><p>批量缴费可以进行10w以上的数据文件导入</p></li></ul> <h3 id="业务表说明"><a href="#业务表说明" class="header-anchor">#</a> 业务表说明</h3> <p>主表am_batch_import</p> <p>子表am_batch_payment 在线工单表与失败工单记录</p> <p>am_batch_payment_h 成功处理后记录表</p> <p>am_batch_payment_error 失败信息记录表</p> <h3 id="关键配置说明"><a href="#关键配置说明" class="header-anchor">#</a> 关键配置说明</h3> <p>+-----------------------------------------------------------------------------------------+
| select t.<em>,t.rowid from param.BS_IMPORT_CONFIG t;                                    |
|                                                                                         |
| 子界面字段展示配置表                                                                    |
|                                                                                         |
| select t.</em>,t.rowid from param.BS_STATIC t where t.type_id = 'BATCH_IMPORT_TASK'; |
|                                                                                         |
| 批量缴费导入文件处理的ftp地址配置                                                       |
+-----------------------------------------------------------------------------------------+</p> <ol start="2"><li>批量业务查询</li></ol> <h3 id="_1-1基本描述-basic-description"><a href="#_1-1基本描述-basic-description" class="header-anchor">#</a> 1.1基本描述-basic description</h3> <p>查询各类型批量业务的处理情况</p> <h3 id="_1-2业务流程-business-process"><a href="#_1-2业务流程-business-process" class="header-anchor">#</a> 1.2业务流程-business process</h3> <p>1.页面选择查询的批量业务类型，选择要查询的日期范围；</p> <p>2.查询，账务管理系统查询批量业务的导入信息；</p> <p>3.点击查询出的流水号，查询出该业务导入的数据明细信息与处理结果；</p> <p>4.代理商信誉度，可进行导出成功失败的信息</p> <p>5.批量缴费可进行批量收据打印。</p> <h3 id="_1-4业务表说明"><a href="#_1-4业务表说明" class="header-anchor">#</a> 1.4业务表说明</h3> <p>主表am_batch_import</p> <p>子表am_batch_payment 在线工单表与失败工单记录</p> <p>am_batch_payment_h 成功处理后记录表</p> <p>am_batch_payment_error 失败信息记录表</p> <h3 id="_1-5关键配置说明"><a href="#_1-5关键配置说明" class="header-anchor">#</a> 1.5关键配置说明</h3> <p>+-----------------------------------------------------------------------------------------+
| select t.<em>,t.rowid from param.BS_IMPORT_CONFIG t;                                    |
|                                                                                         |
| 子界面字段展示配置表                                                                    |
|                                                                                         |
| select t.</em>,t.rowid from param.BS_STATIC t where t.type_id = 'BATCH_IMPORT_TASK'; |
|                                                                                         |
| 批量缴费导入文件处理的ftp地址配置                                                       |
+-----------------------------------------------------------------------------------------+</p> <h2 id="第三章-支票管理"><a href="#第三章-支票管理" class="header-anchor">#</a> 第三章 支票管理</h2> <h3 id="_1-1基本描述-basic-description-2"><a href="#_1-1基本描述-basic-description-2" class="header-anchor">#</a> 1.1基本描述-basic description</h3> <p>支票操作记录得查询与对支票得确认，退票，退款，撤单得操作</p> <h3 id="_1-2业务流程-business-process-2"><a href="#_1-2业务流程-business-process-2" class="header-anchor">#</a> 1.2业务流程-business process</h3> <p>1.选择查询条件点击查询</p> <p>2.查询支票信息</p> <p>3.选中查询出的支票信息并双击，可查询出该支票得操作记录</p> <p>4.通过输入条件可进行对该支票得操作，如确认，退票，退款，撤单等。</p> <h3 id="_1-3业务规则-business-rules"><a href="#_1-3业务规则-business-rules" class="header-anchor">#</a> 1.3业务规则-business rules</h3> <h3 id="_1-4业务表说明-2"><a href="#_1-4业务表说明-2" class="header-anchor">#</a> 1.4业务表说明</h3> <p>select t.*,rowid from ucr_ac1.AM_Cheque_Stub t ;支票主表</p> <p>select t.*,rowid from ucr_ac1.AM_Cheque_Memo t ;支票操作记录表</p> <h3 id="_1-5关键配置说明-2"><a href="#_1-5关键配置说明-2" class="header-anchor">#</a> 1.5关键配置说明</h3> <p>select t.*,t.rowid from param.bs_static t where t.type_id = 'BS_CHEQUE_STS_CAUSE';</p> <p>select t.* from param.bs_static t where t.type_id = 'BS_CHEQUE_MANAGEMENT_PAYUNIT';</p> <p>select t.* from param.bs_static t where t.type_id = 'BS_CHEQUE_MANAGEMENT_STATUS';</p> <p>select t.* from param.bs_static t where t.type_id = 'BS_CHEQUE_REFUND_TYPE';</p> <p>select t.* from param.bs_static t where t.type_id = 'BS_CHEQUE_OPERATION_STATUS';</p> <p>支票界面各枚举值</p> <h2 id="第四章-缴费历史查询"><a href="#第四章-缴费历史查询" class="header-anchor">#</a> 第四章 缴费历史查询</h2> <h3 id="_1-1基本描述-basic-description-3"><a href="#_1-1基本描述-basic-description-3" class="header-anchor">#</a> 1.1基本描述-basic description</h3> <p>查询缴费交易历史记录</p> <h3 id="_1-2业务流程-business-process-3"><a href="#_1-2业务流程-business-process-3" class="header-anchor">#</a> 1.2业务流程-business process</h3> <p>1.选择查询条件和时间范围点击查询</p> <p>2.查询出缴费历史信息</p> <p>3.点击当前存取款，可查询出当前存取款信息、</p> <p>4.选中一条查询出的缴费历史信息</p> <p>5.点击对应销账日志，即可查出选中信息的销账日志信息</p> <p>6.点击对应存取款日志，即可查出选中信息的存取款日志信息</p> <p>7.点击对应扩展信息，即可查出选中信息的扩展信息</p> <p>8.点击打印可补打收据</p> <p>9.点击导出可导出查询出得缴费历史信息格式为excel</p> <h3 id="_1-3业务规则-business-rules-2"><a href="#_1-3业务规则-business-rules-2" class="header-anchor">#</a> 1.3业务规则-business rules</h3> <h3 id="_1-4业务表说明-3"><a href="#_1-4业务表说明-3" class="header-anchor">#</a> 1.4业务表说明</h3> <p>AM_BUSI 缴费日志表</p> <p>AM_BUSI_DEDUCT 扣费日志表</p> <p>AM_WRITEOFF 销账日志表</p> <p>am_busi_ext 扩展信息表 存放支票信用卡vc卡等</p> <h3 id="_1-5关键配置说明-3"><a href="#_1-5关键配置说明-3" class="header-anchor">#</a> 1.5关键配置说明</h3> <p>SELECT T.*,ROWID FROM param.bs_static t where t.type_id = 'BS_ID_TYPE_CHARGE'</p> <p>SELECT T.*,ROWID FROM param.bs_static t where t.type_id = 'BS_WRITEOFF_MODE'</p> <p>SELECT T.*,ROWID FROM param.bs_static t where t.type_id = 'BS_CANCEL_FLAG'</p> <p>SELECT T.*,ROWID FROM param.bs_static t where t.type_id = 'CHARGEQRY_SEGMENT'</p> <p>缴费历史查询界面枚举</p> <h2 id="第五章-账单调整-bill-adjustment"><a href="#第五章-账单调整-bill-adjustment" class="header-anchor">#</a> 第五章 账单调整-Bill Adjustment</h2> <h3 id="_1-1基本描述"><a href="#_1-1基本描述" class="header-anchor">#</a> 1.1基本描述</h3> <blockquote><p>调账是指由于某种原因引起的客户账务数据的偏差，销账处理后多收、少收或者漏收客户的费用，需通过以退费或补收的形式对客户账单数据进行调整。</p></blockquote> <h3 id="_1-2业务流程"><a href="#_1-2业务流程" class="header-anchor">#</a> 1.2业务流程</h3> <ol><li><p>支持提供对需要调帐的账户账单查询功能；</p></li> <li><p>支持提供当前帐期和往月帐期的调帐功能；</p></li> <li><p>支持提供帐务调帐的详细日志记录，包括操作信息、调帐帐目、调帐金额、调帐原因等相关信息；</p></li> <li><p>支持记录调帐前后的帐务数据；</p></li> <li><p>支持对手机号码、用户标识、账户标识进行调账处理；</p></li> <li><p>支持批量调帐；</p> <p>7、支持对一个不存在的科目调整</p> <p>8、调账原因可以灵活配置，可以手动选择原因，无需手动输入</p></li></ol> <h3 id="_1-3业务规则-business-rules-3"><a href="#_1-3业务规则-business-rules-3" class="header-anchor">#</a> 1.3业务规则-business rules</h3> <p>抵扣期间不允许帐后调账；</p> <p>批量导入文件需要按照模板要求填写，文件格式是Excel，文件大小不能超过30MB，导入的数据不能超过10000行；</p> <h3 id="_1-4业务表说明-4"><a href="#_1-4业务表说明-4" class="header-anchor">#</a> 1.4业务表说明</h3> <p>AM_BILL_ITEM; 欠费账单表</p> <p>AM_BILL_AR 账单总表</p> <p>AM_ADJUST;调账日志主表</p> <p>AM_ADJUST_BILL调账日志子表</p> <h3 id="_1-5关键配置说明-4"><a href="#_1-5关键配置说明-4" class="header-anchor">#</a> 1.5关键配置说明</h3> <p>SELECT T.*,ROWID FROM param.bs_static t where t.type_id = 'BS_ADJUST_SOURCE'</p> <p>SELECT T.*,ROWID FROM param.bs_static t where t.type_id = 'BS_ADJUST_KIND'</p> <p>SELECT T.*,ROWID FROM param.bs_static t where t.type_id = 'BS_ADJUST_DATA_TYPE'界面枚举</p> <h2 id="第六章调账日志查询-bill-adjustment-log-inquiry"><a href="#第六章调账日志查询-bill-adjustment-log-inquiry" class="header-anchor">#</a> 第六章调账日志查询-Bill Adjustment log Inquiry</h2> <h3 id="_1-1基本描述-basic-description-4"><a href="#_1-1基本描述-basic-description-4" class="header-anchor">#</a> 1.1基本描述-Basic description</h3> <p>根据调账类型、作用类型、调账日期、手机号、手机号状态、操作员id、账户id查询调账日志记录。</p> <h3 id="_1-2业务流程-business-process-4"><a href="#_1-2业务流程-business-process-4" class="header-anchor">#</a> 1.2业务流程-Business process</h3> <ol><li><p>操作员选择调账类型、作用类型、调账日期、手机号、号码状态、操作员id、账户id，点击查询按钮；</p></li> <li><p>系统校验参数；</p></li> <li><p>系统查询调账日志信息并显示；</p></li> <li><p>双击一条调账日志信息，系统显示日志明细信息；</p></li></ol> <h3 id="_1-3业务规则-business-rules-4"><a href="#_1-3业务规则-business-rules-4" class="header-anchor">#</a> 1.3业务规则-business rules</h3> <h3 id="_1-4业务表说明-5"><a href="#_1-4业务表说明-5" class="header-anchor">#</a> 1.4业务表说明</h3> <p>AM_ADJUST;调账日志主表</p> <p>AM_ADJUST_BILL调账日志子表</p> <h3 id="_1-5关键配置说明-5"><a href="#_1-5关键配置说明-5" class="header-anchor">#</a> 1.5关键配置说明</h3> <h2 id="第七章-电子账单查询-duplicate-bill"><a href="#第七章-电子账单查询-duplicate-bill" class="header-anchor">#</a> 第七章 电子账单查询-Duplicate Bill</h2> <h3 id="_1-1基本描述-basic-description-5"><a href="#_1-1基本描述-basic-description-5" class="header-anchor">#</a> 1.1基本描述-Basic description</h3> <p>根据账期、账期类型、手机号查看电子账单。</p> <h3 id="_1-2业务流程-business-process-5"><a href="#_1-2业务流程-business-process-5" class="header-anchor">#</a> 1.2业务流程-Business process</h3> <ol><li><p>单文件查询</p> <p>a.  用户选择账期、账期类型、输入手机号码，点击查询按钮；</p> <p>b.  系统校验参数；</p> <p>c.  系统到文件主机上查找对应的文件，并展示给用户；</p></li> <li><p>批量查询</p> <p>d.  用户点击导入按钮</p> <p>e.  系统显示导入界面</p> <p>f.  用户下载文件模板DuplicateBill.xlsx，按格式要求填写手机号</p> <p>g.  点击导入修改后的文件</p> <p>h.  系统会显示导入成功和失败的记录</p> <p>i.  用户选择账期，点击提交按钮</p> <p>j.  系统把多个文件打包成压缩文件后下载到本机。</p></li></ol> <h3 id="_1-3业务规则-special-rules"><a href="#_1-3业务规则-special-rules" class="header-anchor">#</a> 1.3业务规则-Special rules</h3> <ul><li><strong>查询参数规则</strong></li></ul> <ol><li><p>手机号不能为空</p></li> <li><p>如果查找的文件不存在，系统提示错误</p></li></ol> <h3 id="_1-4业务表说明-6"><a href="#_1-4业务表说明-6" class="header-anchor">#</a> 1.4业务表说明</h3> <h3 id="_1-5关键配置说明-6"><a href="#_1-5关键配置说明-6" class="header-anchor">#</a> 1.5关键配置说明</h3> <p>ftp取文件地址</p> <p>select t.*,t.rowid from param.BS_SYS_PROFILES t where t.PROFILE_TYPE = 'DUPLICATE_BILL'</p> <p>Pincode验证码（暂时未启用）</p> <p>select d.<em>,rownum from (select t.</em> from cen.AM_TI_O_SMS_0 t where t.msg like 'Retrieve pincode%' order by t.get_date desc) d where rownum&lt;2 ;</p> <h2 id="第八章-集团账单查询-corporate-bill"><a href="#第八章-集团账单查询-corporate-bill" class="header-anchor">#</a> 第八章 集团账单查询-Corporate Bill</h2> <h3 id="_1-1基本描述-basic-description-6"><a href="#_1-1基本描述-basic-description-6" class="header-anchor">#</a> 1.1基本描述-Basic description</h3> <p>根据账期、NTN号,部门id 客服名称查看电子账单。</p> <h3 id="_1-2业务流程-business-process-6"><a href="#_1-2业务流程-business-process-6" class="header-anchor">#</a> 1.2业务流程-Business process</h3> <p>文件查询</p> <p>k.  用户选择账期、账期类型、输入查询条件，点击查询按钮；</p> <p>l.  系统校验参数；</p> <p>m.  系统到文件主机上查找对应的文件，并展示给用户；</p> <h3 id="_1-3业务规则-special-rules-2"><a href="#_1-3业务规则-special-rules-2" class="header-anchor">#</a> 1.3业务规则-Special rules</h3> <ul><li><strong>查询参数规则</strong></li></ul> <ol start="3"><li><p>查询条件不能为空</p></li> <li><p>如果查找的文件不存在，系统提示错误</p></li></ol> <h3 id="_1-4业务表说明-7"><a href="#_1-4业务表说明-7" class="header-anchor">#</a> 1.4业务表说明</h3> <h3 id="_1-5关键配置说明-7"><a href="#_1-5关键配置说明-7" class="header-anchor">#</a> 1.5关键配置说明</h3> <p>ftp取文件地址</p> <p>select t.*,t.rowid from param.BS_SYS_PROFILES t where t.PROFILE_TYPE = CORPORATE_BILL'</p> <h2 id="第九章-黑名单-灰名单管理-black-other-list-management"><a href="#第九章-黑名单-灰名单管理-black-other-list-management" class="header-anchor">#</a> 第九章 黑名单,灰名单管理- Black &amp; Other List Management</h2> <h3 id="_1-1基本描述-basic-description-7"><a href="#_1-1基本描述-basic-description-7" class="header-anchor">#</a> 1.1基本描述-Basic description</h3> <p>根据CNIC，护照，驾照，客户姓名、身份证号等信息查询是否是黑灰名单。</p> <h3 id="_1-2业务流程-business-process-7"><a href="#_1-2业务流程-business-process-7" class="header-anchor">#</a> 1.2业务流程-Business process</h3> <ol><li><p>查询客户信息</p> <p>a.  用户选择查询类型、输入对应的值，点击查询按钮；</p> <p>b.  系统校验数据；</p> <p>c.  系统查询名单信息，并展示在页面上；</p></li> <li><p>查询关联信息</p> <p>d.  查询客户信息号，用户点击一条客户信息；</p> <p>e.  系统查询客户信息对应的欠费信息；</p></li> <li><p>增加</p> <p>f.  用户输入客户相关信息，点击增加按钮</p> <p>g.  系统校验数据，增加客户信息；</p> <p>h.  返回操作结果。</p></li> <li><p>修改</p> <p>i.  用户修改客户相关信息，点击修改按钮</p> <p>j.  系统校验数据，修改客户信息；</p> <p>k.  返回操作结果。</p></li> <li><p>删除</p> <p>l.  用户选择一条客户信息，点击删除按钮</p> <p>m.  系统校验数据，删除选中的记录；</p> <p>n.  返回操作结果。</p></li></ol> <h3 id="_1-3业务规则-special-rules-3"><a href="#_1-3业务规则-special-rules-3" class="header-anchor">#</a> 1.3业务规则-Special rules</h3> <ul><li><strong>查询参数规则</strong></li></ul> <ol><li><p>查询的值不能为空</p></li> <li><p>新增、修改时，某些字段值不能为空</p></li></ol> <h3 id="_1-4业务表说明-8"><a href="#_1-4业务表说明-8" class="header-anchor">#</a> 1.4业务表说明</h3> <blockquote><p>--相关表</p> <p>select * from CEN.OWE_SPECIAL_LIST;</p> <p>select * from CEN.OWE_SPEC_USER;</p> <p>select * from CEN.OWE_SPECIAL_LIST_HIS;</p></blockquote> <h3 id="_1-5关键配置说明-8"><a href="#_1-5关键配置说明-8" class="header-anchor">#</a> 1.5关键配置说明</h3> <h2 id="第十章-信控工单查询-debt-order-inquiry"><a href="#第十章-信控工单查询-debt-order-inquiry" class="header-anchor">#</a> 第十章 信控工单查询- Debt Order Inquiry</h2> <h3 id="_1-1基本描述-basic-description-8"><a href="#_1-1基本描述-basic-description-8" class="header-anchor">#</a> 1.1基本描述-Basic description</h3> <p>根据手机号，账户id，区域，开始时间和结束时间，查询停机工单和复机工单信息。</p> <h3 id="_1-2业务流程-business-process-8"><a href="#_1-2业务流程-business-process-8" class="header-anchor">#</a> 1.2业务流程-Business process</h3> <ol><li><p>查询停机工单</p> <p>a.  用户点击停机工单，输入手机号，账户id，区域，开始时间和结束时间，点击查询按钮；</p> <p>b.  系统校验数据；</p> <p>c.  系统显示符合条件的停机工单；</p></li> <li><p>查询复机工单</p> <p>d.  用户点击停机工单，输入手机号，账户id，区域，开始时间和结束时间，点击查询按钮；</p> <p>e.  系统校验数据；</p> <p>f.  系统显示符合条件的复机工单</p></li></ol> <h3 id="_1-3业务规则-special-rules-4"><a href="#_1-3业务规则-special-rules-4" class="header-anchor">#</a> 1.3业务规则-Special rules</h3> <ul><li><strong>查询参数规则</strong></li></ul> <ol><li><p>区域不能，开始时间，结束时间不为空</p></li> <li><p>时间间隔不能超过6个月</p></li></ol> <h3 id="_1-4业务表说明-9"><a href="#_1-4业务表说明-9" class="header-anchor">#</a> 1.4业务表说明</h3> <blockquote><p>--条件不同，查询表名不同</p> <p>select * from ad.CA_NOTIFY_TASK_0921_0_201906;</p> <p>select * from ad.CA_NOTIFY_TASK_0921_1_201905;</p> <p>select * from ad.CA_NOTIFY_TASK_0922_0_201905;</p> <p>select * from ad.CA_NOTIFY_TASK_0922_0_201906;</p></blockquote> <h3 id="_1-5关键配置说明-9"><a href="#_1-5关键配置说明-9" class="header-anchor">#</a> 1.5关键配置说明</h3> <h2 id="第十一章-信控规则查询"><a href="#第十一章-信控规则查询" class="header-anchor">#</a> 第十一章 信控规则查询</h2> <h3 id="_1-1基本描述-basic-description-9"><a href="#_1-1基本描述-basic-description-9" class="header-anchor">#</a> 1.1基本描述-Basic description</h3> <blockquote><p>根据手机号查询关联的信控规则</p></blockquote> <h3 id="_1-2业务流程-business-process-9"><a href="#_1-2业务流程-business-process-9" class="header-anchor">#</a> 1.2业务流程-Business process</h3> <ol><li><p>操作员输入手机号，点击查询按钮</p></li> <li><p>系统根据手机号查询用户信用分类 credit class</p></li> <li><p>系统根据信用分类查询信控规则</p></li> <li><p>用户查看规则信息，点击导出按钮</p></li> <li><p>系统导出信控规则信息</p></li></ol> <h3 id="_1-3业务规则-special-rules-5"><a href="#_1-3业务规则-special-rules-5" class="header-anchor">#</a> 1.3业务规则-Special rules</h3> <p>手机号和信用分类不能都为空</p> <h3 id="_1-4业务表说明-10"><a href="#_1-4业务表说明-10" class="header-anchor">#</a> 1.4业务表说明</h3> <h3 id="_1-5关键配置说明-10"><a href="#_1-5关键配置说明-10" class="header-anchor">#</a> 1.5关键配置说明</h3> <h2 id="第十二章-批量争议账单管理"><a href="#第十二章-批量争议账单管理" class="header-anchor">#</a> 第十二章 批量争议账单管理</h2> <h3 id="_1-1基本描述-basic-description-10"><a href="#_1-1基本描述-basic-description-10" class="header-anchor">#</a> 1.1基本描述-basic description</h3> <p>争议账单，是指根据业务与财务主管部门确定的争议账单生成条件将用户的欠费帐务数据转为争议账单。大批量进行转换。</p> <h3 id="_1-2业务流程-business-process-10"><a href="#_1-2业务流程-business-process-10" class="header-anchor">#</a> 1.2业务流程-business process</h3> <p>1.点击批量争议账单模板下载；</p> <p>2.在模板内填写内容并上传；</p> <p>3.上传后，会校验填写得内容的格式正确性；</p> <p>4.点击批量处理，提交批量业务请求到后台；</p> <p>5.后台批量业务预处理进程对数据进行三户资料的补充；</p> <p>6.工单进行处理。</p> <h3 id="_1-3业务规则-business-rules-5"><a href="#_1-3业务规则-business-rules-5" class="header-anchor">#</a> 1.3业务规则-business rules</h3> <h3 id="_1-4业务表说明-11"><a href="#_1-4业务表说明-11" class="header-anchor">#</a> 1.4业务表说明</h3> <p>Am_Bill_item</p> <h3 id="_1-5关键配置说明-11"><a href="#_1-5关键配置说明-11" class="header-anchor">#</a> 1.5关键配置说明</h3> <h2 id="第十三章批量核销坏账"><a href="#第十三章批量核销坏账" class="header-anchor">#</a> 第十三章批量核销坏账</h2> <h3 id="_1-1基本描述-basic-description-11"><a href="#_1-1基本描述-basic-description-11" class="header-anchor">#</a> 1.1基本描述-basic description</h3> <p>核销坏账，是指根据业务与财务主管部门确定的坏账进行核销，将欠费置为0。</p> <h3 id="_1-2业务流程-business-process-11"><a href="#_1-2业务流程-business-process-11" class="header-anchor">#</a> 1.2业务流程-business process</h3> <p>1.点击批量争议账单模板下载；</p> <p>2.在模板内填写内容并上传；</p> <p>3.上传后，会校验填写得内容的格式正确性；</p> <p>4.点击批量处理，提交批量业务请求到后台；</p> <p>5.后台批量业务预处理进程对数据进行三户资料的补充；</p> <p>6.工单进行处理。</p> <h3 id="_1-3业务规则-business-rules-6"><a href="#_1-3业务规则-business-rules-6" class="header-anchor">#</a> 1.3业务规则-business rules</h3> <h3 id="_1-4业务表说明-12"><a href="#_1-4业务表说明-12" class="header-anchor">#</a> 1.4业务表说明</h3> <p>Am_Bill_item</p> <h3 id="_1-5关键配置说明-12"><a href="#_1-5关键配置说明-12" class="header-anchor">#</a> 1.5关键配置说明</h3> <h2 id="第十四章呆坏账管理"><a href="#第十四章呆坏账管理" class="header-anchor">#</a> 第十四章呆坏账管理</h2> <h3 id="_1-1基本描述-basic-description-12"><a href="#_1-1基本描述-basic-description-12" class="header-anchor">#</a> 1.1基本描述-basic description</h3> <p>呆帐处理，是指根据业务与财务主管部门确定的呆帐生成条件将用户的欠费帐务数据转为呆帐。呆帐经过特定的缴费周期仍无法收回的欠费，经业务、财务主管部门批准后，转为坏帐。</p> <h3 id="_1-2业务流程-business-process-12"><a href="#_1-2业务流程-business-process-12" class="header-anchor">#</a> 1.2业务流程-business process</h3> <p>1.选择查询条件和时间范围点击查询</p> <p>2.查询出正常账单信息</p> <p>3.选中单条或多条正常账单信息，点击转呆账</p> <p>4.将选中的正常账单信息转成呆账</p> <p>5.点击呆账账单按钮，查询出呆账账单信息</p> <p>6.选中单条或多条呆账账单信息，点击转正常或呆账</p> <p>7.将选中的呆账账单信息转成正常或坏账</p> <p>8.点击坏账账单按钮，查询出坏账账单信息</p> <p>9.选中单条或多条坏账账单信息，点击转呆账</p> <p>10.各账单信息可以点击批量处理，根据业务进行转换</p> <h3 id="_1-2业务规则-business-rules"><a href="#_1-2业务规则-business-rules" class="header-anchor">#</a> 1.2业务规则-business rules</h3> <h3 id="_1-4业务表说明-13"><a href="#_1-4业务表说明-13" class="header-anchor">#</a> 1.4业务表说明</h3> <p>Am_Bill_item</p> <h3 id="_1-5关键配置说明-13"><a href="#_1-5关键配置说明-13" class="header-anchor">#</a> 1.5关键配置说明</h3> <h2 id="周琪宏前台文档"><a href="#周琪宏前台文档" class="header-anchor">#</a> 周琪宏前台文档</h2> <h2 id="资金中心"><a href="#资金中心" class="header-anchor">#</a> 资金中心</h2> <h3 id="预付费话费收取-prepaid-payment"><a href="#预付费话费收取-prepaid-payment" class="header-anchor">#</a> 预付费话费收取-Prepaid Payment</h3> <h4 id="基本描述-basic-description-2"><a href="#基本描述-basic-description-2" class="header-anchor">#</a> 基本描述-basic description</h4> <p>预付费的现金充值是指通过查询预付费客户的帐务资料，收取客户的费用，并触发充值赠送、增加预付费账户有效期的过程。</p> <h4 id="业务流程-business-process-2"><a href="#业务流程-business-process-2" class="header-anchor">#</a> 业务流程-business process</h4> <ol><li><p>点击Prepaid Payment（预付费现金充值）菜单；</p></li> <li><p>页面选择手机号码、用户号码、账户号码中的一个类型，输入号码的值；</p></li> <li><p>点击查询后，右侧展示用户信息、账本余额、账本明细；</p></li> <li><p>左侧Amount标签处，输入充值额度，单位为卢比；Advanced Options中可以设置缴费类型，老系统只支持现金，选择是否打印收据，填写充值备注；或者选择金额快速缴费；</p></li> <li><p>点击&quot;Pay&quot;按钮，经过二次确认后，提交充值请求到后台。</p></li> <li><p>后台接收查询请求，如下7-16步：</p></li> <li><p>验证用户资料；</p></li> <li><p>算税及操作费用，实际充值上发金额=充值金额-税费；</p></li> <li><p>查ocs余额信息，后面用于发短信和写缴费记录充前、充值后金额；</p></li> <li><p>写缴费业务记录表ucr_ac1.ag_busi，缴费汇总表（充值次数累加，充值金额累加）AM_OCSPAY_SUMMARY，充值通知表AM_RECHARGE_NOTIFY，充值通知会分发到还款通知表，新老还款都在异步进程中处理；</p></li> <li><p>计算的实际充值上发金额，写资金上发表CEN.CA_ASSET_SYN；</p></li> <li><p>调用crm接口修改账户周期状态和失效日期；</p></li> <li><p>充值赠送触发；</p></li> <li><p>调用crm扣除操作员额度扣减接口，内部有校验额度是否充足的逻辑order.ICSCVirtualCreditCSV.doCscCreditAcct；</p></li> <li><p>判断交易组织是否为代理商或合作营业厅channel.IChannelDept4OutQueryCSV.identifyByAgentId，增加代理商的credit欠费值channel.IAgentAccInfoOutOperateCSV.doAgentBusiFee；</p></li> <li><p>发充值结果短信，告知余额变化和账本失效时间变化；</p></li> <li><p>弹出充值成功提示；</p></li> <li><p>打印充值收据。</p></li></ol> <p><em>--借款记录表</em></p> <p>select t.* from ucr_ac1.am_autoload t where t.acct_id=39501002144315 order by t.autoload_date desc;</p> <p><em>--普通用户业务日志</em></p> <p>select t.* from ucr_ac1.am_busi t where t.acct_id=39501002144315 order by t.create_date desc;</p> <p><em>--资金上发表</em></p> <p>select t.*,rowid from ad.CA_ASSET_SYN_0921_3 t where acct_id = 39501002144315 order by t.create_date desc;</p> <p><em>--缴费汇总表（充值次数累加，充值金额累加）</em></p> <p>select t.* from ucr_ac1.am_ocspay_summary_0921 t where t.acct_id=39501002144315 order by t.last_op_time desc;</p> <p><em>--充值通知表</em></p> <p>select t.* from ucr_ac1.am_recharge_notify t where t.acct_id=39501002144315 order by t.ret_pay_date desc;</p> <p><em>--短信表</em></p> <blockquote><p>暂无</p></blockquote> <h4 id="业务规则-business-rules-2"><a href="#业务规则-business-rules-2" class="header-anchor">#</a> 业务规则-business rules</h4> <ol><li><p>充值成功后会增加用户账本额度，生效日期为1990/1/1，失效日期为2037/12/31 23:59:59</p></li> <li><p>充值时扣税,不含税部分进入账本</p></li> <li><p>针对预付费的充值,会发送短信</p></li> <li><p>只有充值收据,样式待提供</p></li> <li><p>充值后，会触发用户状态变更、延长用户有效期</p></li> <li><p>支持充值赠送</p></li> <li><p>支持还款</p></li> <li><p>支持扣减操作员虚拟信誉度</p></li> <li><p>短信模版规则</p></li></ol> <blockquote><p>短信内容：</p> <p>红色是模版参数，分别表示充值金额、扣减金额（含税、操作费）、充值后余额、充值后账户失效日期。</p></blockquote> <hr> <h2 id="you-have-loaded-100-00-amount-deducted-0-00-new-balance-is-rs-993-17-valid-up-to-11-12-2019-rs-75-t-week-1000-zong-50-offnet-mins-1000sms-350mb-dial-7"><a href="#you-have-loaded-100-00-amount-deducted-0-00-new-balance-is-rs-993-17-valid-up-to-11-12-2019-rs-75-t-week-1000-zong-50-offnet-mins-1000sms-350mb-dial-7" class="header-anchor">#</a> You have loaded 100.00. Amount Deducted 0.00.New balance is Rs.993.17.Valid up to 11-12-2019.Rs.75+T/Week: 1000 Zong &amp; 50 Offnet Mins,1000SMS,350MB. Dial *7#</h2> <ol start="10"><li>算税规则</li></ol> <blockquote><p>充值扣税公式：</p> <p>最终上发金额=</p> <p>/100</p> <p>实例化如下：</p> <p><em>0.0364</em>0.195</p> <p>PAYMENT_AMOUNT--充值金额</p> <p>参数说明：</p> <p>AITRATE--AIT 充值税率 14%,配置的一个参数里</p> <p>0.05 --Service Charege rate</p> <p>0.0364--Operational Fee rate</p> <p>0.195--SED rate 消费税率</p> <p>根据用户的主产品id查询到对应的税率配置记录，包含Service Charege rate、Operational Fee rate、SED rate</p></blockquote> <p>1,预付费有一组税产品(同时只有有其中一个),做扣AIT,可以表示扣或不扣，cp.PM_BUSI_PROD、cm_user_sprom这两个表后面割接到哪里。</p> <blockquote><p>2,可以配置某些缴费类型不扣税</p> <p>3,AITRATE可以从缴费接口传入,这时就不考虑配置的AIT 充值税率.比如VC卡充值会存在这种情况,按充值类型配置</p> <p>4,产品税(消费税)在帐处配置,按费用科目配置是否算,订购的同时计算月租和税并扣掉</p> <p>5,详单的税在计费配置</p> <p>6,免税的情况,</p> <p>a,税产品税率为0</p> <p>b,新激活的号码在特定时间段充值免税</p> <p>具体条件为</p> <p>判断充值类型在配置的参数里</p> <p>充值时间在配置的时间段内</p> <p>激活时间在配置的时间段内,且激活时的busi_code在配置参数里</p> <p>只配置时间段内进行的7893激活或指纹激活或在配置时间段 mnp port in 的号码</p></blockquote> <ol start="11"><li>用户状态变更规则</li></ol> <blockquote><p>N1到N4可以充值，如果N1、N3、N4，则变为N2，若为N2，无需变化。</p> <p>用户状态：</p> <p>N0新开户状态，</p> <p>N1激活状态，</p> <p>N2充值后状态，</p> <p>N3 是N1、N2过期后状态，即单停状态</p> <p>N4是N3过期后状态，即双停状态，单停后一般一年后转双停，</p> <p>N5是N0、N4过期后状态，即销户状态。</p> <p>英文描述：</p> <p>0 Activation Period</p> <p>1 Promotional Period</p> <p>2 Validity Period</p> <p>3 Grace Period</p> <p>4 Recharge Period</p> <p>5 Grace before Recycle</p></blockquote> <ol start="12"><li>账户周期有效期变更规则</li></ol> <blockquote><p>预付费账户周期变更规则配置在表ZG.ACC_DEF_CHARGE_CTRL中：</p> <p>控制品牌，如神州行（EASY OWN)充值面额与使用时间等，面额(charge_value),面额上限，充值天数(charge_expiry)的关系为，若充值面额(charge_value)在范围 [charge_value,upper_charge_value)</p> <p>则取 charge_value 对应的 chage_expiry。</p> <p>表字段如下：</p> <p>REGION_CODE IS'归属地区编号';</p> <p>BRAND IS'来源于 CP.CM_BRAND'，用户品牌;</p> <p>CHARGE_VALUE IS'充值面额,单位分';</p> <p>CHARGE_EXPIRY IS'对应充值面额设定的有效持续天数';</p> <p>UPPER_CHARGE_VALUE IS'充值面额上限,单位分，使用时充值面额应 小于该值';</p> <p>MAX_ADDUP_EXPIRY IS'进行充值后，累计延长的最大天数';</p> <p>PAY_TYPE 缴费方式，10种。</p> <p>规则：</p> <p>1、根据用户品牌、缴费方式、地区编码，查找对应多条记录，根据充值金额匹配充值范围，筛选出最终一条记录，计算延长有效期的天数；用户品牌、缴费方式、地区编码可能配置为0，表示通配。后续筛选时，精确匹配优先，其次用通配匹配的记录。</p> <p>2、转状态N1、N3、N4，则变为N2，计算规则如下</p> <p>最终用户失效日期为=充值日期+延长有效期天数</p> <p>3、若为N2，状态不变</p> <p>临时计算用户失效日期为=充值日期+延长有效期天数</p></blockquote> <p>取用户当前失效时间和临时计算用户失效日期，较大的一个。</p> <h4 id="页面说明-page-description"><a href="#页面说明-page-description" class="header-anchor">#</a> 页面说明-Page description</h4> <p><strong>1、界面截图，参照</strong></p> <p>菜单：Prepaid Payment</p> <p>acctmanmassetwebsrcmainresourcestapestryassetcscorepaymentPrePayment.html</p> <p>查询：asset_IPrePaymentCSV_queryBalancePre</p> <p>缴费：soa_asset_IPrePaymentCSV_doOcsCharge</p> <p><strong>2、业务输入输出要素-Business elements</strong></p> <ul><li><strong>输入要素-Input elements</strong></li></ul> <blockquote><p>手机号/账户编号、充值金额</p></blockquote> <ul><li><strong>输出要素-Output elements</strong></li></ul> <blockquote><p>用户列表,账本明细,账户余额信息,用户信息,充值提示信息</p></blockquote> <h3 id="空中充值-cust-etop-issuance"><a href="#空中充值-cust-etop-issuance" class="header-anchor">#</a> 空中充值- Cust Etop Issuance</h3> <h4 id="基本描述-basic-description-3"><a href="#基本描述-basic-description-3" class="header-anchor">#</a> 基本描述-basic description</h4> <p>代理商在空中充值系统中建立代理商账户，指定一个手机号码与该账户关联，并充值若干现金到代理商账户中，然后通过账户间的转帐方式给普通手机用户充值话费的功能。</p> <p>The agent open the agent account in the aerial top-up system, designates a mobile phone number associated with the account, and top-up a certain amount of cash into the agent account, and then top-up for ordinary mobile phone users through the transfer between accounts.</p> <h4 id="业务流程-business-process-3"><a href="#业务流程-business-process-3" class="header-anchor">#</a> 业务流程-business process</h4> <p><strong>流程说明：</strong></p> <ol><li><p>页面输入代理商号码/标识，普通用户手机号/用户标识/账户标识；</p></li> <li><p>点击查询后，帐务管理系统查询代理商账户信息、余额信息，查询普通用户资料，并在前台展现；</p></li> <li><p>操作员设置充值金额，再点击提交；</p></li> <li><p>系统校验代理商资料和普通用户资料；</p></li> <li><p>查询代理商etop账本和etop透支额度；</p></li> <li><p>若代理商余额不足，则本次空中充值失败，业务终止；</p></li> <li><p>若代理商余额充足，则扣减代理商账本,账本可扣为负值，但负值额度不得超过etop透支额度；</p></li> <li><p>记录代理商空充业务日志；</p></li> <li><p>发起普通号码的预付费充值或后付费缴费操作操作；</p></li> <li><p>如果是帐管前台的来源，则需要扣除操作员etop虚拟信用度order.ICSCVirtualCreditCSV.doCscCreditAcct。</p></li></ol> <p><em>--空充最小最大金额</em></p> <p>select * from ucr_param.BS_SYS_PROFILES t where PROFILE_CODE = 'PAY_SKY_MINVALUE';</p> <p>select * from ucr_param.BS_SYS_PROFILES t where PROFILE_CODE = 'PAY_SKY_MAXVALUE';</p> <p><em>--代理商业务日志</em></p> <p>select t.* from ucr_ac1.ag_busi t where t.agent_acct_id=89402000000588 order by t.create_date desc;</p> <p><em>--代理商账本</em></p> <p>select t.*,rowid from zg.acc_book_0921 t where t.acct_id=89402000000588;</p> <p><em>--普通用户业务日志</em></p> <p>select t.* from ucr_ac1.am_busi t where t.acct_id=39501002144315 order by t.create_date desc;</p> <p><em>--资金上发表</em></p> <p>select t.*,rowid from ad.CA_ASSET_SYN_0921_3 t where acct_id = 39501002144315 order by t.create_date desc;</p> <p><em>--普通用户账本（后付费）</em></p> <p>select t.* from ucr_ac1.am_balance_05 t where t.acct_id=39501002144315;</p> <h4 id="业务规则-business-rules-3"><a href="#业务规则-business-rules-3" class="header-anchor">#</a> 业务规则- Business rules</h4> <ol><li><p>支持根据代理商号码/代理商标识，查询代理商用户信息、余额信息；</p></li> <li><p>支持根据手机号码，查询未销户或已销户的普通用户信息；</p></li> <li><p>支持根据用户标识/账户标识，查询普通用户信息；</p></li> <li><p>支持充值金额校验规则，参数PAY_SKY_MINVALUE配置最小空充金额，PAY_SKY_MAXVALUE配置最大空充金额，不在这两个值之间的额度，报错；</p></li> <li><p>支持发送短信给代理商；</p></li> <li><p>支持发送短信给普通用户；</p></li> <li><p>支持给代理商给预付费号码或后付费号码缴费；</p></li> <li><p><strong>代理商账本扣减规则-</strong> <strong>Rules for the deduction of agents' ledger</strong></p></li></ol> <blockquote><p>1.先查询代理商空充账本etop余额，若充足，则可以扣减；</p> <p>2.若空充账本etop余额不足，再查询代理商etop可透支额度，若充足则可以扣减，否则空中充值失败；</p></blockquote> <h4 id="页面说明-page-description-2"><a href="#页面说明-page-description-2" class="header-anchor">#</a> 页面说明-Page description</h4> <ol><li><strong>界面截图-Page screenshots</strong></li></ol> <p>菜单：Account Mgnt Agent Management Cust Etop Issuance</p> <p>查询代理商信息：asset_IAgentCSV_queryAgInfo</p> <p>查询代理商资金：asset_IAgentCSV_queryAgBalanceInfo</p> <p>查询普通用户信息：com.asiainfo.ams.saas.common.BaseAcctPage#queryInfoInner</p> <p>空充接口：soa_asset_IAgentCSV_agentPayOther</p> <ol start="2"><li><strong>业务输入输出要素-Business elements</strong></li></ol> <ul><li><strong>输入要素-Input elements</strong></li></ul> <blockquote><p>代理商号码/代理商标识，普通用户手机号码/用户标识/账户标识，充值金额</p> <p>Agent number/agent id, mobile phone number of ordinary users/user id/account id, recharge amount</p></blockquote> <ul><li><strong>输出要素-Output elements</strong></li></ul> <blockquote><p>代理商信息（账户编号，账户名称，代理商号码，渠道编号，账户状态，地市编码，空充账本余额，初始信用额度，信用余额），普通用户信息（付费类型，付费名称，客户名称，归属市县，用户类型，客户星级），充值成功提示</p> <p>Agent information (account number, account name, the agent number, channel number, account status, region code, ledger balance, initial credit, credit balance), ordinary users information (payment type, payment name, customer name, region code, user type, customer star), top-up success tips</p></blockquote> <h3 id="空中充值返销-cust-etop-reversal"><a href="#空中充值返销-cust-etop-reversal" class="header-anchor">#</a> 空中充值返销- Cust Etop Reversal</h3> <h4 id="基本描述-basic-description-4"><a href="#基本描述-basic-description-4" class="header-anchor">#</a> 基本描述-basic description</h4> <p>空中充值返销，是用户在指定的充值商处，查询一段时间内空中充值记录，做撤单的功能。</p> <p>Cust Etop Reversal is the function of the user to query the E-Topup records within a certain period of time at the specified and withdrawal order.</p> <h4 id="业务流程-business-process-4"><a href="#业务流程-business-process-4" class="header-anchor">#</a> 业务流程-business process</h4> <p><strong>流程说明：</strong></p> <ol><li><p>页面输入手机号码/代理商号码/代理商标识，选择查询开始时间、结束时间；</p></li> <li><p>点击查询后，帐务管理系统查询空中充值业务记录列表；</p></li> <li><p>操作员选中某一条空中充值记录，再点击撤单；</p></li> <li><p>渠道来源且备注为3或4，则获取提醒短信，发送给代理商和个人用户，插入渠道记录表QD.ETOP_CANCLE_ORDER_OVER_FEE；</p></li> <li><p>校验空充返销时间是否在5天之内，参数配置的5天，5天之外的报错提示不允许撤单；</p></li> <li><p>判断个人侧Etop科目金额小于等于0，则报错提示余额不足；</p></li> <li><p>个人侧Etop科目金额大于0，返销个人用户充值，记录返销日志，返回返销金额；</p></li> <li><p>代理商侧按返销金额做代理商etop额度返销，记录日志；</p></li> <li><p>帐管前台来源回退操作员etop虚拟信用度；</p></li> <li><p>发短信给代理商和个人用户；</p></li></ol> <p><em>--代理商空中原充值日志，修改为C撤单状态</em></p> <p>select t.* from ucr_ac1.ag_busi t where t.agent_acct_id=89402000000588 and t.business_id=1119032200006361;</p> <p><em>--代理商空中充值撤单日志</em></p> <p>select t.* from ucr_ac1.ag_busi t where t.agent_acct_id=89402000000588 and t.business_id=1119032200006362;</p> <p><em>--空充撤单代理商账本增加</em></p> <p>select t.* from zg.acc_book_0921 t where t.agent_acct_id=89402000000588 and t.business_id=1119032200006362;</p> <p><em>--普通用户原空中充值日志，修改为C撤单状态</em></p> <p>select t.* from ucr_ac1.am_busi t where t.acct_id=89101001210372 and t.business_id=1119032200006360;</p> <p><em>--普通用户空中充值撤单日志</em></p> <p>select t.* from ucr_ac1.am_busi t where t.acct_id=89101001210372 and t.business_id=1119032200006363;</p> <p><em>--资金上发表</em></p> <p>select t.*,rowid from ad.CA_ASSET_SYN_0921_3 t where acct_id = 39501002144315 order by t.create_date desc;</p> <p><em>--普通用户账本（后付费）</em></p> <p>select t.* from ucr_ac1.am_balance_03 t where t.acct_id=89101001210372 and t.business_id=1119032200006360;</p> <h4 id="业务规则-business-rules-4"><a href="#业务规则-business-rules-4" class="header-anchor">#</a> 业务规则- Business rules</h4> <ol><li><p>支持根据代理商号码或普通用户号码，查询空中充值业务记录；</p></li> <li><p>支持查询指定时间段的空中充值业务记录；</p></li> <li><p>若充值记录是异地，或者当前时间已经跨月，则不允许撤单</p></li> <li><p>支持代理商账本余额的回退；</p></li> <li><p>支持原代理商空中充值业务记录修改为撤单状态；</p></li> <li><p>支持普通用户账户余额的回退，若余额不足则撤单失败；</p></li> <li><p>支持发送短信给代理商；</p></li> <li><p>支持发送短信给普通用户；</p></li> <li><p>查询日期规则-Date rule</p></li></ol> <blockquote><p>1.开始月份不能大于结束月份</p></blockquote> <p>2.开始时间与结束时间间隔不能大于31天.</p> <h4 id="页面说明-page-description-3"><a href="#页面说明-page-description-3" class="header-anchor">#</a> 页面说明-Page description</h4> <ol start="3"><li><strong>界面截图-Page screenshots</strong></li></ol> <blockquote><p>菜单：Account Mgnt Agent Management Cust Etop Reversal</p></blockquote> <ol start="4"><li><strong>业务输入输出要素-Business elements</strong></li></ol> <ul><li><strong>输入要素-Input elements</strong></li></ul> <blockquote><p>代理商号码/代理商标识/用户手机号码</p> <p>Agent number/agent id/user mobile number</p></blockquote> <ul><li><strong>输出要素-Output elements</strong></li></ul> <blockquote><p>空中充值记录信息（代理商账户标识，代理商标识，代理商号码，客户号码，业务流水，金额，充值时间，充值人员）、空中充值返销成功提示</p> <p>E-Topup record information (agent account id, agent id, agent number, customer number, business id, amount, business time, operator), successful tips of Etop reversal</p></blockquote> <h3 id="代理商交易查询-agent-transaction-history-query"><a href="#代理商交易查询-agent-transaction-history-query" class="header-anchor">#</a> 代理商交易查询- Agent transaction history query</h3> <h4 id="基本描述-basic-description-5"><a href="#基本描述-basic-description-5" class="header-anchor">#</a> 基本描述-basic description</h4> <p>查询代理商交易历史记录，主要包含变更代理商账本、代理商信誉度业务的记录。</p> <h4 id="业务流程-business-process-5"><a href="#业务流程-business-process-5" class="header-anchor">#</a> 业务流程-business process</h4> <p><img src="media/image7.emf" alt=""></p> <p><strong>流程说明：</strong></p> <ol><li><p>页面输入代理商号码，选择要查询的日期范围；</p></li> <li><p>点击查询后，帐务管理系统查询代理商资料、代理商交易历史信息；</p></li> <li><p>页面分页展示代理商交易信息；</p></li></ol> <p><img src="media/image8.emf" alt=""></p> <p><strong>Process description：</strong></p> <ol><li><p>Enter the agent number on the page and select the date range to be inquired;</p></li> <li><p>After clicking the query, the account management system will query the agent information and the agent transaction history information;</p></li> <li><p>Display agent transaction information on page pagination;</p></li></ol> <p><em>--代理商业务日志</em></p> <p>select * from ucr_ac1.ag_busi M where 1 = 1 AND M.AGENT_ACCT_ID = 100234 AND M.CANCEL_FLAG != 'R' order by M.CREATE_DATE DESC;</p> <h4 id="业务规则-business-rules-5"><a href="#业务规则-business-rules-5" class="header-anchor">#</a> 业务规则-Business rules</h4> <ol><li><p>支持根据代理商号码，查询代理商交易历史记录；</p></li> <li><p>支持查询指定时间范围内的代理商交易历史记录；</p></li> <li><p>支持分页展示代理商交易历史；</p></li> <li><p>支持返销类业务记录的特殊颜色显示；</p></li> <li><p>支持代理商交易前、交易后的余额展示；</p></li> <li><p>查询日期规则-Date rule，开始月份不能大于结束月份，开始时间与结束时间间隔不能大于31天</p></li></ol> <h4 id="页面说明-page-description-4"><a href="#页面说明-page-description-4" class="header-anchor">#</a> 页面说明-Page description</h4> <ol><li><strong>界面截图-Page screenshots</strong></li></ol> <blockquote><p>菜单：Account Mgnt Agent Management agent transaction history inquiry</p> <p>Reference 《CMPAK项目-账管-操作手册.docx》第14章 代理商交易历史查询-- agent transaction history inquiry</p></blockquote> <ol start="2"><li><strong>业务输入输出要素-Business elements</strong></li></ol> <ul><li><strong>输入要素-Input elements</strong></li></ul> <blockquote><p>代理商号码、开始时间、结束时间</p> <p>Agent number, Start time, End time</p></blockquote> <ul><li><strong>输出要素-Output elements</strong></li></ul> <blockquote><p>代理商号码,充值号码,业务类型,金额,交费前余额,交费后余额,状态,交易时间,操作人员,操作部门</p> <p>Agent Number, Charge Number, Business Type, Amount, Pre-payment Balance, Post-payment Balance, Status, Transaction Time, Operators, Operating Departments</p></blockquote> <h3 id="免费资源转移转换-freeres-transfer-transform"><a href="#免费资源转移转换-freeres-transfer-transform" class="header-anchor">#</a> 免费资源转移转换-Freeres Transfer &amp; Transform</h3> <h4 id="基本描述-basic-description-6"><a href="#基本描述-basic-description-6" class="header-anchor">#</a> 基本描述-basic description</h4> <p>免费资源转移转换，主要包含两个功能，不同用户之间的免费资源转移，同用户之间的免费资源转换。</p> <h4 id="业务流程-business-process-6"><a href="#业务流程-business-process-6" class="header-anchor">#</a> 业务流程-business process</h4> <ol><li><p>点击Freeres Transfer &amp; Transform菜单进入页面；</p></li> <li><p>页面有Freeres Transfer和Freeres Transform两个tab页，默认是Freeres Transfer；</p></li> <li><p>Freeres Transfer的tab页输入转出的Telephone Number或者Account Id、转入的Telephone Number或者Account Id，查询可转移的免费资源；</p></li> <li><p>Freeres Transform的tab页输入转换的Telephone Number或者Account Id，查询可转移的免费资源；</p></li> <li><p>后台根据手机号码或者账户id去校验转出、转入的三户资料，用户不存在或状态非正常，则报错。</p></li> <li><p>查询后，展示可转移的源免费资源列表中；</p></li> <li><p>选中一条，点转移（转换），该条添加到转出列表中，额度可以修改；逐条添加后，点击提交；</p></li> <li><p>提示转移或转换的二次确认；</p></li> <li><p>后根据选中的免费资源列表，生成转入的免费资源列表，生失效时间和账户会设置为新的；</p></li> <li><p>记录转移转换的业务记录；</p></li> <li><p>调用信管免费资源转移转换webservice接口；</p></li> <li><p>接口返回成功，则发送短信；失败则回滚业务记录，</p></li> <li><p>提示前台成功信息（业务流水，转移的免费资源总量），或者出错信息；</p></li></ol> <p>使用的表：</p> <p>资源兑换规则配置表UCR_PARAM.AM_TRANS_SPEC</p> <p>免费资源变更记录表UCR_AC.AM_BUSI_FREE_RES（表结构待定）</p> <p>调用crm扣减操作员虚拟信誉度接口（是否要支持，待定）</p> <h4 id="业务规则-business-rules-6"><a href="#业务规则-business-rules-6" class="header-anchor">#</a> 业务规则-business rules</h4> <p>这个是客户去年提出的需求，需要支持资源转换；</p> <ol><li>表模型</li></ol> <p>免费资源变更记录表UCR_AC.AM_BUSI_FREE_RES（表结构待定）</p> <p>新建资源兑换规则配置表UCR_PARAM.AM_TRANS_SPEC</p> <p>转移的配置可以配置转出的科目及属性，转入时对应的科目；能配置转换比例；</p> <p>转换的配置，可以配置转换的科目及属性，可以配置；能配置转换比例；</p> <p>前台可选的转出科目和转入科目都做配置，并设置免费资源类型， 如4大类 语音，流量，短信，彩信。小类为语音有 网内，网外，全网，特定国家的IDD，特定国家的漫游等，流量有通用流程，特定流量，国漫流量等；</p> <p>+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------+----------------+--------------------+---------+----------------------------------------------------------------------------------------------------------------------------+
| 表名                     | UCR_PARAM.AM_TRANS_SPEC                                                                                                                     | 中文名         | 资源兑换规则配置表 +--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------+----------------+--------------------+---------+----------------------------------------------------------------------------------------------------------------------------+
| 分表策略                 | 无分表                                                                                                                                         | 历史表         | 无错误表，无历史表 +--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------+----------------+--------------------+---------+----------------------------------------------------------------------------------------------------------------------------+
| 详细说明：               | 资源兑换规则配置是资源之间进行兑换的规则配置，流量帐本与现金兑换比例。比如：流量帐本与余额；流量帐本与流量、短信、WLAN等免费资源兑换规则配置。 |                |                    +--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------+----------------+--------------------+---------+----------------------------------------------------------------------------------------------------------------------------+
| 字段名                   | 字段中文描述                                                                                                                                   | 数据类型       | 可空               | PK/索引 | 备注                                                                                                                       |
+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------+----------------+--------------------+---------+----------------------------------------------------------------------------------------------------------------------------+
| TRANS_SPEC_ID          | 转换规格编号                                                                                                                                   | NUMBER(15)     |                    | &gt; 主键  | 单价配置编号，唯一编号                                                                                                     |
+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------+----------------+--------------------+---------+----------------------------------------------------------------------------------------------------------------------------+
| SPEC_TYPE               | 规格类型                                                                                                                                       | NUMBER(4)      |                    |         | 规格类型                                                                                                                   |
|                          |                                                                                                                                                |                |                    |                          |                                                                                                                                                |                |                    |         | 1 免费资源转移                                                                                                             |
|                          |                                                                                                                                                |                |                    |                          |                                                                                                                                                |                |                    |         | 2 免费资源转移                                                                                                             |
+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------+----------------+--------------------+---------+----------------------------------------------------------------------------------------------------------------------------+
| NAME                     | 规格名称                                                                                                                                       | VARCHAR2(256)  |                    |         | 规格名称                                                                                                                   |
+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------+----------------+--------------------+---------+----------------------------------------------------------------------------------------------------------------------------+
| ITEM_ID                 | 科目编号                                                                                                                                       | NUMBER(9)      |                    |         | 科目编号                                                                                                                   |
+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------+----------------+--------------------+---------+----------------------------------------------------------------------------------------------------------------------------+
| ITEM_TYPE               | 科目类型                                                                                                                                       | NUMBER(4)      |                    |         | 科目类型，仅展示用                                                                                                         |
|                          |                                                                                                                                                |                |                    |                          |                                                                                                                                                |                |                    |         | 1语音，2流量，                                                                                                             |
|                          |                                                                                                                                                |                |                    |                          |                                                                                                                                                |                |                    |         | 3短信，4彩信                                                                                                               |
+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------+----------------+--------------------+---------+----------------------------------------------------------------------------------------------------------------------------+
| SUB_ITEM_TYPE          | 子科目类型                                                                                                                                     | NUMBER(9)      |                    |         | 科目类型，仅展示用，小类为语音有 网内，网外，全网，特定国家的IDD，特定国家的漫游等，流量有通用流程，特定流量，国漫流量等； |
+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------+----------------+--------------------+---------+----------------------------------------------------------------------------------------------------------------------------+
| MEASURE_ID              | 度量编号                                                                                                                                       | NUMBER(9)      |                    |         | 103：流量byte                                                                                                              |
|                          |                                                                                                                                                |                |                    |                          |                                                                                                                                                |                |                    |         | 105：流量MB                                                                                                                |
+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------+----------------+--------------------+---------+----------------------------------------------------------------------------------------------------------------------------+
| TARGET_ITEM_ID         | 目标科目编号                                                                                                                                   | NUMBER(9)      |                    |         | 目标科目编号                                                                                                               |
+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------+----------------+--------------------+---------+----------------------------------------------------------------------------------------------------------------------------+
| TARGET_ITEM_TYPE       | 目标科目类型                                                                                                                                   | NUMBER(4)      |                    |         | 科目类型，仅展示用                                                                                                         |
|                          |                                                                                                                                                |                |                    |                          |                                                                                                                                                |                |                    |         | 1语音，2流量，                                                                                                             |
|                          |                                                                                                                                                |                |                    |                          |                                                                                                                                                |                |                    |         | 3短信，4彩信                                                                                                               |
+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------+----------------+--------------------+---------+----------------------------------------------------------------------------------------------------------------------------+
| TARGET_ SUB_ITEM_TYPE | 目标科目编号                                                                                                                                   | NUMBER(9)      |                    |         | 科目类型，仅展示用，小类为语音有 网内，网外，全网，特定国家的IDD，特定国家的漫游等，流量有通用流程，特定流量，国漫流量等； |
+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------+----------------+--------------------+---------+----------------------------------------------------------------------------------------------------------------------------+
| TARGET_MEASURE_ID      | 目标度量编号                                                                                                                                   | NUMBER(9)      |                    |         | 103：流量byte                                                                                                              |
|                          |                                                                                                                                                |                |                    |                          |                                                                                                                                                |                |                    |         | 105：流量MB                                                                                                                |
+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------+----------------+--------------------+---------+----------------------------------------------------------------------------------------------------------------------------+
| TRANS_RATE              | 兑换比例                                                                                                                                       | NUMBER(8)      |                    |         | 兑换比例，百分比                                                                                                           |
+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------+----------------+--------------------+---------+----------------------------------------------------------------------------------------------------------------------------+
| REGION_ID               | 地市                                                                                                                                           | NUMBER(4)      |                    |         | 支持多地市，若忽略地市的通用配置，可写0                                                                                    |
+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------+----------------+--------------------+---------+----------------------------------------------------------------------------------------------------------------------------+
| REMARK                   | 描述                                                                                                                                           | VARCHAR2(1024) |                    |         | 描述                                                                                                                       |
+--------------------------+------------------------------------------------------------------------------------------------------------------------------------------------+----------------+--------------------+---------+----------------------------------------------------------------------------------------------------------------------------+</p> <ol start="2"><li>业务规则</li></ol> <p>对于可转移的科目，有什么限制吗？</p> <p>按照转移转换配置表的转入转出科目，只需要是有效的一次性或周期性免费资源科目。</p> <p>转入转出的免费资源总量是否要一致？</p> <p>按配置表中的转换比例计算转入金额，看转入转出的入参的数量设置，可用免费资源不够会转出失败</p> <p>免费资源类型能互转吗，比如语音转流量是否可以？</p> <p>转换的tab页，支持语音、流量、短信、彩信互转，具体规则，见转移转换配置表。</p> <p>是否需要收佣金的，或者转移后打折什么的？</p> <p>不支持佣金，转入的额度根据配置表中的转换比例计算；</p> <p>预付费和后付费免费资源是否能互转？</p> <p>不限制</p> <p>转出的免费资源失效了是否能转？</p> <p>失效的免费资源不支持转出；</p> <p>转入的免费资源生失效时间如何确定？</p> <p>转入的免费资源生效时间为当前操作时间，失效时间和转出的免费资源时间一致；生失效时间精确到天，比如生效为当前天的0时0分0秒 ，失效时间为失效天的0时0分0秒。</p> <p>相同账户是否能自己转换？</p> <p>转移的时候必须是两个不同的账户；</p> <p>转换的时候，页面只有一个账户输入，所以必须是相同的账户；</p> <h4 id="页面说明-page-description-5"><a href="#页面说明-page-description-5" class="header-anchor">#</a> 页面说明-Page description</h4> <p><strong>1、界面截图，参照</strong></p> <p>菜单：AssetwebAccounting ManagementAccount Audit Freeres Transfer &amp; Transform</p> <p><strong>2、业务输入输出要素-Business elements</strong></p> <ul><li><strong>输入要素-Input elements</strong></li></ul> <blockquote><p>Transfer Out Number（转出号码），Transfer In Number（转入号码）、</p> <p>Transfer method（转账方式），Transfer Amount (转账额度)，Transfer Reason（转账原因）</p></blockquote> <ul><li><strong>输出要素-Output elements</strong></li></ul> <blockquote><p>转出号码用户信息，转出号码免费资源信息，转入号码用户信息</p></blockquote> <h3 id="退押金-deposit-refund"><a href="#退押金-deposit-refund" class="header-anchor">#</a> 退押金-Deposit Refund</h3> <h4 id="基本描述-basic-description-7"><a href="#基本描述-basic-description-7" class="header-anchor">#</a> 基本描述-basic description</h4> <p>将押金退还给客户。</p> <h4 id="业务流程-business-process-7"><a href="#业务流程-business-process-7" class="header-anchor">#</a> 业务流程-business process</h4> <ol><li><p>页面输入用户号码/账户号码；</p></li> <li><p>点击查询后，账务管理系统查询用户的三户信息、用户押金；</p></li> <li><p>选择要退的押金；</p></li> <li><p>点击提交后，账务管理系统查询缴纳押金的业务记录；</p></li> <li><p>判断是否是金号码</p></li></ol> <blockquote><p>5.1如果是金号码，判断是否属于NTN组；</p> <p>5.2如果属于NTN组，则查询组内所有成员的押金金额和欠费金额；</p> <p>5.3如果组内所有成员的押金金额&gt;=欠费金额，则允许退费，否则提示有欠费不能退费；</p></blockquote> <ol start="6"><li>扣减押金账本，并记录退押金日志；</li></ol> <p>select * from UCR_AC1.AM_DEPOSIT where SUBSCRIBER_ID = 49110000853421;</p> <p>select * from UCR_AC1.AM_DEPOSIT_BUSI where SUBSCRIBER_ID = 49110000853421 order by trade_date desc;</p> <h4 id="业务规则-business-rules-7"><a href="#业务规则-business-rules-7" class="header-anchor">#</a> 业务规则-business rules</h4> <ul><li>押金金额 -- deposit amount</li></ul> <blockquote><p>退押金时，首先查询出押金金额，有多少退多少；</p></blockquote> <ul><li>金号码限制</li></ul> <blockquote><p>一个号码是否是金号码，可通过三户信息获取；</p> <p>如果退押金的号码是金号码，则要检查是否属于NTN组，如果属于NTN组，那么必须在组内总押金大于等于总欠费的情况下才能退费，否则不能退费；</p> <p>原需求描述如下：</p></blockquote> <p>The condition is clear....the owefee of all numbers in that NTN should be less than security deposit. This check should be only for the golden numbers belonging to NTN</p> <h4 id="页面说明-page-description-6"><a href="#页面说明-page-description-6" class="header-anchor">#</a> 页面说明-Page description</h4> <p><strong>1、界面截图，参照</strong></p> <p>菜单：Deposit Refund</p> <p><strong>2、业务输入输出要素-Business elements</strong></p> <ul><li><strong>输入要素-Input elements</strong></li></ul> <blockquote><p>手机号码</p></blockquote> <ul><li><strong>输出要素-Output elements</strong></li></ul> <blockquote><p>流水号、用户ID、地区、押金类型、押金金额、操作类型</p></blockquote> <h3 id="押金返销-deposit-reversal"><a href="#押金返销-deposit-reversal" class="header-anchor">#</a> 押金返销-Deposit Reversal</h3> <h4 id="基本描述-basic-description-8"><a href="#基本描述-basic-description-8" class="header-anchor">#</a> 基本描述-basic description</h4> <p>将押金业务返销。</p> <h4 id="业务流程-business-process-8"><a href="#业务流程-business-process-8" class="header-anchor">#</a> 业务流程-business process</h4> <ol><li><p>页面输入用户号码/手机号码；</p></li> <li><p>点击查询后，账务管理系统查询用户的三户信息、用户押金；</p></li> <li><p>选择要返销的押金；</p></li> <li><p>点击提交后，账务管理系统查询缴纳押金的业务记录；</p></li></ol> <p>select * from UCR_AC1.AM_DEPOSIT where SUBSCRIBER_ID = 49110000853421;</p> <p>select * from UCR_AC1.AM_DEPOSIT_BUSI where SUBSCRIBER_ID = 49110000853421 order by trade_date desc;</p> <h4 id="业务规则-business-rules-8"><a href="#业务规则-business-rules-8" class="header-anchor">#</a> 业务规则-business rules</h4> <ul><li>押金金额 -- deposit amount</li></ul> <blockquote><p>返销押金，首先查询出押金金额，现有押金不够时不让返销；</p></blockquote> <ul><li>只能返销新增与增强的类型</li></ul> <h4 id="页面说明-page-description-7"><a href="#页面说明-page-description-7" class="header-anchor">#</a> 页面说明-Page description</h4> <p><strong>1、界面截图，参照</strong></p> <p>菜单：Deposit Reversal</p> <p><strong>2、业务输入输出要素-Business elements</strong></p> <ul><li><strong>输入要素-Input elements</strong></li></ul> <blockquote><p>手机号码</p></blockquote> <ul><li><strong>输出要素-Output elements</strong></li></ul> <blockquote><p>流水号、用户ID、地区、押金类型、押金金额、操作类型</p></blockquote> <h3 id="批量退押金-batch-deposit-refund"><a href="#批量退押金-batch-deposit-refund" class="header-anchor">#</a> 批量退押金-Batch Deposit Refund</h3> <h4 id="基本描述-basic-description-9"><a href="#基本描述-basic-description-9" class="header-anchor">#</a> 基本描述-basic description</h4> <p>批量将押金退还给客户。</p> <h4 id="业务流程-business-process-9"><a href="#业务流程-business-process-9" class="header-anchor">#</a> 业务流程-business process</h4> <ol><li><p>输入手机号码，查询押金；或者选择用户类型、押金类型、地区，查询押金；或者通过文件import用户和押金类型，查询押金；</p></li> <li><p>页面选择是否进行NTN组的校验；</p></li> <li><p>如果是通过Query按钮查询，如果没有满足条件的押金信息，则不展示；</p></li> <li><p>如果是通过Import按钮查询，会在列表中展示出校验结果；校验的内容包括：</p> <ol><li><p>用户的三户信息，必须是存在的用户</p></li> <li><p>用户的押金类型，必须是存在的押金类型；</p></li> <li><p>是否重复import</p></li> <li><p>一次导入最多1000行</p></li></ol></li> <li><p>页面默认选中所有通过验证的押金记录（通过Query按钮查询的方式，查询出的都是可退的押金，所以默认全部选中）</p></li> <li><p>点击submit按钮，提交批量退押金；</p></li> <li><p>后台调用退押金接口，逐条退押金；</p></li> <li><p>页面展示每一条记录的退押金结果；</p></li></ol> <h4 id="业务规则-business-rules-9"><a href="#业务规则-business-rules-9" class="header-anchor">#</a> 业务规则-business rules</h4> <ul><li>Import文件格式</li></ul> <blockquote><p>文本格式</p> <p>手机号码+押金类型</p> <p>如：3158215366 7483774883</p> <p>最多1000行</p></blockquote> <ol><li><p>支持输入单个用户退押金；</p></li> <li><p>支持导入用户文件退押金；</p></li> <li><p>支持根据用户地区、用户类型、押金类型查询出所有满足条件的押金，进行退押金；</p></li></ol> <ul><li>NTN组校验</li></ul> <ol><li><p>首先判断退费号码是否属于NTN组；</p></li> <li><p>如果属于NTN组，则获取NTN组下所有的用户；</p></li> <li><p>循环查询NTN组下所有用户的押金和欠费，并累计所有用户的押金和欠费；</p></li> <li><p>如果押金总额&gt;欠费总额，则允许退费，否则提示错误信息；</p></li></ol> <h4 id="页面说明-page-description-8"><a href="#页面说明-page-description-8" class="header-anchor">#</a> 页面说明-Page description</h4> <p><strong>1、界面截图，参照</strong></p> <p>菜单：Deposit Refund页面中包含批量处理</p> <p><strong>2、业务输入输出要素-Business elements</strong></p> <ul><li><strong>输入要素-Input elements</strong></li></ul> <blockquote><p>手机号码、用户类型、地区、押金类型</p></blockquote> <ul><li><strong>输出要素-Output elements</strong></li></ul> <blockquote><p>Mobile Number：手机号码</p> <p>Deposit Type：押金类型</p> <p>Deposit Amount：押金金额</p> <p>Waiver：交押金时可能用了Waiver，如果用了的话这里会展示Waiver金额，退押金时这个字段没什么用</p> <p>Refund Amount：退押金的金额，提交之前都是0，提交之后是押金金额</p> <p>Remain Deposit：剩余押金金额，提交之前是押金金额，提交之后是0</p> <p>Operate Result Info：操作结果，展示验证结果信息以及退押金的结果信息</p> <p>Initial Order Number：流水号</p></blockquote> <h3 id="批量押金缴欠费-batch-deposit-to-owe-fee"><a href="#批量押金缴欠费-batch-deposit-to-owe-fee" class="header-anchor">#</a> 批量押金缴欠费-Batch Deposit To Owe Fee</h3> <h4 id="基本描述-basic-description-10"><a href="#基本描述-basic-description-10" class="header-anchor">#</a> 基本描述-basic description</h4> <p>如果用户有欠费账单的话，可以用押金抵扣。</p> <h4 id="业务流程-business-process-10"><a href="#业务流程-business-process-10" class="header-anchor">#</a> 业务流程-business process</h4> <ol><li><p>输入手机号码，查询押金和欠费；或者选择用户类型、押金类型、地区，查询押金和欠费；或者通过文件import用户和押金类型，查询押金和欠费；</p></li> <li><p>如果是通过Query按钮查询，如果没有满足条件的押金信息，则不展示；</p></li> <li><p>如果是通过Import按钮查询，会在列表中展示出校验结果；校验的内容包括：</p> <ol><li><p>用户的三户信息，必须是存在的用户</p></li> <li><p>用户的押金类型，必须是存在的押金类型；</p></li> <li><p>是否重复import</p></li> <li><p>一次导入最多1000行</p></li></ol></li> <li><p>页面默认选中所有通过验证的押金和欠费记录（押金大于0，欠费大于0是通过验证的记录）</p></li> <li><p>点击submit按钮，提交批量押金缴欠费；</p></li> <li><p>后台扣减押金账本；</p></li> <li><p>调用缴费接口；</p></li> <li><p>页面展示每一条记录的押金缴欠费结果；</p></li></ol> <h4 id="业务规则-business-rules-10"><a href="#业务规则-business-rules-10" class="header-anchor">#</a> 业务规则-business rules</h4> <ul><li>Import文件格式</li></ul> <blockquote><p>文本格式</p> <p>手机号码+押金类型</p> <p>如：3158215366 7483774883</p> <p>最多1000行</p></blockquote> <ol><li><p>支持输入单个用户操作押金缴欠费；</p></li> <li><p>支持导入用户文件操作押金缴欠费；</p></li> <li><p>支持根据用户地区、用户类型、押金类型查询出所有满足条件的记录（押金金额大于0，欠费金额大于0即为满足条件），进行押金缴欠费；</p></li></ol> <h4 id="页面说明-page-description-9"><a href="#页面说明-page-description-9" class="header-anchor">#</a> 页面说明-Page description</h4> <p><strong>1、界面截图，参照</strong></p> <p>菜单：Batch Deposit To Owe Fee</p> <p><strong>2、业务输入输出要素-Business elements</strong></p> <ul><li><strong>输入要素-Input elements</strong></li></ul> <blockquote><p>手机号码、用户类型、地区、押金类型</p></blockquote> <ul><li><strong>输出要素-Output elements</strong></li></ul> <blockquote><p>Mobile Number：手机号码</p> <p>Customer Name：客户名称</p> <p>CNIC：客户证件号码</p> <p>Deposit Type：押金类型</p> <p>Deposit Amount：押金金额</p> <p>Owe Fee：欠费金额</p> <p>Write-off：销账金额，提交前都是0，提交后展示实际销账金额</p> <p>Remain Deposit：剩余押金，提交前是押金金额，提交后展示实际剩余押金金额</p> <p>Operate Result Info：操作结果</p> <p>Initial Order Number：流水号</p></blockquote> <h3 id="押金管理-deposit-management"><a href="#押金管理-deposit-management" class="header-anchor">#</a> 押金管理-Deposit Management</h3> <h4 id="基本描述-basic-description-11"><a href="#基本描述-basic-description-11" class="header-anchor">#</a> 基本描述-basic description</h4> <p>个人押金管理界面，集成了对押金的各种操作，包括新增押金、押金修改、补押金、押金退还、押金转预存、预存转押金。</p> <h4 id="业务流程-business-process-11"><a href="#业务流程-business-process-11" class="header-anchor">#</a> 业务流程-business process</h4> <p><img src="media/image9.emf" alt=""></p> <h5 id="新增押金-子流程"><a href="#新增押金-子流程" class="header-anchor">#</a> 新增押金-子流程</h5> <ol><li><p>页面输入手机号码，点击【Query】按钮，查询用户押金；（任何操作之前都需要先Query）</p></li> <li><p>点击【ADD】按钮，打开新增押金的窗口；</p></li> <li><p>输入押金金额Deposit Amount（必填），备注Deposit Remark（选填），押金类型Reference Type（必填），押金方式Reference Method默认是Deposit（老系统交押金有2种方式，一种是Deposit，另一种是担保人方式，账管不做担保人方式，所以这里直接默认是Deposit）；</p></li> <li><p>Waiver、Waiver Code、Waiver Type都是选填，一旦输入了Waiver，那么Waiver Code、Waiver Type就是必填；Waiver Type不可编辑，通过验证Waiver Code得来；</p></li> <li><p>输入Waiver、Waiver Code（选填），点击按钮【Verify Waiver Code】</p></li></ol> <blockquote><p>5.1后台校验Waiver Code是否存在；</p> <p>5.2校验Waiver是否超出限额；</p> <p>5.3返回Waiver Code的Waiver Type Code和Waiver Type Name，展示在页面上的Waiver Type字段；</p></blockquote> <ol start="6"><li><p>点击【Submit】按钮，提交；</p></li> <li><p>后台新增押金账本，记录新增押金账本日志；</p></li> <li><p>如果输入了Waiver，后台调用Waiver变更接口，扣减Waiver额度；</p></li> <li><p>扣减Waiver额度成功后，后台调用虚拟信誉度变更接口，增加虚拟信誉度；（Waiver只用于增加虚拟信誉度，与押金并没有关系）；</p></li></ol> <h5 id="退押金-子流程"><a href="#退押金-子流程" class="header-anchor">#</a> 退押金-子流程</h5> <ol><li><p>页面输入手机号码，点击【Query】按钮，查询用户押金；</p></li> <li><p>选择要退还的押金，点击【---】按钮；</p></li> <li><p>扣减押金账本，并记录退押金日志；</p></li></ol> <h5 id="押金修改-子流程"><a href="#押金修改-子流程" class="header-anchor">#</a> 押金修改-子流程</h5> <ol><li><p>页面输入手机号码，点击【Query】按钮，查询用户押金；</p></li> <li><p>选择要修改的押金，点击<img src="media/image10.png" alt="">按钮，打开修改押金的窗口；</p></li> <li><p>输入要修改的押金金额Deposit Amount，备注信息Deposit Remark；</p></li> <li><p>其他的字段都不可修改；</p></li> <li><p>点击【Submit】按钮，提交；</p></li> <li><p>后台修改押金账本，记录押金修改日志；</p></li> <li><p>押金修改是直接修改押金金额！</p></li></ol> <h5 id="补押金-子流程"><a href="#补押金-子流程" class="header-anchor">#</a> 补押金-子流程</h5> <ol><li><p>页面输入手机号码，点击【Query】按钮，查询用户押金；</p></li> <li><p>选择要补押金的记录，点击【ENHANCE】按钮，打开补押金窗口；</p></li> <li><p>输入补押金ENHANCE的金额，押金类型Reference Type和押金方式Reference Method默认不可编辑；</p></li> <li><p>输入Waiver、Waiver Code（选填），点击按钮【Verify Waiver Code】</p></li></ol> <blockquote><p>5.1后台校验Waiver Code是否存在；</p> <p>5.2校验Waiver是否超出限额；</p> <p>5.3返回Waiver Code的Waiver Type Code和Waiver Type Name，展示在页面上的Waiver Type字段；</p></blockquote> <ol start="5"><li><p>点击【Submit】按钮，提交；</p></li> <li><p>后台变更押金账本，记录变更押金账本日志；</p></li> <li><p>如果输入了Waiver，后台调用Waiver变更接口，扣减Waiver额度；</p></li> <li><p>扣减Waiver额度成功后，后台调用虚拟信誉度变更接口，增加虚拟信誉度；（Waiver只用于增加虚拟信誉度，与押金并没有关系）；</p></li> <li><p>补押金是在原押金的基础上，加上补押金的金额！</p></li></ol> <h5 id="押金转预存-子流程"><a href="#押金转预存-子流程" class="header-anchor">#</a> 押金转预存-子流程</h5> <ol><li><p>页面输入手机号码，点击【Query】按钮，查询用户押金；</p></li> <li><p>选择要押金转预存的记录，点击【TO ADVANCE】按钮，打开押金转预存窗口；</p></li> <li><p>输入要转移的押金金额Transfer Amount；</p></li> <li><p>点击【Submit】按钮，提交；</p></li> <li><p>校验转移金额是否超出限额，Transfer Amount&lt;=Deposit Amount；</p></li> <li><p>后台扣减押金账本；</p></li> <li><p>扣减押金账本成功后，调用缴费接口，预付费用户调用&quot;asset_IPrePaymentCSV_doOcsCharge&quot;，后付费用户调用&quot;asset_IPaymentCSV_asyncPayment&quot;做缴费；</p></li> <li><p>页面提示转移成功；</p></li></ol> <h5 id="预存转押金-子流程"><a href="#预存转押金-子流程" class="header-anchor">#</a> 预存转押金-子流程</h5> <ol><li><p>页面输入手机号码，点击【Query】按钮，查询用户押金；</p></li> <li><p>选择要预存转押金的记录，点击【TO DEPOSIT】按钮，打开预存转押金窗口；（只有有预存的用户才可以操作预存转押金，否则无法打开预存转押金窗口），是否有预存，可以查看账户信息中的Total Balance和Can Transfer</p></li></ol> <blockquote><p><img src="media/image11.png" alt=""></p> <p>如何查询可转移的账本余额，请见&quot;账本查询-子流程&quot;</p></blockquote> <ol start="3"><li><p>输入要转移的预存金额Turn to Deposit；</p></li> <li><p>点击【Submit】按钮，提交；</p></li> <li><p>校验转移金额是否超出限额，Turn to Deposit&lt;=Can Transfer；</p></li> <li><p>后台调用预存账本扣减接口&quot; IAuditBC.deductAmount&quot;；</p></li> <li><p>扣减成功后，调用押金新增接口或补押金接口；如果所选择的押金类型不存在，则调用押金新增接口，如果所选择的押金类型已存在，则调用补押金接口；</p></li> <li><p>页面提示转移成功；</p></li></ol> <h5 id="校验waiver-code-子流程"><a href="#校验waiver-code-子流程" class="header-anchor">#</a> 校验Waiver Code-子流程</h5> <p>新增押金和补押金时，可以输入Waiver</p> <p><img src="media/image12.png" alt=""></p> <p><img src="media/image13.png" alt=""></p> <ol><li><p>输入Waiver，代表减免金额；</p></li> <li><p>输入Waiver Code，点击按钮【Verify Waiver Code】；</p></li> <li><p>后台调用&quot;order.IWaiveCSV.waiverQry&quot;接口，校验Waiver Code；</p></li> <li><p>如果Waiver Code不存在，直接抛出错误；</p></li> <li><p>如果Waiver Code存在，则可获取WAIVER_AMOUNT、WAIVER_TYPE_CODE、WAIVER_TYPE_NAME；</p></li> <li><p>校验页面上输入的Waiver，Waiver &lt;= WAIVER_AMOUNT，代表减免的额度不能超过限额；</p></li> <li><p>返回[WAIVER_TYPE_CODE] WAIVER_TYPE_NAME，即页面上展示的Waiver Type</p></li></ol> <blockquote><p><img src="media/image14.png" alt=""></p></blockquote> <ol start="8"><li>页面提示校验成功</li></ol> <h5 id="账本查询-子流程"><a href="#账本查询-子流程" class="header-anchor">#</a> 账本查询-子流程</h5> <p>账户信息中需要展示出账本余额和可转移的账本的余额</p> <p><img src="media/image15.png" alt=""></p> <ol><li>根据账号，查询账本</li></ol> <blockquote><p>select * from UCR_AC1.AM_BALANCE_06 t where acct_id=136744324</p></blockquote> <ol start="2"><li><p>调用查询欠费接口，计算欠费；</p></li> <li><p>账本扣减欠费后，累计账本余额Total Balance；</p></li> <li><p>哪些账本可以转移，配置在BS_PARA_DETAIL表中；</p></li></ol> <blockquote><p>select * from UCR_PARAM.BS_PARA_DETAIL where para_type = 'AM_PAY_OUT_BUSI_BALANCE' and para_code='120000006001'</p></blockquote> <ol start="5"><li>过滤出可以转移的账本，累计账本余额 Can Transfer；</li></ol> <h4 id="业务规则-business-rules-11"><a href="#业务规则-business-rules-11" class="header-anchor">#</a> 业务规则-business rules</h4> <ol><li><p>支持押金收取；</p></li> <li><p>支持押金退还；</p></li> <li><p>支持押金修改；</p></li> <li><p>支持补押金；</p></li> <li><p>支持押金转预存；</p></li> <li><p>支持预存转押金；</p></li> <li><p>押金收取时，支持同时使用waiverCode，新增虚拟信誉度；</p></li> <li><p>支持校验waiverCode；</p> <ol><li><h4 id="页面说明-page-description-10"><a href="#页面说明-page-description-10" class="header-anchor">#</a> 页面说明-Page description</h4></li></ol></li></ol> <p><strong>1、界面截图，参照</strong></p> <p>菜单：Deposit Management</p> <p><strong>2、业务输入输出要素-Business elements</strong></p> <ul><li><strong>输入要素-Input elements</strong></li></ul> <blockquote><p>ADD：</p> <p>手机号码、押金金额、押金类型、备注、Waiver、Waiver Code、Waiver Type</p> <p>MOD：</p> <p>手机号码、新的押金金额、备注</p> <p>ENHANCE：</p> <p>手机号码、补押金的金额、备注、Waiver、Waiver Code、Waiver Type</p> <p>TO ADVANCE：</p> <p>手机号码、转移金额</p> <p>TO DEPOSIT：</p> <p>手机号码、转移金额</p></blockquote> <ul><li><strong>输出要素-Output elements</strong></li></ul> <blockquote><p>Reference Type：押金类型</p> <p>Reference Method：押金方式，默认是Deposit</p> <p>Deposit Amount：押金金额</p> <p>Balance Amount：预存金额</p> <p>Waiver：Waiver额度</p> <p>Remark：备注</p> <p>Initial Order Number：流水号</p> <p>Operator：操作员</p> <p>Create Time：创建时间</p></blockquote> <h3 id="押金操作历史查询页面-query-deposit-business"><a href="#押金操作历史查询页面-query-deposit-business" class="header-anchor">#</a> 押金操作历史查询页面-Query Deposit Business</h3> <h4 id="基本描述-basic-description-12"><a href="#基本描述-basic-description-12" class="header-anchor">#</a> 基本描述-basic description</h4> <p>从押金管理可知，关于押金的操作有新增押金、押金修改、补押金、押金退还、押金转预存、预存转押金，这些操作后台都有日志记录。押金操作历史查询就是查询这些操作历史，追寻用户的押金做过哪些变更。</p> <h4 id="业务流程-business-process-12"><a href="#业务流程-business-process-12" class="header-anchor">#</a> 业务流程-business process</h4> <ol><li><p>页面输入手机号码、查询开始时间、结束时间；</p></li> <li><p>查询押金表和押金日志表，AM_DEPOSIT、AM_DEPOSIT_BUSI；</p></li> <li><p>格式化查询结果，返回页面展示；</p></li></ol> <h4 id="业务规则-business-rules-12"><a href="#业务规则-business-rules-12" class="header-anchor">#</a> 业务规则-business rules</h4> <ol><li><p>支持根据手机号码查询；</p></li> <li><p>查询时必须输入查询时间范围；</p></li> <li><p>查询时间范围支持6个月内；</p> <ol start="2"><li><h4 id="页面说明-page-description-11"><a href="#页面说明-page-description-11" class="header-anchor">#</a> 页面说明-Page description</h4></li></ol></li></ol> <p><strong>2、业务输入输出要素-Business elements</strong></p> <ul><li><strong>输入要素-Input elements</strong></li></ul> <p>手机号码、开始时间、结束时间</p> <ul><li><strong>输出要素-Output elements</strong></li></ul> <p>押金类型、押金金额、操作员、操作时间、业务类型、备注</p> <h3 id="ntn-deposit-refund"><a href="#ntn-deposit-refund" class="header-anchor">#</a> NTN Deposit Refund</h3> <h4 id="基本描述-basic-description-13"><a href="#基本描述-basic-description-13" class="header-anchor">#</a> 基本描述-basic description</h4> <p>普通的个人用户退押金可以参考1.7.10 退押金。如果是NTN组用户，退押金时需要计算NTN组的总押金和总欠费，只有当总押金&gt;=总欠费时，才允许用户退押金。由于累计NTN组的总押金和总欠费耗时长，所以采用后台任务。此功能用于录入NTN组退押金任务。</p> <h4 id="业务流程-business-process-13"><a href="#业务流程-business-process-13" class="header-anchor">#</a> 业务流程-business process</h4> <ul><li>NTN组单个用户退押金</li></ul> <ol><li><p>页面输入Phone Number；</p></li> <li><p>后台查询出用户的押金信息并展示；</p></li> <li><p>选择要退的押金，点击【Submit】按钮提交；</p></li> <li><p>后台在AM_NTN_DEPOSIT_TASK中记录退押金任务；</p></li></ol> <blockquote><p><img src="media/image16.png" alt=""></p> <p>TASK_ID：任务唯一ID</p> <p>BUSIENSS_TYPE_ID：业务类型，3-退押金</p> <p>REFUND_TYPE_ID：退押金类型，1-按用户退，2-按部门退，3-按NTN组退</p> <p>NTN_ID：NTN组ID</p> <p>DEPT_ID：部门ID</p> <p>SUBSCRIBER_ID：用户ID</p> <p>ACCESS_NO：手机号码</p> <p>STATE：状态，0-准备 1-完成 F-失败</p> <p>BUSINESS_ID：押金记录关联的业务流水</p> <p>DEPOSIT_TYPE_ID：押金类型，如果是单个用户退押金，这里填空</p> <p>REALTE_TASK_ID：关联AM_NTN_TASK中的任务</p></blockquote> <ol start="5"><li>后台在AM_NTN_TASK中记录查NTN账单任务；</li></ol> <blockquote><p><img src="media/image17.png" alt=""></p> <p>TASK_ID：任务唯一ID</p> <p>BUSIENSS_TYPE_ID：业务类型，7000-账单查询</p> <p>NTN_ID：NTN组ID</p> <p>DEPT_ID：部门ID，为空表示查询整个NTN组用户的账单</p> <p>BEGIN_MONTH：开始账期，当前月-12</p> <p>END_MONTH：结束账期，当前月</p> <p>STATE：状态，U:未处理, I:客管处理中, P:客管处理完成, D:客管处理失败, A:账管处理中, S:账管处理完成, F:账管处理失败</p> <p>查询NTN组总欠费的任务，相同的任务在24小时内，不重复记录工单。</p></blockquote> <ul><li>NTN组按部门退押金或整个NTN组退押金</li></ul> <ol><li><p>页面输入NTN_ID，DEPT_ID；</p></li> <li><p>后台查询出NTN组的部门信息并展示；</p></li> <li><p>选择要退押金的部门，如果整个NTN组退押金，则全选所有部门，点击【Submit】按钮提交；</p></li> <li><p>后台在AM_NTN_DEPOSIT_TASK中记录退押金任务；</p></li></ol> <blockquote><p><img src="media/image18.png" alt=""></p> <p>按部门退押金，REFUND_TYPE_ID填2，DEPT_ID必须输入，DEPOSIT_TYPE_ID是页面选择的押金类型，如果退所有押金，DEPOSIT_TYPE_ID填-1</p> <p><img src="media/image19.png" alt=""></p> <p>按NTN组退押金，REFUND_TYPE_ID填3，DEPT_ID为空</p></blockquote> <ol start="6"><li>后台在AM_NTN_TASK中记录查NTN账单任务；</li></ol> <p>任务录入之后，需要启动退押金后台任务NTN_DEPOSIT_REFUND_TASK，才能完成退押金！退押金任务请参考1.10.2 NTN Deposit Refund</p> <h4 id="业务规则-business-rules-13"><a href="#业务规则-business-rules-13" class="header-anchor">#</a> 业务规则-business rules</h4> <p>无</p> <h4 id="页面说明-page-description-12"><a href="#页面说明-page-description-12" class="header-anchor">#</a> 页面说明-Page description</h4> <ol><li><strong>界面截图</strong></li></ol> <p><img src="media/image20.png" alt=""></p> <p><img src="media/image21.png" alt=""></p> <p><strong>2、业务输入输出要素-Business elements</strong></p> <ul><li><strong>输入要素-Input elements</strong></li></ul> <blockquote><p><strong>NTN_ID：NTN组ID</strong></p> <p><strong>DEPT_ID：部门ID</strong></p> <p><strong>Phone Number：手机号码</strong></p></blockquote> <ul><li><strong>输出要素-Output elements</strong></li></ul> <p><strong>部门信息：部门ID、部门名称、联系人姓名、联系人地址、生效期、失效期</strong></p> <p><strong>个人押金信息：手机号码、押金类型、押金金额、押金业务流水号、NTN组ID</strong></p> <h3 id="query-ntn-deposit-refund"><a href="#query-ntn-deposit-refund" class="header-anchor">#</a> Query NTN Deposit Refund</h3> <h4 id="基本描述-basic-description-14"><a href="#基本描述-basic-description-14" class="header-anchor">#</a> 基本描述-basic description</h4> <p>查询NTN 组用户退押金的结果。</p> <p>启动退押金后台任务NTN_DEPOSIT_REFUND_TASK之后，可以在【Query NTN Deposit Refund】页面查询退押金结果。</p> <h4 id="业务流程-business-process-14"><a href="#业务流程-business-process-14" class="header-anchor">#</a> 业务流程-business process</h4> <ol><li><p>页面输入查询条件，开始时间和结束时间默认3个月内，NTN_ID、部门ID、任务ID、手机号码，至少输入一个；</p></li> <li><p>后台查询任务，并展示；</p></li></ol> <h4 id="业务规则-business-rules-14"><a href="#业务规则-business-rules-14" class="header-anchor">#</a> 业务规则-business rules</h4> <p>无</p> <h4 id="页面说明-page-description-13"><a href="#页面说明-page-description-13" class="header-anchor">#</a> 页面说明-Page description</h4> <ol><li><strong>界面截图</strong></li></ol> <p><img src="media/image22.png" alt=""></p> <p><strong>2、业务输入输出要素-Business elements</strong></p> <ul><li><strong>输入要素-Input elements</strong></li></ul> <blockquote><p><strong>NTN_ID：NTN组ID</strong></p> <p><strong>DEPT_ID：部门ID</strong></p> <p><strong>Phone Number：手机号码</strong></p> <p><strong>TASK_ID：任务ID</strong></p> <p><strong>Start_date：查询开始时间</strong></p> <p><strong>END_date：查询结束时间</strong></p></blockquote> <ul><li><strong>输出要素-Output elements</strong></li></ul> <blockquote><p><strong>任务ID、NTN组ID、部门ID、手机号码、押金类型、押金业务流水、创建时间、状态</strong></p></blockquote> <h3 id="后付费批量调账-postpaid-adjustment"><a href="#后付费批量调账-postpaid-adjustment" class="header-anchor">#</a> 后付费批量调账-Postpaid Adjustment</h3> <h4 id="基本描述"><a href="#基本描述" class="header-anchor">#</a> 基本描述</h4> <p>批量导入包含用户手机号码和调账金额的txt文件，按照导入的调账信息，批量调账后付费用户账本。</p> <h4 id="业务流程"><a href="#业务流程" class="header-anchor">#</a> 业务流程</h4> <ol><li><p>打开预付费调账页面，Account Audit-&gt;Postpaid Adjustment</p></li> <li><p>页面右上角，选择&quot;Batch Adjust&quot;图标，选择对应的txt文件，并上传</p></li> <li><p>上传成功后，点击&quot;Import&quot;按钮，将txt中的数据导入到调账列表中，导入流程如下：</p> <ol><li><p>校验调账金额是否是数字以及是否是0</p></li> <li><p>校验手机号格式（目前巴基斯坦手机号格式不确定，待确定）</p></li> <li><p>校验列表中是否含有重复的手机号</p></li> <li><p>校验手机号是否是后付费用户</p></li></ol></li> <li><p>提交之前，输入相关必填信息，点击commit,数据调账工单表，等待工单进程处理。</p></li> <li><p>点击&quot;Add&quot;按钮，可添加单条调账本金额</p></li> <li><p>输入调账的必填条件，点击&quot;Commit&quot;按钮，进入调账流程，如下</p> <ol start="5"><li><p>处理校验通过的数据</p></li> <li><p>从调账记录表AM_ADJUSTMENT_REC，按批次号（CPR_NO）查询此批次号是否已经使用，使用过则直接报错</p></li> <li><p>调账为调增，查询是否有可调账本，若有可调账本则给可调账本增加余额，若无可调账本则新建相应余额可调账本。</p></li> <li><p>调账为调减，查询账本列表，如果普通账本余额足够扣减，减少对应的账本余额，若不够则增加外部费用，记录am_busi表。</p></li> <li><p>写调账记录表AM_ADJUSTMENT_REC</p></li></ol></li> <li><p>点击&quot;Export&quot;按钮将调账列表导出到Excel中</p></li> <li><p>点击&quot;Clear&quot;按钮,清空调账列表和输入信息</p></li></ol> <h4 id="业务规则"><a href="#业务规则" class="header-anchor">#</a> 业务规则</h4> <ol><li><p>前台导入校验规则</p> <ol><li><p>手机号必须是后付费用户</p></li> <li><p>手机号不能重复</p></li> <li><p>金额必须是有效金额, 正的或者负的数字</p></li></ol></li> <li><p>后台批次号校验规则</p> <ol start="4"><li><p>批次号不能和AM_ADJUSTMENT_REC里已经存在的批次重复</p></li> <li><p>同一批次的调账列表,全部处理失败,可以重新处理</p></li></ol></li> <li><p>调减时, 信用度+账本余额够</p></li> <li><p>一个手机号记录一条调账日志</p></li></ol> <h4 id="页面说明"><a href="#页面说明" class="header-anchor">#</a> 页面说明</h4> <p><strong>界面截图，参照</strong></p> <p>菜单：AssetwebAccounting ManagerAccount AuditPostpaid Adjustment</p> <p><strong>2、业务输入输出要素-Business elements</strong></p> <ul><li><strong>输入要素-Input elements</strong></li></ul> <blockquote><p>调账列表、Authority、Transection Type、CPR NO、Remark</p></blockquote> <ul><li><strong>输出要素-Output elements</strong></li></ul> <ol><li><strong>调账结果列表</strong></li></ol> <h3 id="清退-balance-refund"><a href="#清退-balance-refund" class="header-anchor">#</a> 清退-Balance Refund</h3> <h4 id="基本描述-2"><a href="#基本描述-2" class="header-anchor">#</a> 基本描述</h4> <p>清退指查询账户的可退账本，将可清退余额，退还给用户。</p> <h4 id="业务流程-2"><a href="#业务流程-2" class="header-anchor">#</a> 业务流程</h4> <ol><li><p>输入Normal 手机号，或者账户，点击&quot;Query&quot;查询可清退账本</p></li> <li><p>根据查询的可清退账本，在弹窗金额框内，输入清退金额。</p></li> <li><p>点击&quot;<strong>Specify account book</strong>&quot;为指定账本进行清退</p></li> <li><p>点击&quot;<strong>Receipt Print</strong>&quot;打印清退票据。</p></li> <li><p>点击&quot;<strong>Send Message</strong>&quot;发送短信。</p></li> <li><p>在备注框内输入清退备注。</p></li> <li><p>点击&quot;Submit&quot;提交操作进行清退</p></li></ol> <h4 id="业务规则-2"><a href="#业务规则-2" class="header-anchor">#</a> 业务规则</h4> <ol><li><p>手机号或者账户为Normal。</p></li> <li><p>通过余额查询得到可清退账本需要&gt;Rs.0</p></li></ol> <h4 id="页面说明-2"><a href="#页面说明-2" class="header-anchor">#</a> 页面说明</h4> <p><strong>界面截图，参照</strong></p> <p>菜单：AssetwebAccounting ManagerAccount AuditBalance Refund</p> <p><strong>2、业务输入输出要素-Business elements</strong></p> <ul><li><strong>输入要素-Input elements</strong></li></ul> <blockquote><p><strong>手机号或账户，清退备注，是否打印票据，是否发送短信</strong></p></blockquote> <ul><li><strong>输出要素-Output elements</strong></li></ul> <blockquote><p>清退成功提示，票据打印选项</p></blockquote> <h2 id="账详单中心"><a href="#账详单中心" class="header-anchor">#</a> 账详单中心</h2> <h3 id="月结账单查询-month-bill-query"><a href="#月结账单查询-month-bill-query" class="header-anchor">#</a> 月结账单查询-Month Bill Query</h3> <h4 id="基本描述-basic-description-15"><a href="#基本描述-basic-description-15" class="header-anchor">#</a> 基本描述-basic description</h4> <p>根据手机号码/账户号码查询指定账期的账单信息。</p> <h4 id="业务流程-business-process-15"><a href="#业务流程-business-process-15" class="header-anchor">#</a> 业务流程-business process</h4> <ol><li><p>页面输入手机号码/账户号码，选择要查询的账期；</p></li> <li><p>点击查询后，账务管理系统查询用户资料、账单信息；</p></li> <li><p>汇总账单信息，格式化账单信息；</p></li> <li><p>页面展示汇总后的账单；</p></li> <li><p>如果需要查看账单明细，双击一条汇总账单查看账单明细；</p></li> <li><p>如果需要打印账单，单击一条汇总账单，点击打印按钮；</p></li></ol> <blockquote><p>6.1账务管理系统根据汇总账单查询账单明细；</p> <p>6.2页面预览账单明细；</p> <p>6.3打印账单；</p></blockquote> <ol start="7"><li>如果需要下载账单，单击一条汇总账单，点击下载按钮；</li></ol> <blockquote><p>7.1账务管理系统根据汇总账单查询账单明细；</p> <p>7.2创建文件编号；</p> <p>7.3生成临时账单文件；</p> <p>7.4将生成的账单文件上传到FTP；</p> <p>7.5删除临时账单文件；</p> <p>7.6将账单文件的文件编号返回页面；</p> <p>7.7下载账单文件；</p></blockquote> <ul><li>Query 历史账单</li></ul> <blockquote><p>select * from UCR_AC1.AM_BILL_AR_201808 t where t.access_no='13658992995';</p> <p>调用调账日志查询接口asset_IAdjustCSV_queryAdjustLog</p></blockquote> <ul><li>Query 实时账单</li></ul> <blockquote><p>调用ABM实时账单接口QUERY_REALBILLPD</p></blockquote> <ul><li>打印 历史账单</li></ul> <blockquote><p>select * from UCR_AC1.AM_BILL_AR_201808 t where t.access_no='13658992995';</p> <p>调用调账日志查询接口asset_IAdjustCSV_queryAdjustLog</p> <p>调用asset_IChargeQueryCSV_queryBalInfo查询账户结余信息</p> <p>调用asset_IChargeQueryCSV_queryDepositInfo查询资金变动信息</p> <p>调用score_IScoreMileageQueryCSV_queryScoreMonthInout查询积分信息</p> <p>Select * from UCR_AC1.AM_MFEESUM; -- 6个月消费趋势</p> <p>调用bill_IDiscntCSV_queryAllResourceInfos查询免费资源</p></blockquote> <h4 id="业务规则-special-rules"><a href="#业务规则-special-rules" class="header-anchor">#</a> 业务规则-special rules</h4> <ul><li><strong>查询日期规则</strong></li></ul> <ol><li><p>开始月份不能大于结束月份</p></li> <li><p>查询月份跨度不能超过6个月</p></li> <li><p>查询月份距当前月份不超过12个月；</p></li></ol> <ul><li><strong>账单导出格式</strong></li></ul> <div class="language-xml extra-class"><pre class="language-xml"><code> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>sheet</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>USERBILL<span class="token punctuation">&quot;</span></span> <span class="token attr-name">desc</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>帐单查询结果<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>header</span> <span class="token attr-name">isshow</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>300<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cell</span>
 <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ACCESS_NO<span class="token punctuation">&quot;</span></span>
 <span class="token attr-name">desc</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>手机号码<span class="token punctuation">&quot;</span></span>
 <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span>
 <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2<span class="token punctuation">&quot;</span></span>
 <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>6000<span class="token punctuation">&quot;</span></span>
 <span class="token attr-name">nullable</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>yes<span class="token punctuation">&quot;</span></span>
 <span class="token punctuation">/&gt;</span></span>

 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cell</span>
 <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>SUBSCRIBER_ID<span class="token punctuation">&quot;</span></span>
 <span class="token attr-name">desc</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>用户编码<span class="token punctuation">&quot;</span></span>
 <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span>
 <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2<span class="token punctuation">&quot;</span></span>
 <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>6000<span class="token punctuation">&quot;</span></span>
 <span class="token attr-name">nullable</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>yes<span class="token punctuation">&quot;</span></span>
 <span class="token punctuation">/&gt;</span></span>

 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cell</span>
 <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ACCT_ID<span class="token punctuation">&quot;</span></span>
 <span class="token attr-name">desc</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>账户编码<span class="token punctuation">&quot;</span></span>
 <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span>
 <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2<span class="token punctuation">&quot;</span></span>
 <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>6000<span class="token punctuation">&quot;</span></span>
 <span class="token attr-name">nullable</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>yes<span class="token punctuation">&quot;</span></span>
 <span class="token punctuation">/&gt;</span></span>

 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cell</span>
 <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>BILL_MONTH<span class="token punctuation">&quot;</span></span>
 <span class="token attr-name">desc</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>账单月份<span class="token punctuation">&quot;</span></span>
 <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span>
 <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2<span class="token punctuation">&quot;</span></span>
 <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>3000<span class="token punctuation">&quot;</span></span>
 <span class="token attr-name">nullable</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>yes<span class="token punctuation">&quot;</span></span>
 <span class="token punctuation">/&gt;</span></span>

 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cell</span>
 <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>BILL_ITEM_NAME<span class="token punctuation">&quot;</span></span>
 <span class="token attr-name">desc</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>账单科目<span class="token punctuation">&quot;</span></span>
 <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span>
 <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span>
 <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>10000<span class="token punctuation">&quot;</span></span>
 <span class="token attr-name">nullable</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>yes<span class="token punctuation">&quot;</span></span>
 <span class="token punctuation">/&gt;</span></span>

 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cell</span>

 <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>INIT_FEE<span class="token punctuation">&quot;</span></span>

 <span class="token attr-name">desc</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>优惠前费用（元）<span class="token punctuation">&quot;</span></span>

 <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span>

 <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2<span class="token punctuation">&quot;</span></span>

 <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>5000<span class="token punctuation">&quot;</span></span>

 <span class="token attr-name">nullable</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>yes<span class="token punctuation">&quot;</span></span>

 <span class="token punctuation">/&gt;</span></span>

 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cell</span>

 <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>A_DISCNT<span class="token punctuation">&quot;</span></span>

 <span class="token attr-name">desc</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>优惠费用（元）<span class="token punctuation">&quot;</span></span>

 <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span>

 <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2<span class="token punctuation">&quot;</span></span>

 <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>5000<span class="token punctuation">&quot;</span></span>

 <span class="token attr-name">nullable</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>yes<span class="token punctuation">&quot;</span></span>

 <span class="token punctuation">/&gt;</span></span>

 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cell</span>

 <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>FEE<span class="token punctuation">&quot;</span></span>

 <span class="token attr-name">desc</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>实收费用（元）<span class="token punctuation">&quot;</span></span>

 <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span>

 <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>3<span class="token punctuation">&quot;</span></span>

 <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>5000<span class="token punctuation">&quot;</span></span>

 <span class="token attr-name">nullable</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>yes<span class="token punctuation">&quot;</span></span>

 <span class="token punctuation">/&gt;</span></span>

 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cell</span>

 <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>TAX_RATE<span class="token punctuation">&quot;</span></span>

 <span class="token attr-name">desc</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>税率<span class="token punctuation">&quot;</span></span>

 <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span>

 <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>3<span class="token punctuation">&quot;</span></span>

 <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>5000<span class="token punctuation">&quot;</span></span>

 <span class="token attr-name">nullable</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>yes<span class="token punctuation">&quot;</span></span>

 <span class="token punctuation">/&gt;</span></span>

 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>header</span><span class="token punctuation">&gt;</span></span>

 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>sheet</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li><strong>实时账单</strong></li></ul> <blockquote><p>实时账单不支持打印和导出</p></blockquote> <h4 id="页面说明-page-description-14"><a href="#页面说明-page-description-14" class="header-anchor">#</a> 页面说明-Page description</h4> <p><strong>1、界面截图，参照</strong></p> <p>菜单：Month Bill Query</p> <p><strong>2、业务输入输出要素-Business elements</strong></p> <ul><li><strong>输入要素-Input elements</strong></li></ul> <blockquote><p>手机号码/账户号码、开始时间、结束时间、是否销户标志、是否单用户标志</p></blockquote> <ul><li><strong>输出要素-Output elements</strong></li></ul> <blockquote><p>月份,手机号码,客户名称,账户标识,账户名称,原始费用,优惠费用,实收费用,调账费用</p></blockquote> <h3 id="批量发送ebill-bulk-ebill-query-bulk-ebill"><a href="#批量发送ebill-bulk-ebill-query-bulk-ebill" class="header-anchor">#</a> 批量发送Ebill-Bulk Ebill &amp; Query Bulk Ebill</h3> <h4 id="基本描述-basic-description-16"><a href="#基本描述-basic-description-16" class="header-anchor">#</a> 基本描述-basic description</h4> <p>批量发送Ebill是给客户重发Email电子账单，将需要重发的用户手机号码通过文件的方式从页面导入到AM_EMAIL_RESEND表中，后台启动Ebill重发任务，给客户重发电子账单。</p> <h4 id="业务流程-business-process-16"><a href="#业务流程-business-process-16" class="header-anchor">#</a> 业务流程-business process</h4> <ol><li><p>页面导入需要重发电子账单的用户的文件；</p></li> <li><p>后台校验用户资料，校验是否重复导入（select * from UCR_AC1.AM_EMAIL_RESEND where pos_month=？ and phone_id=? and send_flag=0 有查询结果即为重复）；</p></li> <li><p>Insert AM_EMAIL_RESEND;</p></li></ol> <h4 id="业务规则-special-rules-2"><a href="#业务规则-special-rules-2" class="header-anchor">#</a> 业务规则-special rules</h4> <ul><li>Import文件格式</li></ul> <blockquote><p>文本格式</p> <p>手机号码</p> <p>如：3158215366</p> <p>最多1000行</p></blockquote> <ul><li>支持重发前6个月的账单</li></ul> <h4 id="页面说明-page-description-15"><a href="#页面说明-page-description-15" class="header-anchor">#</a> 页面说明-Page description</h4> <p><strong>1、界面截图，参照</strong></p> <p>菜单：Bulk E-Bill</p> <p><strong>2、业务输入输出要素-Business elements</strong></p> <ul><li><strong>输入要素-Input elements</strong></li></ul> <blockquote><p>手机号码、月份</p></blockquote> <ul><li><strong>输出要素-Output elements</strong></li></ul> <blockquote><p>手机号码、导入状态、错误信息</p></blockquote> <h3 id="日账单查询-daily-bill-query"><a href="#日账单查询-daily-bill-query" class="header-anchor">#</a> 日账单查询-Daily Bill Query</h3> <h4 id="基本描述-basic-description-17"><a href="#基本描述-basic-description-17" class="header-anchor">#</a> 基本描述-basic description</h4> <p>日账单查询是指按照用户的使用记录,将当日账单展示给用户。</p> <h4 id="业务流程-business-process-17"><a href="#业务流程-business-process-17" class="header-anchor">#</a> 业务流程-business process</h4> <ol><li><p>点击Daily Bill Query（日账单查询）菜单；</p></li> <li><p>页面选择使用手机号，或者账户方式查询，选择查询类型按日累计查询，或当日账单查询，选择是否考虑高级付费关系，点击查询；</p></li> <li><p>点击查询后，汇总账单信息，格式化账单信息；展示用户日账单列表, 步骤如下3.1~3.4如下：</p></li></ol> <p>3.1 页面展示汇总后的账单；</p> <p>3.2 如果需要查看账单明细，双击一条汇总账单查看账单明细；</p> <h4 id="业务规则-business-rules-15"><a href="#业务规则-business-rules-15" class="header-anchor">#</a> 业务规则-business rules</h4> <ol><li><p>查询日期规则</p> <ol><li><p>查询时间不能超过2个月</p></li> <li><p>查询日期为当前时间前一天</p></li></ol></li> <li><p>查询类型</p></li></ol> <blockquote><p>若按账户查，则无法选择考虑高级付费关系</p> <p>若已日累计方式查询，则显示当前月份总的账单</p></blockquote> <h4 id="页面说明-page-description-16"><a href="#页面说明-page-description-16" class="header-anchor">#</a> 页面说明-Page description</h4> <p><strong>界面截图，参照</strong></p> <p>菜单：Daily Bill Query</p> <p><strong>2、业务输入输出要素-Business elements</strong></p> <ul><li><strong>输入要素-Input elements</strong></li></ul> <blockquote><p>手机号/账户编号、查询时间，查询方式</p></blockquote> <ul><li><strong>输出要素-Output elements</strong></li></ul> <p>账户ID，手机号码，查询日期，原始费用，优惠费用，实际费用</p> <h3 id="详单查询操作日志查询-cdr-oper-log-query"><a href="#详单查询操作日志查询-cdr-oper-log-query" class="header-anchor">#</a> 详单查询操作日志查询-CDR Oper Log Query</h3> <h4 id="基本描述-basic-description-18"><a href="#基本描述-basic-description-18" class="header-anchor">#</a> 基本描述-basic description</h4> <p>详单查询操作日志查询是指查询详单查询操作记录。</p> <h4 id="、业务流程-business-process"><a href="#、业务流程-business-process" class="header-anchor">#</a> 、业务流程-business process</h4> <ol><li><p>点击CDR Oper Log Query（详单查询操作日志查询）菜单；</p></li> <li><p>页面输入手机号码或开始时间或者结束时间。</p></li> <li><p>点击查询后，展示详单查询操作记录。</p></li></ol> <h4 id="业务规则-business-rules-16"><a href="#业务规则-business-rules-16" class="header-anchor">#</a> 业务规则-business rules</h4> <p>转义规则：</p> <ol><li>从am_cdr_user_oper表中获取查询类型字段，然后查询AM_TYPE_DETAIL_MAP表进行相应转义。</li></ol> <h4 id="页面说明-page-description-17"><a href="#页面说明-page-description-17" class="header-anchor">#</a> 页面说明-Page description</h4> <p><strong>界面截图，参照</strong></p> <p>菜单：CDR Oper Log Query</p> <p><strong>2、业务输入输出要素-Business elements</strong></p> <ul><li><strong>输入要素-Input elements</strong></li></ul> <blockquote><p>手机号，开始时间，结束时间</p></blockquote> <ul><li><strong>输出要素-Output elements</strong></li></ul> <blockquote><p><strong>详单查询操作日志记录</strong></p></blockquote> <h3 id="触发账务出日账-real-time-bill"><a href="#触发账务出日账-real-time-bill" class="header-anchor">#</a> 触发账务出日账-Real Time Bill</h3> <h4 id="基本描述-basic-description-19"><a href="#基本描述-basic-description-19" class="header-anchor">#</a> 基本描述-basic description</h4> <p>根据手机号，重新给用户出日账</p> <h4 id="业务流程-business-process-18"><a href="#业务流程-business-process-18" class="header-anchor">#</a> 业务流程-business process</h4> <ol><li><p>点击Real Time Billing （触发账务出日账）菜单；</p></li> <li><p>页面输入手机号，点击查询，列表展示相关状态；</p></li> <li><p>点击&quot;删除&quot;图标，可从列表中删除记录</p></li> <li><p>在选择框中，选择需要提交的记录。点击&quot;submit&quot;进行提交</p></li></ol> <h4 id="业务规则-business-rules-17"><a href="#业务规则-business-rules-17" class="header-anchor">#</a> 业务规则-business rules</h4> <ol><li>记录将插入ad.ca_accp_billing_xxxx表中等待计费进程进行扫描处理，若处理</li></ol> <p>成功，将会将记录移到历史表中。</p> <h4 id="页面说明-page-description-18"><a href="#页面说明-page-description-18" class="header-anchor">#</a> 页面说明-Page description</h4> <p><strong>界面截图，参照</strong></p> <p>菜单：Real Time Billing</p> <p><strong>2、业务输入输出要素-Business elements</strong></p> <ul><li><strong>输入要素-Input elements</strong></li></ul> <blockquote><p>手机号</p></blockquote> <ul><li><strong>输出要素-Output elements</strong></li></ul> <blockquote><p><strong>手机号、状态、备注</strong></p></blockquote> <h3 id="触发账务出日账查询-real-time-bill-query"><a href="#触发账务出日账查询-real-time-bill-query" class="header-anchor">#</a> 触发账务出日账查询-Real Time Bill Query</h3> <h4 id="基本描述-basic-description-20"><a href="#基本描述-basic-description-20" class="header-anchor">#</a> 基本描述-basic description</h4> <p>触发账务出日账查询是指查询出日账的进程状态。</p> <h4 id="业务流程-business-process-19"><a href="#业务流程-business-process-19" class="header-anchor">#</a> 业务流程-business process</h4> <ol><li><p>点击Real Time Billing Query（触发账务出日账查询）菜单；</p></li> <li><p>页面输入查询条件，手机号、操作员ID（可不输、开始时间、结束时间；</p></li> <li><p>点击查询后，得到记录：</p> <ol><li><p>根据条件从CA_ACCP_BILLING在线表中获取记录（处理状态）标为等待处理</p></li> <li><p>CA_ACCP_BILLING_201912历史表中标为已处理完成</p></li></ol></li></ol> <h4 id="业务规则-business-rules-18"><a href="#业务规则-business-rules-18" class="header-anchor">#</a> 业务规则-business rules</h4> <ol><li>将会查询在线表（即触发日账记录表），与历史表（出日账进程处理完成表）</li></ol> <h4 id="页面说明-page-description-19"><a href="#页面说明-page-description-19" class="header-anchor">#</a> 页面说明-Page description</h4> <p><strong>界面截图，参照</strong></p> <p>菜单：Real Time Bill Query</p> <p><strong>2、业务输入输出要素-Business elements</strong></p> <ul><li><strong>输入要素-Input elements</strong></li></ul> <blockquote><p>手机号、开始时间、结束时间</p></blockquote> <ul><li><strong>输出要素-Output elements</strong></li></ul> <blockquote><p>手机号、操作员ID、操作员组织、手机号局向、账期、备注、插入时间、完成时间、处理状态</p></blockquote> <h3 id="代理商账本调整-agent-debit-adjustment"><a href="#代理商账本调整-agent-debit-adjustment" class="header-anchor">#</a> 代理商账本调整-Agent Debit Adjustment</h3> <h4 id="基本描述-basic-description-21"><a href="#基本描述-basic-description-21" class="header-anchor">#</a> 基本描述-basic description</h4> <p>代理商账本与实际有出入，需进行账本调整。</p> <h4 id="业务流程-business-process-20"><a href="#业务流程-business-process-20" class="header-anchor">#</a> 业务流程-business process</h4> <ol><li><p>点击&quot;Agent Debit Adjustment&quot;(代理商账本调整)页面</p></li> <li><p>点击&quot;Add&quot;按钮，输入Sale ID，Amount 点击ok。将此条记录插入列表中</p></li> <li><p>输入Remark，点击提交按钮进行调账。后台调用渠道接口进行调整代理商账本</p></li> <li><p>点击&quot;Batch Adjust&quot;，进行批量调整。将数据插入后台工单表。等待工单进行扫描，后台调用渠道接口进行处理。</p></li></ol> <h4 id="业务规则-business-rules-19"><a href="#业务规则-business-rules-19" class="header-anchor">#</a> 业务规则-business rules</h4> <h4 id="页面说明-page-description-20"><a href="#页面说明-page-description-20" class="header-anchor">#</a> 页面说明-Page description</h4> <p><strong>界面截图，参照</strong></p> <p>菜单：Agent Debit Adjustment</p> <p><strong>、业务输入输出要素-Business elements</strong></p> <ul><li><strong>输入要素-Input elements</strong></li></ul> <blockquote><p>Sale ID，Amount</p></blockquote> <ul><li><strong>输出要素-Output elements</strong></li></ul> <blockquote><p>Sale ID，Amount ，result(处理结果)、失败原因</p></blockquote> <p>相关sql:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> T<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span> T<span class="token punctuation">.</span>ROWID <span class="token keyword">FROM</span> CEN<span class="token punctuation">.</span>AM_BATCH_ADJUST_AGENTDEBIT T<span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> T<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span> T<span class="token punctuation">.</span>ROWID <span class="token keyword">FROM</span> CEN<span class="token punctuation">.</span>AM_BATCH_ADJUST_AGENTDEBIT_H T<span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> T<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span> T<span class="token punctuation">.</span>ROWID <span class="token keyword">FROM</span> CEN<span class="token punctuation">.</span>AM_BATCH_ADJUST_AGENTDEBIT_error T<span class="token punctuation">;</span>
</code></pre></div><h1 id="李涛涛-文档"><a href="#李涛涛-文档" class="header-anchor">#</a> 李涛涛 文档</h1> <ol><li><h1 id="employee-payment"><a href="#employee-payment" class="header-anchor">#</a> Employee Payment</h1> <ol><li><h2 id="基本描述-basic-description-22"><a href="#基本描述-basic-description-22" class="header-anchor">#</a> 基本描述-basic description</h2></li></ol></li></ol> <p>员工缴费是指给Cmpak 的员工进行充值或者扩充有效期。</p> <h2 id="业务流程-business-process-21"><a href="#业务流程-business-process-21" class="header-anchor">#</a> 业务流程-business process</h2> <ol><li><p>点击Employee Payment菜单；</p></li> <li><p>页面可以根据 Staff Id,Staff Name,State,Region Id,County Id,Organize Id,Staff level,Job Position,Staff Type；</p></li> <li><p>点击查询后，会出现可供充值的员工列表；</p></li> <li><p>点击下方的Pay,Pay For All 可以实现选择号码充值和全部号码充值；</p></li> <li><p>点击完成后，号码会进入后台处理。</p></li> <li><p>处理完成的结果需要到Batch Business Query页面查询业务类型为Batch Staff Payment的任务：</p></li> <li><p>点击任务id查看任务执行结果；</p></li></ol> <p><em>--Employee Payment</em></p> <p><em>--员工数据</em></p> <p><em>select a.staff_id,a.bill_id,a.charge_limit from sec.sec_staff a where a.bill_id='3165555111';</em></p> <p><em>select a.staff_id,a.bill_id,a.charge_limit from sec.sec_staff a,sec.sec_operator b where a.state=1 and a.staff_type=1 and a.staff_id=b.staff_id ;</em></p> <p><em>--员工缴费记录表</em></p> <p><em>select * from cen.AM_BATCH_PAYMENT t where t.business_type_id='4438'and t.trade_id='19100000154181';</em></p> <p><em>select * from cen.Am_Batch_Payment_h t where t.business_type_id='4438'and t.trade_id='19100000154181';</em></p> <p><em>--员工缴费记录</em></p> <p><em>select t.</em>,t.rowid from cen.am_emp_batch_pay_rec_201910 t where t.phone_id='3129998881' ;*</p> <p><em>--批量缴费表</em></p> <p><em>select t.</em>,t.rowid from cen.Am_Batch_Import t where t.trade_type_code='9527' a;*</p> <p><em>--员工缴费</em></p> <p><em>select t.</em>,t.rowid from cen.AM_BATCH_PAYMENT t where t.business_type_id='4438' and t.trade_id='19100000154195';*</p> <p><em>select t.</em>,t.rowid from cen.Am_Batch_Payment_h t where t.business_type_id='4438' and t.trade_id='19100000154195';*</p> <p><em>--员工缴费错误</em></p> <p><em>select t.</em>,t.rowid from cen.AM_BATCH_PAYMENT_ERROR t where t.partition_id=3 and t.trade_id='19100000154181';*</p> <p><em>--BANK_ID,REMARK,ACCESS_NO,PAY_AMOUNT,CHECK_AMOUNT,TRADE_DATE</em></p> <p><em>--员工缴费工单</em></p> <p><em>--com.ai.ac.core.workorder.task.AcctWorkOrderTask</em></p> <p><em>select t.</em>,t.rowid from param.bs_work_order_conf t where t.order_code='EmpBatchPay';*</p> <p><em>select t.</em>,t.rowid from param.bs_work_order_channel t where t.order_code='EmpBatchPay';*</p> <ol start="3"><li><h2 id="业务表说明-2"><a href="#业务表说明-2" class="header-anchor">#</a> 业务表说明</h2></li> <li><h2 id="关键配置说明-2"><a href="#关键配置说明-2" class="header-anchor">#</a> 关键配置说明</h2></li></ol> <p>+------------------------------+
| 1.一个月每个员工只能充值一次 |
|                              |
| 2.员工缴费支持预付费         |
|                              |
| 3.0缴费也会进行扩展有效期    |
|                              |
| 4.后台任务为EmpBatchPay      |
+------------------------------+</p> <ol start="2"><li><h1 id="详单查询-cdr-query"><a href="#详单查询-cdr-query" class="header-anchor">#</a> 详单查询- CDR Query</h1> <ol><li><h2 id="基本描述-basic-description-23"><a href="#基本描述-basic-description-23" class="header-anchor">#</a> 基本描述-Basic description</h2></li></ol></li></ol> <p>详单查询是指依据详单查询请求中的用户信息、查询帐期、详单类型等信息，结合配置信息中的参数和格式对系统中存储的详单数据进行翻译、组装等操作，并最终按照格式将查询结果返回请求客户端的功能。</p> <p>CDR query refers to the operation of translating and assembling the detailed list data stored in the system according to the user information, account period, detailed list type and other information in the detailed list query request and combining the parameters and format in the configuration information, and finally returning the query results to the requesting client in accordance with the format.</p> <h2 id="功能需求-functional-requirement"><a href="#功能需求-functional-requirement" class="header-anchor">#</a> 功能需求-Functional requirement</h2> <ol><li><p>支持查询正常号码的详单信息</p></li> <li><p>支持查询6+1个月的详单信息</p></li> <li><p>支持查询语音通话详单、上网详单、短信详单、彩信及自有增值业务详单、VPMN详单等五种详单类型</p></li> <li><p>支持查询同一个月一段日期内的详单</p></li> <li><p>支持记录查询原因以及查询备注</p></li> <li><p>支持票据和密码</p> <ol start="3"><li><h2 id="业务流程-business-process-22"><a href="#业务流程-business-process-22" class="header-anchor">#</a> 业务流程-business process</h2></li></ol></li></ol> <ol><li><p>输入查询的号码 3123453492</p></li> <li><p>选择查询的月份和时间段 201905 20190508-20190508</p></li> <li><p>选择查询的详单类型</p></li> <li><p>选择查询原因，输入票据和备注(票据校验目前不能测)</p></li> <li><p>点击查询</p> <p>6.输入密码校验(暂时没密码校验)</p> <ol start="4"><li><h2 id="特殊规则-special-rules"><a href="#特殊规则-special-rules" class="header-anchor">#</a> 特殊规则-Special rules</h2></li></ol></li></ol> <ul><li><strong>查询日期规则-Date rule</strong></li></ul> <blockquote><p>默认允许查6+1月的详单数据</p> <p>By default,cdr of 6+1 months is allowed</p> <p>查询的时间范围只能在查询月份内</p> <p>The query time range can only be within the query month</p></blockquote> <ul><li><strong>号码遮掩</strong></li></ul> <blockquote><p>1.拥有号码不遮掩权限</p> <p>2.需要校验PIN且PIN校验成功，如果不需要校验PIN，则略过</p> <p>3.需要校验TICKETNO且TICKETNO校验成功，如果不需要校验TICKETNO，则略过</p> <p>只有上面3个条件都满足,号码才可以不遮掩</p></blockquote> <ul><li><p><strong>密码校验规则:</strong></p> <p>以下参数配置的详单类型查询需要校验密码</p> <p>select t.*,rowid from ucr_param.BS_SYS_PROFILES t where t.profile_type='QUERY_CDR' and PROFILE_CODE='NEED_PASSWORD_CDRTYPES';</p></li></ul> <ol><li><p>拥有管理员权限，输入查询原因</p></li> <li><p>输入密码，校验成功，(暂时未完成)</p></li></ol> <ul><li><p><strong>过户判断:</strong></p> <p>order.ICmChargeItemCSV.queryAccTransRegistByAccNum</p> <p>默认查询过户后的详单数据</p></li> <li><p><strong>红黑名单</strong></p> <p>如果是红名单，则需要有查询红名单权限才能查询。</p> <p>如果是黑名单，则需要有该号码权限</p></li> <li><p><strong>转义规则</strong></p> <p>select t.*,rowid from ucr_param.AM_DETAIL_BILLTYPE t;</p> <p>详单查询使用BILL_TABLE_KEYS 新详单查询使用BILL_TABLE_TITLES配置参数</p> <p>详单查询使用 version=0 新详单查询使用version=1</p> <p>select t.*,rowid from ucr_param.CDR_TRANSLATE t where t.version='0';</p> <p>枚举翻译:</p> <p>CS:VPMN:</p> <p>CALL_TYPE=m_vCallTypePtr,</p> <p>HPLMN1=m_vProvinceCodeDefPtr</p> <p>HPLMN2=m_vCityCodeDefPtr</p> <p>HPLMN3=m_vCityCodeDefPtr</p> <p>VPLMN1=m_vProvinceCodeDefPtr</p> <p>VPLMN2=m_vCityCodeDefPtr</p> <p>ROAM_TYPE=m_vRoamTypePtr</p> <p>TOLL_TYPE=m_vTollTypePtr</p> <p>OPP_NUMBER_TYPE=m_vOppTypePtr</p> <p>OPP_HOME_AREACODE=m_vCityCodeDefPtr</p> <p>OPP_ROAM_AREACODE=m_vCityCodeDefPtr</p> <p>BILL_INDICATE=m_vBillIndicatorPtr</p> <p>NETCALL_FLAG=m_vNetCallFlagPtr</p> <p>USER_TYPE=m_vUserTypePtr</p> <p>RATING_FLAG=m_vRatingFlagTypePtr</p> <p>PRODUCT_ID=m_vProductsDefPtr</p> <p>DR_TYPE=m_vDRTypePtr</p> <p>PS:</p> <p>USER_TYPE=m_vOppTypePtr</p> <p>CALLER_INDICATE=m_vBillIndicatorPtr</p> <p>ROAM_TYPE=m_vRoamTypePtr</p> <p>HPLMN1=m_vProvinceCodeDefPtr</p> <p>HPLMN2=m_vCityCodeDefPtr</p> <p>HPLMN3=m_vCityCodeDefPtr</p> <p>VPLMN1=m_vProvinceCodeDefPtr</p> <p>VPLMN2=m_vCityCodeDefPtr</p> <p>RATING_FLAG=m_vRatingFlagTypePtr</p> <p>PRODUCT_ID=m_vProductsDefPtr</p> <p>DR_TYPE=m_vDRTypePtr</p> <p>RECORD_TYPE=m_vGPRSRecordTypePtr</p> <p>SMS</p> <p>CALL_TYPE=m_vSmsCallTypePtr</p> <p>MESSAGE_TYPE=m_vMessageType</p> <p>SP_CODE=m_vSpcodeDefPtr</p> <p>HPLMN1=m_vProvinceCodeDefPtr</p> <p>HPLMN2=m_vCityCodeDefPtr</p> <p>HPLMN3=m_vCityCodeDefPtr</p> <p>VPLMN1=m_vProvinceCodeDefPtr</p> <p>VPLMN2=m_vCityCodeDefPtr</p> <p>FINAL_STATE=m_vFinalStatePtr</p> <p>USER_TYPE=m_vUserTypePtr</p> <p>ROAM_TYPE=m_vRoamTypePtr</p> <p>OPP_TYPE=m_vOppTypePtr</p> <p>TRADEMARK=m_vBrandTypePtr</p> <p>DR_TYPE=m_vDRTypePtr</p> <p>ISMP:</p> <p>SP_CODE=m_vSpcodeDefPtr</p> <p>BILL_FLAG=m_vISMGBillFlagPtr</p> <p>ROAM_TYPE=m_vRoamTypePtr</p> <p>RECORD_TYPE=m_vISMGRecordTypePtr</p> <p>USER_TYPE=m_vUserTypePtr</p> <p>TRADEMARK=m_vBrandTypePtr</p> <p>OPP_TYPE=m_vOppTypePtr</p> <p>RATING_FLAG=m_vRatingFlagTypePtr</p> <p>DR_TYPE=m_vDRTypePtr</p> <p>特殊字段解析:</p> <p>CS:VPMN:</p> <p>select t.*,rowid from ucr_param.BS_SYS_PROFILES t where t.profile_type='QUERY_CDR' and PROFILE_CODE='CONVERT_ENUM_TYPE';</p> <p>1表示要[ID]+文本 其他是只要文本</p> <p>有HPLMN1字段</p> <p>1.TOLL_TYPE&gt;=2&amp;&amp;TOLL_TYPE&lt;=5 用m_vCountryCodeDefPtr翻译 OPP_HOME_AREACODE OPP_ROAM_AREACODE</p> <p>2.ROAM_TYPE==3 用m_vCountryCodeDefPtr翻译 HPLMN1 HPLMN2用GSMPLMN_ISMI 翻译</p> <p>3.ROAM_TYPE==5 用m_vCountryCodeDefPtr翻译 HPLMN1 HPLMN2用GSMPLMN_PLMNCODE 翻译</p> <p>有INTRAVPMNCALL字段时 NETCALL_FLAG==11 Yes 否则为No</p> <p>SUMCHARGE3=CHARGE1+CHARGE2+CHARGE4</p> <p>STOP_TIME=START_TIME+DURATION</p> <p>SUMCHARGE3_DISC=CHARGE1_DISC+CHARGE2_DISC+CHARGE4_DISC</p> <p>汇总:需要汇总的字段，Records Amount: 记录条数</p> <p>TROLL_FEE=CHARGE2</p> <p>CALL_TYPE==2 TROLL_FEE=TROLL_FEE+CHARGE4,CHARGE4=0</p> <p>ROAM_TYPE==0&amp;&amp;CALL_TYPE==1 TOTAL_CALLED_FEE+=BASE_FEE</p> <p>TOLL_TYPE!=0&amp;&amp;ROAM_TYPE==0 TOTAL_TROLL_FEE+=TROLL_FEE</p> <p>ROAM_TYPE==0 TOTAL_CALL_FEE+=BASE_FEE</p> <p>ROAM_TYPE!=0&amp;&amp;ROAM_TYPE!=6 TOTAL_ROLL_FEE+=BASE_FEE+TROLL_FEE</p> <p>ROAM_TYPE==6 TOTAL_TROLL_FEE+=TROLL_FEE 如果CALL_TYPE==0 TOTAL_CALL_FEE+=BASE_FEE 否则TOTAL_CALLED_FEE+=BASE_FEE</p> <p>TOTAL_CHARGE+=CHARGE3+CHARGE4</p> <p>TOTAL_FEE+=BASE_FEE+TROLL_FEE+CHARGE3+CHARGE4</p> <p>Local Fee</p> <p>(contain info):</p> <p>TOTAL_CALL_FEE</p> <p>Called:</p> <p>TOTAL_CALLED_FEE</p> <p>Toll Fee:</p> <p>TOTAL_TROLL_FEE</p> <p>Roaming Fee:</p> <p>TOTAL_ROLL_FEE</p> <p>Info Fee:</p> <p>TOTAL_CHARGE</p> <p>Total Fee:</p> <p>TOTAL_FEE</p> <p>PS:</p> <p>DATA_FLOW_UP1&gt;0 DATA_FLOW_UP1=DATA_FLOW_UP1 MDATA_FLOW_UP1=0</p> <p>DATA_FLOW_UP1&lt;0 DATA_FLOW_UP1=0 MDATA_FLOW_UP1=-DATA_FLOW_UP1</p> <p>TYPEIMSI 翻译为GPRS</p> <p>PRECHARGE1=CHARGE1+CHARGE1_DISC</p> <p>STOP_TIME=START_TIME+DURATION</p> <p>SUMUPDOWNVOLUME=UPVOLUME+DOWNVOLUME</p> <p>SUMUPDOWNVOLUMEMB=SUMUPDOWNVOLUME/1024保留2位小数</p> <p>SUMCHARGE1=CHARGE1+CHARGE2</p> <p>SUMCHARGE1_DISC=CHARGE1_DISC+CHARGE2_DISC</p> <p>汇总</p> <p>DATA_FLOW_UP1:按DATA_FLOW_UP1汇总</p> <p>MDATA_FLOW_UP1:按MDATA_FLOW_UP1汇总</p> <p>SUMCHARGE1:按SUMCHARGE1汇总</p> <p>SUMCHARGE1_DISC：按SUMCHARGE1_DISC汇总</p> <p>PRECHARGE1：按PRECHARGE1汇总</p> <p>SMS:</p> <p>TYPEIMSI 前五位为00852 00853 00886 翻译为HK SMS DR_TYPE==301 International SMS DR_TYPE==201||DR_TYPE==601 Span Net P2P SMS 否则:Inner P2P SMS</p> <p>PRECHARGE1=CHARGE1+CHARGE1_DISC</p> <p>汇总:</p> <p>PRECHARGE1：按PRECHARGE1汇总</p> <p>ISMP：</p> <p>BILL_FLAG==3||RECORD_TYPE==2||RECORD_TYPE==12 MCHARGE4=CHARGE4 CHARGE4=0 否则CHARGE4=CHARGE4 MCHARGE4=0</p> <p>USETYPESP_CODE CDR_TYPE==43 空 CDR_TYPE==29 USSD Fess CDR_TYPE==21 CRBT Fee CDR_TYPE==54 DBOSS Fee CDR_TYPE==55 IVR Fee CDR_TYPE==56 Color shake Fee 否则 Dream Net SMS</p> <p>DIRECTIONSP_CODE TOP</p> <p>汇总:</p> <p>CHARGE4:按CHARGE4汇总</p> <p>MCHARGE4:按MCHARGE4汇总</p> <p>用到的sql语句:</p> <p>--cdr query sql</p> <p>--枚举</p> <p>--语音</p> <p>--IProductIntfAppInt.get_promn() 产品定义表 PRODUCT_ID</p> <p>select t.*,rowid from ucr_param.BS_SYS_PROFILES t where t.PROFILE_TYPE='QUERY_CDR' and t.profile_code='ENUM_TABLE_LIST';--枚举表</p> <p>select t.*,rowid from ucr_param.BS_SYS_PROFILES t where t.PROFILE_TYPE='QUERY_CDR' and t.profile_code='ENUM_PARAM_LIST';--BS_STATIC中的枚举参数 必须带有@符号</p> <p>select * from ucr_param.all_opp_type;</p> <p>select * from ucr_param.SYS_CITY_PART;</p> <p>select * from ucr_param.sys_country;</p> <p>select * from ucr_param.gsm_intl_plmn_code;</p> <p>select t.*,rowid from ucr_param.bs_static t where t.type_id='JF_BILLING@CALL_TYPE';</p> <p>select t.*,rowid from ucr_param.bs_static t where t.type_id='JF_BILLING@TOLL_TYPE';</p> <p>select t.*,rowid from ucr_param.bs_static t where t.type_id='CDR_TABLE@PROVINCE_CODE';</p> <p>select t.*,rowid from ucr_param.bs_static t where t.type_id='JF_BILLING@ROAM_TYPE';</p> <p>select t.*,rowid from ucr_param.bs_static t where t.type_id='CM_USER@USER_TYPE';</p> <p>select t.*,rowid from ucr_param.bs_static t where t.type_id='JF_BILLING@NETCALL_TYPE';</p> <p>select t.*,rowid from ucr_param.bs_static t where t.type_id='JF_BILLING@RATING_FLAG';</p> <p>select t.*,rowid from ucr_param.bs_static t where t.type_id='JF_BILLING@BILL_INDICATE';</p> <p>select t.*,rowid from ucr_param.bs_static t where t.type_id='JF_BILLING@DR_TYPE';</p> <p>--gprs</p> <p>select t.*,rowid from ucr_param.bs_static t where t.type_id='JF_BILLING@GPRS_RECORD_TYPE';</p> <p>--短信</p> <p>--IProductIntfAppInt.get_brds() BRAND_TYPE</p> <p>--IDetailQueryInt.query_spCode() SP_CODE</p> <p>select t.*,rowid from ucr_param.bs_static t where t.type_id='JF_BILLING@SMS_CALL_TYPE';</p> <p>select t.*,rowid from ucr_param.bs_static t where t.type_id='JF_BILLING@FINAL_STATE';</p> <p>select t.*,rowid from ucr_param.bs_static t where t.type_id='JF_BILLING@MESSAGE_TYPE';</p> <p>--ISMP</p> <p>select t.*,rowid from ucr_param.bs_static t where t.type_id='JF_BILLING@ISMG_RECORD_TYPE';</p> <p>select t.*,rowid from ucr_param.bs_static t where t.type_id='JF_BILLING@ISMG_BILLFLAG';</p> <p>--配置参数</p> <p>select t.*,rowid from ucr_param.BS_SYS_PROFILES t where t.PROFILE_TYPE='QUERY_CDR';</p> <p>select t.*,rowid from ucr_param.ismg_rate t;</p> <p>select t.*,rowid from ucr_param.all_dr_type_def t;</p> <p>select t.*,rowid from ucr_param.CDR_TYPE_DETAIL_MAP t;--</p> <p>select * from ucr_param.CDR_APPEND_CONDITION;--</p> <p>select t.*,rowid from ucr_param.CDR_JOIN_TABLE_STRING t;--</p> <p>select t.*,rowid from ucr_param.CDR_OUT_CDR_FORMAT t;--字段信息</p> <p>select t.*,rowid from ucr_param.CDR_OUT_CDR_TYPE t;---分表规则</p> <p>select * from ucr_ac1.dr_cs_pre_20190508;</p> <p>select * from ucr_ac1.dr_ps_pre_20190508;</p> <p>select * from ucr_ac1.dr_ismp_pre_20190508;</p> <p>select * from ucr_ac1.dr_sms_pre_20190508;</p> <p>select * from ucr_ac1.dr_vpmn_pre_20190508;</p> <p>--缓存</p> <p>select t.*,rowid from ucr_param.bs_param_tables t where t.table_name='CDR_TYPE_DETAIL_MAP';</p> <p>--日志</p> <p>select t.*,rowid from ucr_ac1.am_cdr_user_oper t;</p> <p>--查询展示配置</p> <p>select t.*,rowid from ucr_param.AM_DETAIL_BILLTYPE t;</p> <p>select t.*,rowid from ucr_param.CDR_TRANSLATE t where t.version='0';</p> <ol start="5"><li><h2 id="页面说明-page-description-21"><a href="#页面说明-page-description-21" class="header-anchor">#</a> 页面说明-Page description</h2></li></ol></li></ul> <ol><li><strong>界面截图-Page screenshots</strong></li></ol> <blockquote><p>参照 CMPAKCRM项目-账管-操作手册.docx 第19章详单查询--CDR Query</p> <p>Reference CMPAKCRM项目-账管-操作手册.docx第19章详单查询--CDR Query</p></blockquote> <ol start="2"><li><strong>业务输入输出要素-Business elements</strong></li></ol> <ul><li>**输入要素 **</li></ul> <blockquote><p>手机号码、查询账期、业务类型(详单类别)、开始日期、结束日期、查询原因、查询备注、密码、TICKET #</p></blockquote> <ul><li><strong>输出要素 Onput elements</strong></li></ul> <blockquote><p><strong>页面输出信息</strong>包括业务类型、详单信息</p> <p><strong>Page output information</strong> including Query Month, business type, cdr information</p></blockquote> <ol><li><p>语音通话详单包括</p> <p>START_TIME,STOP_TIME,OPP_USER_NUMBER,OPP_NUMBER_TYPE,DURATION,SUMCHARGE3,ACCOUNT_BALANCE,OPP_HOME_AREACODE,OPP_ROAM_AREACODE,PRODUCT_ID,CALL_TYPE,LAC_ID,CELL_ID,USER_NUMBER,ITEM_CODE1,CHARGE1,CHARGE1_DISC,ITEM_CODE2,CHARGE2,CHARGE2_DISC,ITEM_CODE3,CHARGE3,CHARGE3_DISC,ITEM_CODE4,CHARGE4,CHARGE4_DISC,ROAM_TYPE,TOLL_TYPE,IMSI,NETCALL_FLAG,A_NUMBER,RATING_RES,STD_UNIT,TOLL_STD_UNIT,RATE_PROD_ID,Free Resource Value,OPP_ACCESS_TYPE,FREE_RES_VAL1,FREE_RES_VAL2,DR_TYPE,SERVICE_CODE,SUMCHARGE3_DISC,INTRAVPMNCALL,PRESUMCHARGE3,TOLLCALLTYPE,AIRTIME,ANC,ADVANCE_TAX,SERVICE_TYPE,Original Other Fee</p></li> <li><p>短信详单包括</p> <p>USER_NUMBER,OPP_NUMBER,CHARGE1,CHARGE2,CHARGE3,CHARGE4,ADVANCE_TAX,CALL_TYPE,START_TIME,HPLMN1,HPLMN2,HPLMN3,VPLMN1,VPLMN2,ITEM_CODE1,ITEM_CODE2,ITEM_CODE3,ITEM_CODE4,SMS_CENTER_NUMBER,FINAL_STATE,SEQUENCE_NO,SERVICE_ID,CUST_ID,IMSI,BRAND,DR_TYPE,RATE_PROD_ID,Free Resource Value,FREE_RES_VAL1,FREE_RES_VAL2,CHARGE1_DISC,CHARGE4_DISC,CHARGE2_DISC,CHARGE3_DISC,STOP_TIME,Caller Type,Receiver Type,SMS Type,SP Code,Message Length,Subscriber Type,Service Key,Roaming Type,Opposing Status,SMS ID,SMS Type,Opposing Subscriber Type,Original Basic Fee,Fee,Using Type,Favor Fee,Hplmn1,Hplmn2,Advance Tax Item,Account Balance,product id,promotion prods,plan id</p></li> <li><p>上网详单包括</p> <p>RECORD_TYPE,RG,APN_NI,START_TIME,DURATION(sec),CHARGE1,CHARGE3,Advance_Tax,DATA_FLOW_UP1,DATA_FLOW_DOWN1,USER_NUMBER,CHARGE1_DISC,CHARGE3_DISC,DR_TYPE,RATE_PROD_ID,Free Resource Value,LAC_ID,CELL_ID,Roaming Type,MDATA_FLOW_UP1,Free Resource2,Using Type,Fee,End Time,Flow Volume(KB),Flow Volume(MB),Total Fee,Total Discount Fee</p></li> <li><p>彩信及自有增值业务详单包括</p> <p>STOP_TIME,CHARGE1,ADVANCE_TAX,CHARGE3,CHARGE4,BRAND,RECORD_TYPE,USER_NUMBER,SP_CODE,START_TIME,MESSAGE_LENGTH,OPP_NUMBER,SERVICE_CODE,OPERATOR_CODE,BILL_FLAG,OPERATOR_NAME,USER_TYPE,DR_TYPE,DISCRIPTION,RATING_FLAG,RATE_PROD_ID,SEQUENCE_NO,CUST_ID,SEND_STATE,OPP_TYPE,RATING_RES,DISCRIPTION,INFO_RATE,ROAM_TYPE,ITEM_CODE1,ITEM_CODE4,ITEM_CODE2,ITEM_CODE3,FREE_RES_VAL1,FREE_RES_VAL2,CHARGE1_DISC,CHARGE2_DISC,CHARGE3_DISC,CHARGE4_DISC,SERVICE_ID,ORI_BASIC_CHARGE,ORI_TOLL_CHARGE,ORI_OTHER_CHARGE,HPLMN1,HPLMN2,HPLMN3,VPLMN1,VPLMN2,Month Packet Fee,SP Service Code,Favor Fee,SP Code,Total Fee,SP Code</p></li> <li><p>VPMN详单包括</p> <p>Opp Number,CALL_TYPE,USER_NUMBER,START_TIME,DURATION,ITEM_CODE1,CHARGE1,CHARGE1_DISC,ITEM_CODE2,CHARGE2,CHARGE2_DISC,ITEM_CODE3,CHARGE3,CHARGE3_DISC,ITEM_CODE4,CHARGE4,CHARGE4_DISC,HPLMN1,HPLMN2,VPLMN1,VPLMN2,ROAM_TYPE,TOLL_TYPE,OPP_NUMBER_TYPE,OPP_HOME_AREACODE,OPP_ROAM_AREACODE,LAC_ID,CELL_ID,IMSI,OPP_NUMBER,NETCALL_FLAG,A_NUMBER,RATING_RES,STD_UNIT,TOLL_STD_UNIT,PRODUCT_ID,RATE_PROD_ID,OPP_ACCESS_TYPE,SUMCHARGE3,DR_TYPE,SERVICE_CODE,STOP_TIME,SUMCHARGE3_DISC,INTRAVPMNCALL,PRESUMCHARGE3,TOLLCALLTYPE,AIRTIME,ANC,ADVANCE_TAX,ACCOUNT_BALANCE,Opposite Number,Original Other Fee</p> <ol start="6"><li><h2 id="详单配置数据介绍"><a href="#详单配置数据介绍" class="header-anchor">#</a> 详单配置数据介绍</h2></li></ol></li></ol> <p>1.枚举参数定义</p> <p>select t.*,rowid from param.BS_SYS_PROFILES t where t.PROFILE_TYPE='QUERY_CDR' and t.profile_code='ENUM_PARAM_LIST';</p> <p><img src="media/image2.png" alt=""></p> <p>select t.*,rowid from param.bs_static t where t.type_id='JF_BILLING@SMS_CALL_TYPE';</p> <p><img src="media/image3.png" alt=""></p> <p>枚举翻译配置用SMS_CALL_TYPE当做翻译的 枚举map名称</p> <ol start="2"><li><p>枚举表定义</p> <p>select t.*,rowid from param.BS_SYS_PROFILES t where t.PROFILE_TYPE='QUERY_CDR' and t.profile_code='ENUM_TABLE_LIST';--枚举表</p> <p><img src="media/image4.png" alt=""></p> <p>PROFILE_VALUE：定义规则</p> <p>枚举表:过滤字段:过滤字段的值:枚举KEY:枚举VALUE:枚举map名称</p> <p>例:GSM_INTL_PLMN_CODE:1:1:IMSI_CODE:PLMN_NAME:GSMPLMN_PLMNCODE</p></li> <li><p>select t.*,rowid from param.AM_DETAIL_BILLTYPE t;</p> <p>详单字段展示定义规则，用;分割每个字段,:分割每个属性</p> <p>数据库字段名称:展示列名:字段数据类型:格式化动作:是否展示:对齐方式:导出excel的宽度:枚举MAP名称</p> <p>PRODUCT_ID:Tariff Plan:4:1:1:1:6900:PRODUCT_ID;</p> <p>展示列名:不能存在:和;</p> <p>字段数据类型:</p></li></ol> <p>public static final int <em>OBD_NULL_TYPE</em> = 0;
public static final int <em>OBD_CHAR</em> = 1;
public static final int <em>OBD_STRING</em> = 2;
public static final int <em>OBD_INT16</em> = 3;
public static final int <em>OBD_INT32</em> = 4;
public static final int <em>OBD_INT64</em> = 5;
public static final int <em>OBD_FLOAT</em> = 6;
public static final int <em>OBD_DOUBLE</em> = 7;
public static final int <em>OBD_DATE</em> = 8;
public static final int <em>OBD_TIME</em> = 9;
public static final int <em>OBD_DATETIME</em> = 10;
public static final int <em>OBD_STRUCT</em> = 11;
public static final int <em>OBD_CLASS</em> = 12;
public static final int <em>OBD_LIST</em> = 13;</p> <p>格式化动作:</p> <p>public static final int <em>faNormal</em> = 0; // 直接显示
public static final int <em>faCodeIDToCName</em> = 1; // 必须将数字转换成包含数字枚举汉字
public static final int <em>faIntToMoney</em> = 2; // 必须将数字转换成金额显示
public static final int <em>faStringToName</em> = 3; // 将string转换成字符串,然后再转换成枚举汉字
public static final int <em>faCharToName</em> = 4; // 将string转换成字符数组,然后每个字符转换成数字,再转换成枚举汉字
public static final int <em>faStrToBitName</em> = 5; // 将string转换成字符串,然后再转换成枚举汉字
public static final int <em>faStrToCountStr</em> = 6; // 将string转换成字符串(这个是accoutBalance专用的,请注意) jiangwei 2008-05-30 GZ work
public static final int <em>faCodeToName</em> = 7; // 必须将数字转换成枚举汉字</p> <p>是否展示: 1展示,0不展示</p> <p>对齐方式:</p> <p>//对齐方式（0:taLeftJustify;1:taRightJustify;2:taCenter）
public static final int <em>taLeftJustify</em> = 0;
public static final int <em>taRightJustify</em> = 1;
public static final int <em>taCenter</em> = 2;</p> <ol start="4"><li><p>select t.*,rowid from param.AM_TYPE_DETAIL_MAP t;-- 详单类型表定义和预后付费属性定义</p> <p>CDR_TYPE_ID 外部输入的查询详单类型</p> <p>CDR_TYPE_NAME 查询类型描述</p> <p>REGION_CODE 配置有效的所属region ZZZZ全部有效</p> <p>DETAIL_HEAD 表名前缀</p> <p>DETAIL_TAIL 默认没用</p> <p>TABLE_TYPE 所需详单类型 CS,PS,SMS,ISMP,VPMN,RENT</p> <p>PRE_POST 预后付费属性 0表示全部，1表示只取后付费，2表示只取预付费，配置只对云详单有效</p></li> <li><p>select * from param.AM_CDR_TYPE_MAP;--外部查询类型到内部查询类型的转换</p> <p>比如:0就是将外部输入的0类型，转换为内部的0和50来进行查询</p> <p><img src="media/image5.png" alt=""></p></li> <li><p>select * from param.AM_APPEND_CONDITION;--条件信息</p> <p>目前无数据，用于查询物理库详单时，追加多余的过滤条件。</p></li> <li><p>select t.*,rowid from param.AM_JOIN_TABLE_STRING t;--关联表定义</p> <p>用于关联其他表联合查询详单的表</p></li> <li><p>select t.*,rowid from param.AM_OUT_CDR_FORMAT t;--字段信息</p> <p>查询物理库详单字段，每种查询类型所需要查询字段的定义表</p></li> <li><p>select t.*,rowid from param.AM_OUT_CDR_TYPE t;---分表规则</p> <p>SPLIT_TYPE：0:不分表，1:按天 2:按月 3:按年</p> <p>其中1按天分别有配置参数</p> <p>select t.*,rowid from param.BS_SYS_PROFILES t where t.PROFILE_TYPE='QUERY_CDR';</p> <p>CDR_MONTH_TABLETAIL:这一天之前的全部按月分表</p> <p>CDR_YEAR_TABLETAIL:这一天之前的全部按年分别</p></li> <li><p>select * from param.am_cdr_translate t ;</p> <p>ID:主键</p> <p>CDR_TYPE:五种详单类型跟 以下表中REMARK字段匹配</p> <p>select * from param.BS_STATIC where TYPE_ID='BS_CDR_BILL_TYPE_0';--Query Cdr Old</p> <p>select * from param.BS_STATIC where TYPE_ID='BS_CDR_BILL_TYPE_1';--Event Summary</p> <p>TYPE:D 表示明细 S表示汇总 T表示汇总展示 V表示临时变量当前记录数据的</p> <p>V:临时变量是对详单的数据进行临时计算然后存放到临时MAP里，不影响原始数据</p> <p>D:明细是对详单的数据进行计算和翻译，影响展示信息</p> <p>S:汇总是对详单表的每行数据进行计算，然后放到汇总MAP里(仅用于汇总计算)</p> <p>T:汇总展示是对汇总里的结果进行格式化展示，影响汇总展示信息</p> <p>FIELDS:计算结果放到哪个字段里</p> <p>CONDITION:翻译条件 []表示属性 其他为操作符(需要实现对应的类)</p> <p>已经实现的操作符:com.asiainfo.bill.saas.view.vc.core.util.translate.ComputeUtil</p></li></ol> <p><em>operationMap</em>.put(&quot;+&quot;, new PlusOperator()); //4
<em>operationMap</em>.put(&quot;-&quot;, new MinusOperator());//4
<em>operationMap</em>.put(&quot;*&quot;, new MultipliedOperator());//3
<em>operationMap</em>.put(&quot;/&quot;, new DivideOperator());//3
<em>operationMap</em>.put(&quot;%&quot;, new ModOperator());//3
// operationMap.put(&quot;^&quot;, new PowerOperator());//9
<em>operationMap</em>.put(&quot;&gt;&quot;, new GtOperator());//6
<em>operationMap</em>.put(&quot;&lt;&quot;, new LtOperator());//6
<em>operationMap</em>.put(&quot;&gt;=&quot;, new GeOperator());//6
<em>operationMap</em>.put(&quot;&lt;=&quot;, new LeOperator());//6
<em>operationMap</em>.put(&quot;==&quot;, new EqOperator());//7
<em>operationMap</em>.put(&quot;!=&quot;, new NeOperator());//7
<em>operationMap</em>.put(&quot;^=&quot;, new StartWithOperator());//7
<em>operationMap</em>.put(&quot;&amp;&amp;&quot;, new AndOperator());//11
<em>operationMap</em>.put(&quot;||&quot;, new OrOperator());//12
<em>operationMap</em>.put(&quot;=&quot;, new AssignmentOperator());//14
<em>operationMap</em>.put(&quot;(&quot;, new LeftParenthesisOperator());//14
<em>operationMap</em>.put(&quot;@&quot;, new StringLenOperator());//2
<em>operationMap</em>.put(&quot;!&quot;, new NotOperator());//2</p> <p>TRANSLATE_METHOD:枚举翻译方式,仅当EXE_TYPE为T时才有用</p> <p>ENUM_MAP:上面提到的枚举翻译MAP，进行字段翻译用的</p> <p>DATA_FORMAT:对计算好的结果进行格式化用的，仅当EXE_TYPE为E时使用</p> <p>这个需要使用代码已经定义的格式方法:</p> <p>com.asiainfo.bill.saas.view.vc.core.util.TranslateUtil#formatVal</p> <p>AMOUNT_FORMAT 金额格式化,ACCOUNT_BALANCE 账本余额计算,GPRS_FORMAT_KB 流量KB,GPRS_FORMAT_MB 流量MB,STOP_TIME_FORMAT 结束时间格式化,MARSK_NUMBER 老掩码,</p> <p>MARSK_NUMBER_NEW 新掩码,TIME_FORMAT 持续时间格式化,TOLLCALLTYPE 话单类型,TYPEIMSI 短信类型格式化</p> <p>YES_VAL:且CONDITION为TRUE时字段为这个值EXE_TYPE为 C直接显示，为E则计算表达式</p> <p>NO_VAL: CONDITION为FALSE时字段为这个值 EXE_TYPE为 C直接展示,为E则计算表达式</p> <p>EXE_TYPE:T表示枚举翻译 E表示直接执行YES_VAL或者NO_VAL的表达式 C表示条件判断后变量直接赋值</p> <p>SORT_ID:变量执行顺序排序,用来进行有计算顺序要求的逻辑</p> <p>VERSION:0Query Cdr Old 1Event Summary</p> <p>计算表达式：</p> <p>[TOTAL_FEE:S]+&quot;Rs.&quot;</p> <p>:S表示是变量是字符串，&quot;&quot;字符串常量</p> <p>:L 表示Long类型</p> <p>😄 表示Double类型</p> <p>:B 表示Boolean类型</p> <p>[DATA_FLOW_UP1] 默认是Long类型</p> <p>数字计算规律</p> <p>Long+Long=Long Long+Double=Double Double+Double=Double</p> <p>Boolean只能和Boolean计算</p> <p>类型计算规律:</p> <p>数字+数字=数字 字符串+数字=字符串 字符串+字符串=字符串</p> <ol start="3"><li><h1 id="借款还款查询界面"><a href="#借款还款查询界面" class="header-anchor">#</a> 借款还款查询界面</h1> <ol start="7"><li><h2 id="基本描述-basic-description-24"><a href="#基本描述-basic-description-24" class="header-anchor">#</a> 基本描述-basic description</h2></li></ol></li></ol> <p>页面展示预付费号码当前和历史借款还款记录。</p> <h2 id="业务流程-business-process-23"><a href="#业务流程-business-process-23" class="header-anchor">#</a> 业务流程-business process</h2> <ol start="8"><li><p>点击Autoload &amp; Advanceloan Query菜单进入页面；</p></li> <li><p>输入手机号码，点击查询，调用三户信息查询接口</p></li> <li><p>如果是手机号码为后付费号码抛错，如果是预付费,显示当前在借款且未还款的的操作记录。</p></li> <li><p>右上方点击选择历史时间，查询已还款的借款记录。</p> <ol start="9"><li><h2 id="业务规则-business-rules-20"><a href="#业务规则-business-rules-20" class="header-anchor">#</a> 业务规则-business rules</h2></li></ol></li></ol> <ol><li>查询规则</li></ol> <blockquote><p>只针对预付费号码；</p> <p>历史查询时间范围为：一年。</p></blockquote> <h2 id="页面说明-page-description-22"><a href="#页面说明-page-description-22" class="header-anchor">#</a> 页面说明-Page description</h2> <p><strong>1、界面截图，参照</strong></p> <p>菜单：AssetwebAccounting Management综合查询Autoload &amp; Advanceloan Query</p> <p><strong>2、业务输入输出要素-Business elements</strong></p> <ul><li><strong>输入要素-Input elements</strong></li></ul> <blockquote><p>手机号（预付费号码）</p></blockquote> <ul><li><strong>输出要素-Output elements</strong></li></ul> <ol><li><p>当前未还款借款记录展示字段：</p> <p>PHONE_ID、AMOUNT、CREATE_DATE、REMARK</p></li> <li><p>历史已还款记录展示字段：</p> <p>phone_id、create_date、sts_date、after_sum_balance、remark</p> <ol start="11"><li><h2 id="表介绍"><a href="#表介绍" class="header-anchor">#</a> 表介绍</h2> <p>--老系统的借款和还款表</p> <p>select * from ac8.AM_AUTOLOAD t;</p> <p>--新系统的借款表</p> <p>select t.*,rowid from ac8.am_adv_loan_dtl t where t.phone_id='3130518036';</p> <p>--新系统的还款历史记录</p> <p>select t.*,rowid from ac8.AM_ADV_LOAN_DTL_HIS_201909 t where t.phone_id='3143352672';</p> <p>--借还款记录表</p> <p>select t.*,rowid from ac8.AM_ADV_LOAN_DTL_PUSH_201909 t where t.phone_id='3143352672';</p></li></ol></li></ol></div> <footer class="page-edit"><div class="edit-link"><a href="http://8.208.26.203:18082/cmpak/acctmanm/edit/develop/doc/zh/assetcenter/前台设计文档.md" target="_blank" rel="noopener noreferrer">在 Gogs 上编辑此页</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/acct-doc/zh/assetcenter/writeoff.html" class="prev">
        抵扣
      </a></span> <span class="next"><a href="/acct-doc/zh/assetcenter/后台设计文档.html">
        后台设计文档
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/acct-doc/assets/js/app.63ad57cc.js" defer></script><script src="/acct-doc/assets/js/2.33beb707.js" defer></script><script src="/acct-doc/assets/js/28.f3ad07db.js" defer></script>
  </body>
</html>
